import numpy as np
from numpy import exp,pi,sin,cos,sinh,sqrt,roots
from Parameters import Const

def Spec_w(q,t,fi,x,H):
    mb,hp,g,ge,Ka,ro,a0,c11,c12,c44,M0,A,b2,al = Const(x)

    p0 = -16 * ((((M0 * H / 2 + A * q ** 2) * c44 + H * (c11 + 2 * c12) * M0 / 2 + A * (c11 + 2 * c12) * q ** 2 - b2 ** 2 / 2) * (c44 - c11 / 2 + c12 / 2) * cos(fi) ** 4 - ((M0 * H / 2 + A * q ** 2) * c44 + H * (c11 + 2 * c12) * M0 / 2 + A * (c11 + 2 * c12) * q ** 2 - b2 ** 2 / 2) * (c44 - c11 / 2 + c12 / 2) * cos(fi) ** 2 + (c11 + c12) * b2 ** 2 / 4) * ((M0 * H / 2 + A * q ** 2) * c44 - H * (c11 - c12) * M0 / 4 - A * (c11 - c12) * q ** 2 / 2 - b2 ** 2 / 2) * cos(t) ** 6 + (-2 * (c44 - c11 / 2 + c12 / 2) * ((M0 * H / 2 + A * q ** 2) ** 2 * c44 ** 2 + 0.3e1 / 0.4e1 * (H * (c11 + 0.11e2 / 0.3e1 * c12) * M0 / 2 + A * (c11 + 0.11e2 / 0.3e1 * c12) * q ** 2 - 0.4e1 / 0.3e1 * b2 ** 2) * (M0 * H / 2 + A * q ** 2) * c44 - H ** 2 * (c11 + 2 * c12) * (c11 - c12) * M0 ** 2 / 8 - H * (A * (c11 + 2 * c12) * (c11 - c12) * q ** 2 + 0.3e1 / 0.8e1 * (c11 + 0.11e2 / 0.3e1 * c12) * b2 ** 2) * M0 / 2 - A ** 2 * (c11 + 2 * c12) * (c11 - c12) * q ** 4 / 2 - 0.3e1 / 0.8e1 * A * (c11 + 0.11e2 / 0.3e1 * c12) * b2 ** 2 * q ** 2 + b2 ** 4 / 4) * cos(fi) ** 4 + 2 * (c44 - c11 / 2 + c12 / 2) * ((M0 * H / 2 + A * q ** 2) ** 2 * c44 ** 2 + 0.3e1 / 0.4e1 * (H * (c11 + 0.11e2 / 0.3e1 * c12) * M0 / 2 + A * (c11 + 0.11e2 / 0.3e1 * c12) * q ** 2 - 0.4e1 / 0.3e1 * b2 ** 2) * (M0 * H / 2 + A * q ** 2) * c44 - H ** 2 * (c11 + 2 * c12) * (c11 - c12) * M0 ** 2 / 8 - H * (A * (c11 + 2 * c12) * (c11 - c12) * q ** 2 + 0.3e1 / 0.8e1 * (c11 + 0.11e2 / 0.3e1 * c12) * b2 ** 2) * M0 / 2 - A ** 2 * (c11 + 2 * c12) * (c11 - c12) * q ** 4 / 2 - 0.3e1 / 0.8e1 * A * (c11 + 0.11e2 / 0.3e1 * c12) * b2 ** 2 * q ** 2 + b2 ** 4 / 4) * cos(fi) ** 2 - (c11 + c12) * ((M0 * H / 2 + A * q ** 2) * c44 + b2 ** 2 / 2) * ((M0 * H / 2 + A * q ** 2) * c44 - H * (c11 - c12) * M0 / 4 - A * (c11 - c12) * q ** 2 / 2 - b2 ** 2 / 2) / 2) * cos(t) ** 4 + ((c44 - c11 / 2 + c12 / 2) * ((M0 * H / 2 + A * q ** 2) ** 2 * c44 ** 2 + 0.3e1 / 0.2e1 * (H * (c11 + 0.7e1 / 0.3e1 * c12) * M0 / 2 + A * (c11 + 0.7e1 / 0.3e1 * c12) * q ** 2 - 0.2e1 / 0.3e1 * b2 ** 2) * (M0 * H / 2 + A * q ** 2) * c44 - H ** 2 * (c11 + 2 * c12) * (c11 - c12) * M0 ** 2 / 8 - H * (A * (c11 + 2 * c12) * (c11 - c12) * q ** 2 + 0.3e1 / 0.4e1 * (c11 + 0.7e1 / 0.3e1 * c12) * b2 ** 2) * M0 / 2 - A ** 2 * (c11 + 2 * c12) * (c11 - c12) * q ** 4 / 2 - 0.3e1 / 0.4e1 * (c11 + 0.7e1 / 0.3e1 * c12) * A * b2 ** 2 * q ** 2 + b2 ** 4 / 4) * cos(fi) ** 4 - (c44 - c11 / 2 + c12 / 2) * ((M0 * H / 2 + A * q ** 2) ** 2 * c44 ** 2 + 0.3e1 / 0.2e1 * (H * (c11 + 0.7e1 / 0.3e1 * c12) * M0 / 2 + A * (c11 + 0.7e1 / 0.3e1 * c12) * q ** 2 - 0.2e1 / 0.3e1 * b2 ** 2) * (M0 * H / 2 + A * q ** 2) * c44 - H ** 2 * (c11 + 2 * c12) * (c11 - c12) * M0 ** 2 / 8 - H * (A * (c11 + 2 * c12) * (c11 - c12) * q ** 2 + 0.3e1 / 0.4e1 * (c11 + 0.7e1 / 0.3e1 * c12) * b2 ** 2) * M0 / 2 - A ** 2 * (c11 + 2 * c12) * (c11 - c12) * q ** 4 / 2 - 0.3e1 / 0.4e1 * (c11 + 0.7e1 / 0.3e1 * c12) * A * b2 ** 2 * q ** 2 + b2 ** 4 / 4) * cos(fi) ** 2 + (c11 + c12) * (M0 * H / 2 + A * q ** 2) ** 2 * c44 ** 2 / 2 - (M0 * H / 2 + A * q ** 2) * (H * (c11 ** 2 / 2 - c12 ** 2 / 2) * M0 + A * (c11 ** 2 - c12 ** 2) * q ** 2 + b2 ** 2 * (c11 + 2 * c12) / 2) * c44 / 4 - b2 ** 4 * c11 / 16) * cos(t) ** 2 - ((c44 - c11 / 2 + c12 / 2) * (c11 + c12) * cos(fi) ** 4 - (c44 - c11 / 2 + c12 / 2) * (c11 + c12) * cos(fi) ** 2 + c11 * c44 / 2) * ((M0 * H / 2 + A * q ** 2) * c44 - b2 ** 2 / 2) * (M0 * H / 2 + A * q ** 2) / 2) * ge ** 2 * q ** 6 / M0 ** 2
    p1 = complex(0, 8) * ge * ((((M0 * H / 2 + A * q ** 2) * c44 ** 2 + ((0.5e1 / 0.2e1 * A * q ** 2 + 0.5e1 / 0.4e1 * M0 * H) * c12 + (A * q ** 2 / 2 + M0 * H / 4) * c11 - b2 ** 2 / 2) * c44 + (M0 * H / 2 + A * q ** 2) * c12 ** 2 + ((-A * q ** 2 / 2 - M0 * H / 4) * c11 - 0.5e1 / 0.8e1 * b2 ** 2) * c12 + (-A * q ** 2 / 2 - M0 * H / 4) * c11 ** 2 - b2 ** 2 * c11 / 8) * cos(t) ** 2 - (c11 + c12) * ((M0 * H / 2 + A * q ** 2) * c44 - b2 ** 2 / 4) / 2) * (2 * c44 - c11 + c12) * (cos(t) + 1) ** 2 * (cos(t) - 1) ** 2 * cos(fi) ** 4 - (((M0 * H / 2 + A * q ** 2) * c44 ** 2 + ((0.5e1 / 0.2e1 * A * q ** 2 + 0.5e1 / 0.4e1 * M0 * H) * c12 + (A * q ** 2 / 2 + M0 * H / 4) * c11 - b2 ** 2 / 2) * c44 + (M0 * H / 2 + A * q ** 2) * c12 ** 2 + ((-A * q ** 2 / 2 - M0 * H / 4) * c11 - 0.5e1 / 0.8e1 * b2 ** 2) * c12 + (-A * q ** 2 / 2 - M0 * H / 4) * c11 ** 2 - b2 ** 2 * c11 / 8) * cos(t) ** 2 - (c11 + c12) * ((M0 * H / 2 + A * q ** 2) * c44 - b2 ** 2 / 4) / 2) * (2 * c44 - c11 + c12) * (cos(t) + 1) ** 2 * (cos(t) - 1) ** 2 * cos(fi) ** 2 + b2 ** 2 * (c11 + c12) * (2 * c44 - c11 + c12) * cos(t) ** 6 / 8 - ((2 * A * q ** 2 + M0 * H) * c44 ** 2 + (c12 - c11) * (M0 * H / 2 + A * q ** 2) * c44 + b2 ** 2 * (c12 - c11) / 4) * (c11 + c12) * cos(t) ** 4 / 2 + c44 * (2 * (M0 * H / 2 + A * q ** 2) * (c11 + c12) * c44 + (M0 * H / 2 + A * q ** 2) * c12 ** 2 - b2 ** 2 * c12 / 2 + (-A * q ** 2 - M0 * H / 2) * c11 ** 2 - b2 ** 2 * c11 / 4) * cos(t) ** 2 / 2 - c44 * c11 * ((M0 * H / 2 + A * q ** 2) * c44 - b2 ** 2 / 4) / 2) * q ** 6 * al / M0
    p2 = 4 * (M0 ** 2 * cos(fi) ** 2 * q ** 2 * (al ** 2 + 1) * (cos(fi) - 1) * (cos(fi) + 1) * (c11 + 2 * c12 + c44) * (c11 - c12 - 2 * c44) ** 2 * cos(t) ** 6 / 4 + (((-(-2 * c44 ** 2 + (-0.3e1 / 0.2e1 * c11 - 0.11e2 / 0.2e1 * c12) * c44 + (c11 + 2 * c12) * (c11 - c12)) * (al ** 2 + 1) * q ** 2 / 2 + H ** 2 * ge ** 2 * ro * (c11 + c12) / 4) * M0 ** 2 + A * H * q ** 2 * ge ** 2 * ro * (c11 + c12) * M0 + A ** 2 * q ** 4 * ge ** 2 * ro * (c11 + c12)) * (c11 - c12 - 2 * c44) * cos(fi) ** 4 - ((-(-2 * c44 ** 2 + (-0.3e1 / 0.2e1 * c11 - 0.11e2 / 0.2e1 * c12) * c44 + (c11 + 2 * c12) * (c11 - c12)) * (al ** 2 + 1) * q ** 2 / 2 + H ** 2 * ge ** 2 * ro * (c11 + c12) / 4) * M0 ** 2 + A * H * q ** 2 * ge ** 2 * ro * (c11 + c12) * M0 + A ** 2 * q ** 4 * ge ** 2 * ro * (c11 + c12)) * (c11 - c12 - 2 * c44) * cos(fi) ** 2 + (c11 + c12) * ((c44 * (al ** 2 + 1) * q ** 2 + H ** 2 * ge ** 2 * ro) * (c11 - c12 - 2 * c44) * M0 ** 2 / 4 + H * ge ** 2 * (A * (c11 - c12 - 2 * c44) * q ** 2 + b2 ** 2 / 2) * ro * M0 + (A * (c11 - c12 - 2 * c44) * q ** 2 + b2 ** 2) * ge ** 2 * q ** 2 * A * ro)) * cos(t) ** 4 + (-2 * ((-(al ** 2 + 1) * (-2 * c44 ** 2 + (-3 * c11 - 7 * c12) * c44 + (c11 + 2 * c12) * (c11 - c12)) * q ** 2 / 8 + H ** 2 * ge ** 2 * ro * (c11 + c12) / 4) * M0 ** 2 + A * H * q ** 2 * ge ** 2 * ro * (c11 + c12) * M0 + A ** 2 * q ** 4 * ge ** 2 * ro * (c11 + c12)) * (c11 - c12 - 2 * c44) * cos(fi) ** 4 + 2 * ((-(al ** 2 + 1) * (-2 * c44 ** 2 + (-3 * c11 - 7 * c12) * c44 + (c11 + 2 * c12) * (c11 - c12)) * q ** 2 / 8 + H ** 2 * ge ** 2 * ro * (c11 + c12) / 4) * M0 ** 2 + A * H * q ** 2 * ge ** 2 * ro * (c11 + c12) * M0 + A ** 2 * q ** 4 * ge ** 2 * ro * (c11 + c12)) * (c11 - c12 - 2 * c44) * cos(fi) ** 2 - (c11 + c12) * (c44 * (al ** 2 + 1) * q ** 2 + H ** 2 * ge ** 2 * ro) * (c11 - c12 - 2 * c44) * M0 ** 2 / 4 - H * (A * (c11 + c12) * (c11 - c12 - 2 * c44) * q ** 2 + b2 ** 2 * (c11 + 2 * c12 - c44) / 4) * ge ** 2 * ro * M0 - (A ** 2 * (c11 + c12) * (c11 - c12 - 2 * c44) * q ** 4 + b2 ** 2 * A * (c11 + 2 * c12 - c44) * q ** 2 / 2 + b2 ** 4 / 4) * ge ** 2 * ro) * cos(t) ** 2 + (c11 + c12) * ((c44 * (al ** 2 + 1) * q ** 2 / 4 + H ** 2 * ge ** 2 * ro / 4) * M0 ** 2 + A * H * M0 * ge ** 2 * q ** 2 * ro + A ** 2 * ge ** 2 * q ** 4 * ro) * (c11 - c12 - 2 * c44) * cos(fi) ** 4 - (c11 + c12) * ((c44 * (al ** 2 + 1) * q ** 2 / 4 + H ** 2 * ge ** 2 * ro / 4) * M0 ** 2 + A * H * M0 * ge ** 2 * q ** 2 * ro + A ** 2 * ge ** 2 * q ** 4 * ro) * (c11 - c12 - 2 * c44) * cos(fi) ** 2 - (c11 * c44 * (al ** 2 + 1) * q ** 2 + 2 * H ** 2 * (c11 + c44 / 2) * ge ** 2 * ro) * c44 * M0 ** 2 / 4 - 2 * (A * c44 * (c11 + c44 / 2) * q ** 2 - b2 ** 2 * (c11 + c44) / 8) * H * ge ** 2 * ro * M0 - 2 * ge ** 2 * q ** 2 * A * (A * c44 * (c11 + c44 / 2) * q ** 2 - b2 ** 2 * (c11 + c44) / 4) * ro) * q ** 4 / M0 ** 2
    p3 = complex(0, -4) * ((c11 + c12) * ((M0 * H / 2 + A * q ** 2) * (c11 - c12 - 2 * c44) * cos(fi) ** 4 - (M0 * H / 2 + A * q ** 2) * (c11 - c12 - 2 * c44) * cos(fi) ** 2 + (-2 * A * q ** 2 - M0 * H) * c44 + (M0 * H / 2 + A * q ** 2) * c11 - A * q ** 2 * c12 - H * M0 * c12 / 2 + b2 ** 2 / 2) * cos(t) ** 4 + (-2 * (c11 + c12) * (M0 * H / 2 + A * q ** 2) * (c11 - c12 - 2 * c44) * cos(fi) ** 4 + 2 * (c11 + c12) * (M0 * H / 2 + A * q ** 2) * (c11 - c12 - 2 * c44) * cos(fi) ** 2 + ((2 * A * q ** 2 + M0 * H) * c11 + b2 ** 2 / 4 + H * M0 * c12 + 2 * A * q ** 2 * c12) * c44 + (-A * q ** 2 - M0 * H / 2) * c11 ** 2 - b2 ** 2 * c11 / 4 + c12 * (A * q ** 2 * c12 + H * M0 * c12 / 2 - b2 ** 2 / 2)) * cos(t) ** 2 + (c11 + c12) * (M0 * H / 2 + A * q ** 2) * (c11 - c12 - 2 * c44) * cos(fi) ** 4 - (c11 + c12) * (M0 * H / 2 + A * q ** 2) * (c11 - c12 - 2 * c44) * cos(fi) ** 2 + (-A * q ** 2 - M0 * H / 2) * c44 ** 2 + ((-2 * A * q ** 2 - M0 * H) * c11 + b2 ** 2 / 4) * c44 + b2 ** 2 * c11 / 4) * ge * q ** 4 * al * ro / M0
    p4 = 4 * (-q ** 2 * M0 ** 2 * (al ** 2 + 1) * (cos(fi) ** 4 - cos(fi) ** 2 + 1) * (c11 + c12) * (c11 - c12 - 2 * c44) * cos(t) ** 4 / 4 + (q ** 2 * M0 ** 2 * (al ** 2 + 1) * (c11 + c12) * (c11 - c12 - 2 * c44) * cos(fi) ** 4 / 2 - q ** 2 * M0 ** 2 * (al ** 2 + 1) * (c11 + c12) * (c11 - c12 - 2 * c44) * cos(fi) ** 2 / 2 + q ** 2 * M0 ** 2 * (al ** 2 + 1) * (c11 + c12) * (c11 - c12 - 2 * c44) / 4 - H * M0 * b2 ** 2 * ge ** 2 * ro / 4 - A * b2 ** 2 * ge ** 2 * q ** 2 * ro / 2) * cos(t) ** 2 - q ** 2 * M0 ** 2 * (al ** 2 + 1) * (c11 + c12) * (c11 - c12 - 2 * c44) * cos(fi) ** 4 / 4 + q ** 2 * M0 ** 2 * (al ** 2 + 1) * (c11 + c12) * (c11 - c12 - 2 * c44) * cos(fi) ** 2 / 4 + ((c11 + c44 / 2) * c44 * (al ** 2 + 1) * q ** 2 / 2 + H ** 2 * ge ** 2 * ro * (2 * c44 + c11) / 4) * M0 ** 2 + H * (A * (2 * c44 + c11) * q ** 2 - b2 ** 2 / 4) * ge ** 2 * ro * M0 + (A * (2 * c44 + c11) * q ** 2 - b2 ** 2 / 2) * ge ** 2 * q ** 2 * A * ro) * q ** 2 * ro / M0 ** 2
    p5 = complex(0, -4) * ge * q ** 2 * (-cos(t) ** 2 * b2 ** 2 / 4 + H * (2 * c44 + c11) * M0 / 2 + A * (2 * c44 + c11) * q ** 2 - b2 ** 2 / 4) * al * ro ** 2 / M0
    p6 = -4 * (((al ** 2 + 1) * (2 * c44 + c11) * q ** 2 / 4 + H ** 2 * ge ** 2 * ro / 4) * M0 ** 2 + A * H * M0 * ge ** 2 * q ** 2 * ro + A ** 2 * ge ** 2 * q ** 4 * ro) * ro ** 2 / M0 ** 2
    p7 = complex(0, 2) / M0 * al * ge * ro ** 3 * (2 * A * q ** 2 + M0 * H)
    p8 = ro ** 3 * (al ** 2 + 1)

    return roots([p8, p7, p6, p5, p4, p3, p2, p1, p0])

def Spec_dipol_w(q,t,fi,x,H):
    mb,hp,g,ge,Ka,ro,a0,c11,c12,c44,M0,A,b2,al = Const(x)

    p0 = -8 * ge ** 2 * (4 * cos(fi) ** 2 * (c12 + c44 / 2 + c11 / 2) * pi ** 2 * (cos(fi) + 1) * M0 ** 4 * (cos(fi) - 1) * (c12 + 2 * c44 - c11) ** 2 * cos(t) ** 10 - 4 * pi * ((4 * pi * (c44 ** 2 + (0.21e2 / 0.8e1 * c12 + 0.5e1 / 0.8e1 * c11) * c44 + (c12 - c11) * (c12 + c11 / 2)) * M0 ** 2 + H * (c12 + c44 / 2 + c11 / 2) * (c12 + 2 * c44 - c11) * M0 / 2 + A * c44 ** 2 * q ** 2 + (-b2 ** 2 / 2 + A * c11 * q ** 2 / 2 + 0.5e1 / 0.2e1 * A * c12 * q ** 2) * c44 + A * c12 ** 2 * q ** 2 + (-0.5e1 / 0.8e1 * b2 ** 2 - A * c11 * q ** 2 / 2) * c12 - b2 ** 2 * c11 / 8 - A * q ** 2 * c11 ** 2 / 2) * cos(fi) ** 4 + (-4 * pi * (c44 ** 2 + (0.21e2 / 0.8e1 * c12 + 0.5e1 / 0.8e1 * c11) * c44 + (c12 - c11) * (c12 + c11 / 2)) * M0 ** 2 - H * (c12 + c44 / 2 + c11 / 2) * (c12 + 2 * c44 - c11) * M0 / 2 - A * c44 ** 2 * q ** 2 + (b2 ** 2 / 2 - A * c11 * q ** 2 / 2 - 0.5e1 / 0.2e1 * A * c12 * q ** 2) * c44 - A * c12 ** 2 * q ** 2 + (0.5e1 / 0.8e1 * b2 ** 2 + A * c11 * q ** 2 / 2) * c12 + b2 ** 2 * c11 / 8 + A * q ** 2 * c11 ** 2 / 2) * cos(fi) ** 2 + (c12 + c11) * (M0 ** 2 * c44 * pi + b2 ** 2 / 4) / 2) * M0 ** 2 * (c12 + 2 * c44 - c11) * cos(t) ** 8 + ((24 * (c44 ** 2 + (0.17e2 / 0.6e1 * c12 + 0.5e1 / 0.6e1 * c11) * c44 + (c12 - c11) * (c12 + c11 / 2)) * pi ** 2 * M0 ** 4 + 6 * H * (c44 ** 2 + (0.8e1 / 0.3e1 * c12 + 0.2e1 / 0.3e1 * c11) * c44 + (c12 - c11) * (c12 + c11 / 2)) * pi * M0 ** 3 + ((H ** 2 / 4 + 12 * A * q ** 2 * pi) * c44 ** 2 + ((0.5e1 / 0.8e1 * H ** 2 + 32 * A * q ** 2 * pi) * c12 + (H ** 2 / 8 + 8 * A * q ** 2 * pi) * c11 - 6 * b2 ** 2 * pi) * c44 + (H ** 2 / 4 + 12 * A * q ** 2 * pi) * c12 ** 2 + ((-H ** 2 / 8 - 6 * A * q ** 2 * pi) * c11 - 8 * b2 ** 2 * pi) * c12 + (-H ** 2 / 8 - 6 * A * q ** 2 * pi) * c11 ** 2 - 2 * b2 ** 2 * pi * c11) * M0 ** 2 + H * (A * c44 ** 2 * q ** 2 + (-b2 ** 2 / 2 + A * c11 * q ** 2 / 2 + 0.5e1 / 0.2e1 * A * c12 * q ** 2) * c44 + A * c12 ** 2 * q ** 2 + (-0.5e1 / 0.8e1 * b2 ** 2 - A * c11 * q ** 2 / 2) * c12 - b2 ** 2 * c11 / 8 - A * q ** 2 * c11 ** 2 / 2) * M0 + (-A * c11 * q ** 2 + A * c12 * q ** 2 + 2 * A * c44 * q ** 2 - b2 ** 2) * (A * c12 * q ** 2 + A * c44 * q ** 2 / 2 + A * c11 * q ** 2 / 2 - b2 ** 2 / 4)) * (c12 + 2 * c44 - c11) * cos(fi) ** 4 - (24 * (c44 ** 2 + (0.17e2 / 0.6e1 * c12 + 0.5e1 / 0.6e1 * c11) * c44 + (c12 - c11) * (c12 + c11 / 2)) * pi ** 2 * M0 ** 4 + 6 * H * (c44 ** 2 + (0.8e1 / 0.3e1 * c12 + 0.2e1 / 0.3e1 * c11) * c44 + (c12 - c11) * (c12 + c11 / 2)) * pi * M0 ** 3 + ((H ** 2 / 4 + 12 * A * q ** 2 * pi) * c44 ** 2 + ((0.5e1 / 0.8e1 * H ** 2 + 32 * A * q ** 2 * pi) * c12 + (H ** 2 / 8 + 8 * A * q ** 2 * pi) * c11 - 6 * b2 ** 2 * pi) * c44 + (H ** 2 / 4 + 12 * A * q ** 2 * pi) * c12 ** 2 + ((-H ** 2 / 8 - 6 * A * q ** 2 * pi) * c11 - 8 * b2 ** 2 * pi) * c12 + (-H ** 2 / 8 - 6 * A * q ** 2 * pi) * c11 ** 2 - 2 * b2 ** 2 * pi * c11) * M0 ** 2 + H * (A * c44 ** 2 * q ** 2 + (-b2 ** 2 / 2 + A * c11 * q ** 2 / 2 + 0.5e1 / 0.2e1 * A * c12 * q ** 2) * c44 + A * c12 ** 2 * q ** 2 + (-0.5e1 / 0.8e1 * b2 ** 2 - A * c11 * q ** 2 / 2) * c12 - b2 ** 2 * c11 / 8 - A * q ** 2 * c11 ** 2 / 2) * M0 + (-A * c11 * q ** 2 + A * c12 * q ** 2 + 2 * A * c44 * q ** 2 - b2 ** 2) * (A * c12 * q ** 2 + A * c44 * q ** 2 / 2 + A * c11 * q ** 2 / 2 - b2 ** 2 / 4)) * (c12 + 2 * c44 - c11) * cos(fi) ** 2 + 2 * (c12 + c11) * (3 * c44 * pi ** 2 * (c12 + 2 * c44 - c11) * M0 ** 4 + c44 * H * pi * (c12 + 2 * c44 - c11) * M0 ** 3 / 2 + (2 * A * c44 ** 2 * q ** 2 + (A * c12 * q ** 2 - A * c11 * q ** 2 + b2 ** 2 / 2) * c44 + b2 ** 2 * (c12 - c11) / 2) * pi * M0 ** 2 + H * b2 ** 2 * (c12 + 2 * c44 - c11) * M0 / 16 + b2 ** 2 * (-A * c11 * q ** 2 + A * c12 * q ** 2 + 2 * A * c44 * q ** 2 - b2 ** 2) / 8)) * cos(t) ** 6 + (-2 * (8 * pi ** 2 * (c44 ** 2 + (0.13e2 / 0.4e1 * c12 + 0.5e1 / 0.4e1 * c11) * c44 + (c12 - c11) * (c12 + c11 / 2)) * M0 ** 4 + 3 * H * pi * (c44 ** 2 + (3 * c12 + c11) * c44 + (c12 - c11) * (c12 + c11 / 2)) * M0 ** 3 + ((H ** 2 / 4 + 6 * A * q ** 2 * pi) * c44 ** 2 + ((0.11e2 / 0.16e2 * H ** 2 + 18 * A * q ** 2 * pi) * c12 + (0.3e1 / 0.16e2 * H ** 2 + 6 * A * q ** 2 * pi) * c11 - 3 * b2 ** 2 * pi) * c44 + (H ** 2 / 4 + 6 * A * q ** 2 * pi) * c12 ** 2 + ((-H ** 2 / 8 - 3 * A * q ** 2 * pi) * c11 - 0.9e1 / 0.2e1 * b2 ** 2 * pi) * c12 + (-H ** 2 / 8 - 3 * A * q ** 2 * pi) * c11 ** 2 - 0.3e1 / 0.2e1 * b2 ** 2 * pi * c11) * M0 ** 2 + H * (A * c44 ** 2 * q ** 2 + (-b2 ** 2 / 2 + 0.3e1 / 0.4e1 * A * c11 * q ** 2 + 0.11e2 / 0.4e1 * A * c12 * q ** 2) * c44 + A * c12 ** 2 * q ** 2 + (-0.11e2 / 0.16e2 * b2 ** 2 - A * c11 * q ** 2 / 2) * c12 - 0.3e1 / 0.16e2 * b2 ** 2 * c11 - A * q ** 2 * c11 ** 2 / 2) * M0 + A ** 2 * c44 ** 2 * q ** 4 + (0.11e2 / 0.4e1 * A ** 2 * c12 * q ** 4 + 0.3e1 / 0.4e1 * A ** 2 * q ** 4 * c11 - A * q ** 2 * b2 ** 2) * c44 + A ** 2 * c12 ** 2 * q ** 4 + (-A ** 2 * q ** 4 * c11 / 2 - 0.11e2 / 0.8e1 * A * q ** 2 * b2 ** 2) * c12 + b2 ** 4 / 4 - A ** 2 * q ** 4 * c11 ** 2 / 2 - 0.3e1 / 0.8e1 * A * q ** 2 * b2 ** 2 * c11) * (c12 + 2 * c44 - c11) * cos(fi) ** 4 + 2 * (8 * pi ** 2 * (c44 ** 2 + (0.13e2 / 0.4e1 * c12 + 0.5e1 / 0.4e1 * c11) * c44 + (c12 - c11) * (c12 + c11 / 2)) * M0 ** 4 + 3 * H * pi * (c44 ** 2 + (3 * c12 + c11) * c44 + (c12 - c11) * (c12 + c11 / 2)) * M0 ** 3 + ((H ** 2 / 4 + 6 * A * q ** 2 * pi) * c44 ** 2 + ((0.11e2 / 0.16e2 * H ** 2 + 18 * A * q ** 2 * pi) * c12 + (0.3e1 / 0.16e2 * H ** 2 + 6 * A * q ** 2 * pi) * c11 - 3 * b2 ** 2 * pi) * c44 + (H ** 2 / 4 + 6 * A * q ** 2 * pi) * c12 ** 2 + ((-H ** 2 / 8 - 3 * A * q ** 2 * pi) * c11 - 0.9e1 / 0.2e1 * b2 ** 2 * pi) * c12 + (-H ** 2 / 8 - 3 * A * q ** 2 * pi) * c11 ** 2 - 0.3e1 / 0.2e1 * b2 ** 2 * pi * c11) * M0 ** 2 + H * (A * c44 ** 2 * q ** 2 + (-b2 ** 2 / 2 + 0.3e1 / 0.4e1 * A * c11 * q ** 2 + 0.11e2 / 0.4e1 * A * c12 * q ** 2) * c44 + A * c12 ** 2 * q ** 2 + (-0.11e2 / 0.16e2 * b2 ** 2 - A * c11 * q ** 2 / 2) * c12 - 0.3e1 / 0.16e2 * b2 ** 2 * c11 - A * q ** 2 * c11 ** 2 / 2) * M0 + A ** 2 * c44 ** 2 * q ** 4 + (0.11e2 / 0.4e1 * A ** 2 * c12 * q ** 4 + 0.3e1 / 0.4e1 * A ** 2 * q ** 4 * c11 - A * q ** 2 * b2 ** 2) * c44 + A ** 2 * c12 ** 2 * q ** 4 + (-A ** 2 * q ** 4 * c11 / 2 - 0.11e2 / 0.8e1 * A * q ** 2 * b2 ** 2) * c12 + b2 ** 4 / 4 - A ** 2 * q ** 4 * c11 ** 2 / 2 - 0.3e1 / 0.8e1 * A * q ** 2 * b2 ** 2 * c11) * (c12 + 2 * c44 - c11) * cos(fi) ** 2 - 6 * pi ** 2 * c44 * ((2 * c12 + 0.7e1 / 0.3e1 * c11) * c44 + c12 ** 2 - c11 ** 2) * M0 ** 4 - 2 * c44 * H * pi * (c12 + c11) * (c12 + 2 * c44 - c11) * M0 ** 3 + (-8 * (c12 + c11) * (H ** 2 / 32 + A * q ** 2 * pi) * c44 ** 2 + ((-4 * A * q ** 2 * pi - H ** 2 / 8) * c12 ** 2 + c12 * b2 ** 2 * pi + (4 * A * q ** 2 * pi + H ** 2 / 8) * c11 ** 2 + b2 ** 2 * pi * c11 / 2) * c44 - b2 ** 2 * pi * (c12 - c11) * (c12 + c11) / 2) * M0 ** 2 - (c12 + c11) * H * (2 * A * c44 ** 2 * q ** 2 + A * q ** 2 * (c12 - c11) * c44 + b2 ** 2 * (c12 - c11) / 4) * M0 / 2 - (c12 + c11) * (-A * c11 * q ** 2 + A * c12 * q ** 2 + 2 * A * c44 * q ** 2 - b2 ** 2) * (A * c44 * q ** 2 + b2 ** 2 / 2) / 2) * cos(t) ** 4 + ((c12 + 2 * c44 - c11) * (4 * pi ** 2 * (c44 ** 2 + (0.9e1 / 0.2e1 * c12 + 0.5e1 / 0.2e1 * c11) * c44 + (c12 - c11) * (c12 + c11 / 2)) * M0 ** 4 + 2 * (c44 ** 2 + (4 * c12 + 2 * c11) * c44 + (c12 - c11) * (c12 + c11 / 2)) * H * pi * M0 ** 3 + ((H ** 2 / 4 + 4 * A * q ** 2 * pi) * c44 ** 2 + ((0.7e1 / 0.8e1 * H ** 2 + 16 * A * q ** 2 * pi) * c12 + (0.3e1 / 0.8e1 * H ** 2 + 8 * A * q ** 2 * pi) * c11 - 2 * b2 ** 2 * pi) * c44 + 4 * ((H ** 2 / 16 + A * q ** 2 * pi) * c12 + (-A * q ** 2 * pi - H ** 2 / 16) * c11 - b2 ** 2 * pi) * (c12 + c11 / 2)) * M0 ** 2 + H * (A * c44 ** 2 * q ** 2 + (-b2 ** 2 / 2 + 0.3e1 / 0.2e1 * A * c11 * q ** 2 + 0.7e1 / 0.2e1 * A * c12 * q ** 2) * c44 + A * c12 ** 2 * q ** 2 + (-0.7e1 / 0.8e1 * b2 ** 2 - A * c11 * q ** 2 / 2) * c12 - 0.3e1 / 0.8e1 * b2 ** 2 * c11 - A * q ** 2 * c11 ** 2 / 2) * M0 + A ** 2 * c44 ** 2 * q ** 4 + (0.7e1 / 0.2e1 * A ** 2 * c12 * q ** 4 + 0.3e1 / 0.2e1 * A ** 2 * q ** 4 * c11 - A * q ** 2 * b2 ** 2) * c44 + A ** 2 * c12 ** 2 * q ** 4 + (-A ** 2 * q ** 4 * c11 / 2 - 0.7e1 / 0.4e1 * A * q ** 2 * b2 ** 2) * c12 + b2 ** 4 / 4 - A ** 2 * q ** 4 * c11 ** 2 / 2 - 0.3e1 / 0.4e1 * A * q ** 2 * b2 ** 2 * c11) * cos(fi) ** 4 - (c12 + 2 * c44 - c11) * (4 * pi ** 2 * (c44 ** 2 + (0.9e1 / 0.2e1 * c12 + 0.5e1 / 0.2e1 * c11) * c44 + (c12 - c11) * (c12 + c11 / 2)) * M0 ** 4 + 2 * (c44 ** 2 + (4 * c12 + 2 * c11) * c44 + (c12 - c11) * (c12 + c11 / 2)) * H * pi * M0 ** 3 + ((H ** 2 / 4 + 4 * A * q ** 2 * pi) * c44 ** 2 + ((0.7e1 / 0.8e1 * H ** 2 + 16 * A * q ** 2 * pi) * c12 + (0.3e1 / 0.8e1 * H ** 2 + 8 * A * q ** 2 * pi) * c11 - 2 * b2 ** 2 * pi) * c44 + 4 * ((H ** 2 / 16 + A * q ** 2 * pi) * c12 + (-A * q ** 2 * pi - H ** 2 / 16) * c11 - b2 ** 2 * pi) * (c12 + c11 / 2)) * M0 ** 2 + H * (A * c44 ** 2 * q ** 2 + (-b2 ** 2 / 2 + 0.3e1 / 0.2e1 * A * c11 * q ** 2 + 0.7e1 / 0.2e1 * A * c12 * q ** 2) * c44 + A * c12 ** 2 * q ** 2 + (-0.7e1 / 0.8e1 * b2 ** 2 - A * c11 * q ** 2 / 2) * c12 - 0.3e1 / 0.8e1 * b2 ** 2 * c11 - A * q ** 2 * c11 ** 2 / 2) * M0 + A ** 2 * c44 ** 2 * q ** 4 + (0.7e1 / 0.2e1 * A ** 2 * c12 * q ** 4 + 0.3e1 / 0.2e1 * A ** 2 * q ** 4 * c11 - A * q ** 2 * b2 ** 2) * c44 + A ** 2 * c12 ** 2 * q ** 4 + (-A ** 2 * q ** 4 * c11 / 2 - 0.7e1 / 0.4e1 * A * q ** 2 * b2 ** 2) * c12 + b2 ** 4 / 4 - A ** 2 * q ** 4 * c11 ** 2 / 2 - 0.3e1 / 0.4e1 * A * q ** 2 * b2 ** 2 * c11) * cos(fi) ** 2 + 2 * ((2 * c12 + 4 * c11) * c44 + c12 ** 2 - c11 ** 2) * pi ** 2 * c44 * M0 ** 4 + H * pi * ((2 * c12 + 3 * c11) * c44 + c12 ** 2 - c11 ** 2) * c44 * M0 ** 3 + 2 * (((2 * A * q ** 2 * pi + H ** 2 / 8) * c12 + 3 * (H ** 2 / 24 + A * q ** 2 * pi) * c11) * c44 + (c12 + c11) * ((H ** 2 / 16 + A * q ** 2 * pi) * c12 + (-A * q ** 2 * pi - H ** 2 / 16) * c11 - b2 ** 2 * pi / 2)) * c44 * M0 ** 2 + H * (2 * A * q ** 2 * (c12 + c11) * c44 + A * c12 ** 2 * q ** 2 - A * q ** 2 * c11 ** 2 - c12 * b2 ** 2 / 2 - b2 ** 2 * c11 / 4) * c44 * M0 / 2 + A ** 2 * q ** 4 * (c12 + c11) * c44 ** 2 + (A * c12 ** 2 * q ** 2 - A * q ** 2 * c11 ** 2 - c12 * b2 ** 2 - b2 ** 2 * c11 / 2) * A * q ** 2 * c44 / 2 - b2 ** 4 * c11 / 8) * cos(t) ** 2 - (A * c44 * q ** 2 + 2 * M0 ** 2 * c44 * pi + H * M0 * c44 / 2 - b2 ** 2 / 2) * ((c12 + c11) * (c12 + 2 * c44 - c11) * cos(fi) ** 4 - (c12 + c11) * (c12 + 2 * c44 - c11) * cos(fi) ** 2 + c44 * c11) * (A * q ** 2 + 2 * M0 ** 2 * pi + H * M0 / 2) / 2) * q ** 6 / M0 ** 2
    p1 = complex(0, 4) * al * (-2 * cos(fi) ** 2 * M0 ** 2 * pi * (cos(fi) - 1) * (cos(fi) + 1) * (c11 + 2 * c12 + c44) * (c11 - c12 - 2 * c44) ** 2 * cos(t) ** 8 + (c11 - c12 - 2 * c44) * (((-2 * A * q ** 2 - 12 * M0 ** 2 * pi - H * M0) * c44 ** 2 + (-8 * pi * (c11 + 4 * c12) * M0 ** 2 - H * (5 * c12 + c11) * M0 / 2 - A * c11 * q ** 2 - 5 * A * c12 * q ** 2 + b2 ** 2) * c44 + 6 * pi * (c11 + 2 * c12) * (c11 - c12) * M0 ** 2 + H * (c11 + 2 * c12) * (c11 - c12) * M0 / 2 - 2 * A * c12 ** 2 * q ** 2 + (A * c11 * q ** 2 + 0.5e1 / 0.4e1 * b2 ** 2) * c12 + c11 * (b2 ** 2 / 4 + A * c11 * q ** 2)) * cos(fi) ** 4 + ((2 * A * q ** 2 + 12 * M0 ** 2 * pi + H * M0) * c44 ** 2 + (8 * pi * (c11 + 4 * c12) * M0 ** 2 + H * (5 * c12 + c11) * M0 / 2 + A * c11 * q ** 2 + 5 * A * c12 * q ** 2 - b2 ** 2) * c44 - 6 * pi * (c11 + 2 * c12) * (c11 - c12) * M0 ** 2 - H * (c11 + 2 * c12) * (c11 - c12) * M0 / 2 + 2 * A * c12 ** 2 * q ** 2 + (-A * c11 * q ** 2 - 0.5e1 / 0.4e1 * b2 ** 2) * c12 - b2 ** 2 * c11 / 4 - A * q ** 2 * c11 ** 2) * cos(fi) ** 2 - 2 * (c12 + c11) * (M0 ** 2 * c44 * pi + b2 ** 2 / 8)) * cos(t) ** 6 + (-2 * ((-2 * A * q ** 2 - 6 * M0 ** 2 * pi - H * M0) * c44 ** 2 + (-6 * pi * (3 * c12 + c11) * M0 ** 2 - 0.3e1 / 0.4e1 * H * (c11 + 0.11e2 / 0.3e1 * c12) * M0 - 0.3e1 / 0.2e1 * A * c11 * q ** 2 - 0.11e2 / 0.2e1 * A * c12 * q ** 2 + b2 ** 2) * c44 + 3 * pi * (c11 + 2 * c12) * (c11 - c12) * M0 ** 2 + H * (c11 + 2 * c12) * (c11 - c12) * M0 / 2 - 2 * A * c12 ** 2 * q ** 2 + (A * c11 * q ** 2 + 0.11e2 / 0.8e1 * b2 ** 2) * c12 + c11 * (A * c11 * q ** 2 + 0.3e1 / 0.8e1 * b2 ** 2)) * (c11 - c12 - 2 * c44) * cos(fi) ** 4 + 2 * ((-2 * A * q ** 2 - 6 * M0 ** 2 * pi - H * M0) * c44 ** 2 + (-6 * pi * (3 * c12 + c11) * M0 ** 2 - 0.3e1 / 0.4e1 * H * (c11 + 0.11e2 / 0.3e1 * c12) * M0 - 0.3e1 / 0.2e1 * A * c11 * q ** 2 - 0.11e2 / 0.2e1 * A * c12 * q ** 2 + b2 ** 2) * c44 + 3 * pi * (c11 + 2 * c12) * (c11 - c12) * M0 ** 2 + H * (c11 + 2 * c12) * (c11 - c12) * M0 / 2 - 2 * A * c12 ** 2 * q ** 2 + (A * c11 * q ** 2 + 0.11e2 / 0.8e1 * b2 ** 2) * c12 + c11 * (A * c11 * q ** 2 + 0.3e1 / 0.8e1 * b2 ** 2)) * (c11 - c12 - 2 * c44) * cos(fi) ** 2 + (c12 + c11) * ((-2 * A * q ** 2 - 8 * M0 ** 2 * pi - H * M0) * c44 ** 2 + (A * q ** 2 + 4 * M0 ** 2 * pi + H * M0 / 2) * (c11 - c12) * c44 + b2 ** 2 * (c11 - c12) / 4)) * cos(t) ** 4 + ((c11 - c12 - 2 * c44) * ((-2 * A * q ** 2 - 4 * M0 ** 2 * pi - H * M0) * c44 ** 2 + (-8 * pi * (c11 + 2 * c12) * M0 ** 2 - 0.3e1 / 0.2e1 * H * (c11 + 0.7e1 / 0.3e1 * c12) * M0 - 3 * A * c11 * q ** 2 - 7 * A * c12 * q ** 2 + b2 ** 2) * c44 + 2 * pi * (c11 + 2 * c12) * (c11 - c12) * M0 ** 2 + H * (c11 + 2 * c12) * (c11 - c12) * M0 / 2 - 2 * A * c12 ** 2 * q ** 2 + (A * c11 * q ** 2 + 0.7e1 / 0.4e1 * b2 ** 2) * c12 + c11 * (A * c11 * q ** 2 + 0.3e1 / 0.4e1 * b2 ** 2)) * cos(fi) ** 4 - (c11 - c12 - 2 * c44) * ((-2 * A * q ** 2 - 4 * M0 ** 2 * pi - H * M0) * c44 ** 2 + (-8 * pi * (c11 + 2 * c12) * M0 ** 2 - 0.3e1 / 0.2e1 * H * (c11 + 0.7e1 / 0.3e1 * c12) * M0 - 3 * A * c11 * q ** 2 - 7 * A * c12 * q ** 2 + b2 ** 2) * c44 + 2 * pi * (c11 + 2 * c12) * (c11 - c12) * M0 ** 2 + H * (c11 + 2 * c12) * (c11 - c12) * M0 / 2 - 2 * A * c12 ** 2 * q ** 2 + (A * c11 * q ** 2 + 0.7e1 / 0.4e1 * b2 ** 2) * c12 + c11 * (A * c11 * q ** 2 + 0.3e1 / 0.4e1 * b2 ** 2)) * cos(fi) ** 2 - ((-6 * (c11 + 0.2e1 / 0.3e1 * c12) * pi * M0 ** 2 - H * (c12 + c11) * M0 - 2 * A * q ** 2 * (c12 + c11)) * c44 + (2 * c11 ** 2 * pi - 2 * c12 ** 2 * pi) * M0 ** 2 + (c11 ** 2 * H / 2 - c12 ** 2 * H / 2) * M0 - A * c12 ** 2 * q ** 2 + c12 * b2 ** 2 / 2 + c11 * (b2 ** 2 / 4 + A * c11 * q ** 2)) * c44) * cos(t) ** 2 + ((A * q ** 2 + 2 * M0 ** 2 * pi + H * M0 / 2) * c44 - b2 ** 2 / 4) * ((c12 + c11) * (c11 - c12 - 2 * c44) * cos(fi) ** 4 - (c12 + c11) * (c11 - c12 - 2 * c44) * cos(fi) ** 2 - c44 * c11)) * ge * q ** 6 / M0
    p2 = 4 * (4 * ro * M0 ** 4 * ge ** 2 * pi ** 2 * (cos(fi) ** 4 - cos(fi) ** 2 + 1) * (c12 + c11) * (c11 - c12 - 2 * c44) * cos(t) ** 8 - 4 * ((4 * ro * ge ** 2 * pi ** 2 * (c12 + c11) * M0 ** 2 + ro * H * ge ** 2 * pi * (c12 + c11) * M0 / 2 + (A * ro * pi * (c12 + c11) * ge ** 2 - (al ** 2 + 1) * (c11 + 2 * c12 + c44) * (c11 - c12 - 2 * c44) / 16) * q ** 2) * (c11 - c12 - 2 * c44) * cos(fi) ** 4 - (4 * ro * ge ** 2 * pi ** 2 * (c12 + c11) * M0 ** 2 + ro * H * ge ** 2 * pi * (c12 + c11) * M0 / 2 + (A * ro * pi * (c12 + c11) * ge ** 2 - (al ** 2 + 1) * (c11 + 2 * c12 + c44) * (c11 - c12 - 2 * c44) / 16) * q ** 2) * (c11 - c12 - 2 * c44) * cos(fi) ** 2 + (3 * pi * (c11 - c12 - 2 * c44) * M0 ** 2 + H * (c11 - c12 - 2 * c44) * M0 / 2 + A * (c11 - c12 - 2 * c44) * q ** 2 + b2 ** 2 / 2) * (c12 + c11) * ro * ge ** 2 * pi) * M0 ** 2 * cos(t) ** 6 + ((24 * ro * ge ** 2 * pi ** 2 * (c12 + c11) * M0 ** 4 + 6 * ro * H * ge ** 2 * pi * (c12 + c11) * M0 ** 3 + (12 * (c12 + c11) * (A * q ** 2 * pi + H ** 2 / 48) * ro * ge ** 2 - (-2 * c44 ** 2 + (-0.3e1 / 0.2e1 * c11 - 0.11e2 / 0.2e1 * c12) * c44 + (c11 + 2 * c12) * (c11 - c12)) * q ** 2 * (al ** 2 + 1) / 2) * M0 ** 2 + A * ro * H * q ** 2 * ge ** 2 * (c12 + c11) * M0 + A ** 2 * ro * q ** 4 * ge ** 2 * (c12 + c11)) * (c11 - c12 - 2 * c44) * cos(fi) ** 4 - (24 * ro * ge ** 2 * pi ** 2 * (c12 + c11) * M0 ** 4 + 6 * ro * H * ge ** 2 * pi * (c12 + c11) * M0 ** 3 + (12 * (c12 + c11) * (A * q ** 2 * pi + H ** 2 / 48) * ro * ge ** 2 - (-2 * c44 ** 2 + (-0.3e1 / 0.2e1 * c11 - 0.11e2 / 0.2e1 * c12) * c44 + (c11 + 2 * c12) * (c11 - c12)) * q ** 2 * (al ** 2 + 1) / 2) * M0 ** 2 + A * ro * H * q ** 2 * ge ** 2 * (c12 + c11) * M0 + A ** 2 * ro * q ** 4 * ge ** 2 * (c12 + c11)) * (c11 - c12 - 2 * c44) * cos(fi) ** 2 + 12 * ro * (-c44 ** 2 / 3 + (-0.8e1 / 0.3e1 * c11 - 2 * c12) * c44 + c11 ** 2 - c12 ** 2) * ge ** 2 * pi ** 2 * M0 ** 4 + 4 * ro * H * ge ** 2 * pi * (c12 + c11) * (c11 - c12 - 2 * c44) * M0 ** 3 + (8 * (A * pi * (c12 + c11) * (c11 - c12 - 2 * c44) * q ** 2 + (-c11 * H ** 2 / 16 - c12 * H ** 2 / 16 - b2 ** 2 * pi / 8) * c44 + c11 ** 2 * H ** 2 / 32 + 0.3e1 / 0.8e1 * b2 ** 2 * pi * c11 - H ** 2 * c12 ** 2 / 32 + c12 * b2 ** 2 * pi / 2) * ro * ge ** 2 + c44 * q ** 2 * (al ** 2 + 1) * (c12 + c11) * (c11 - c12 - 2 * c44) / 4) * M0 ** 2 + (c12 + c11) * H * ro * (A * (c11 - c12 - 2 * c44) * q ** 2 + b2 ** 2 / 2) * ge ** 2 * M0 + (A * (c11 - c12 - 2 * c44) * q ** 2 + b2 ** 2) * (c12 + c11) * ro * ge ** 2 * A * q ** 2) * cos(t) ** 4 + (-2 * (8 * ro * ge ** 2 * pi ** 2 * (c12 + c11) * M0 ** 4 + 3 * ro * H * ge ** 2 * pi * (c12 + c11) * M0 ** 3 + (6 * (c12 + c11) * (H ** 2 / 24 + A * q ** 2 * pi) * ro * ge ** 2 - (-2 * c44 ** 2 + (-3 * c11 - 7 * c12) * c44 + (c11 + 2 * c12) * (c11 - c12)) * q ** 2 * (al ** 2 + 1) / 8) * M0 ** 2 + A * ro * H * q ** 2 * ge ** 2 * (c12 + c11) * M0 + A ** 2 * ro * q ** 4 * ge ** 2 * (c12 + c11)) * (c11 - c12 - 2 * c44) * cos(fi) ** 4 + 2 * (8 * ro * ge ** 2 * pi ** 2 * (c12 + c11) * M0 ** 4 + 3 * ro * H * ge ** 2 * pi * (c12 + c11) * M0 ** 3 + (6 * (c12 + c11) * (H ** 2 / 24 + A * q ** 2 * pi) * ro * ge ** 2 - (-2 * c44 ** 2 + (-3 * c11 - 7 * c12) * c44 + (c11 + 2 * c12) * (c11 - c12)) * q ** 2 * (al ** 2 + 1) / 8) * M0 ** 2 + A * ro * H * q ** 2 * ge ** 2 * (c12 + c11) * M0 + A ** 2 * ro * q ** 4 * ge ** 2 * (c12 + c11)) * (c11 - c12 - 2 * c44) * cos(fi) ** 2 - 4 * ro * ge ** 2 * pi ** 2 * (-2 * c44 ** 2 + (-6 * c11 - 2 * c12) * c44 + c11 ** 2 - c12 ** 2) * M0 ** 4 - 2 * H * ro * ge ** 2 * (-c44 ** 2 + (-4 * c11 - 2 * c12) * c44 + c11 ** 2 - c12 ** 2) * pi * M0 ** 3 + (-4 * ro * (A * (-c44 ** 2 + (-4 * c11 - 2 * c12) * c44 + c11 ** 2 - c12 ** 2) * pi * q ** 2 + (c12 + c11) * (c11 * H ** 2 - c12 * H ** 2 - 2 * H ** 2 * c44 + 8 * b2 ** 2 * pi) / 16) * ge ** 2 - c44 * q ** 2 * (al ** 2 + 1) * (c12 + c11) * (c11 - c12 - 2 * c44) / 4) * M0 ** 2 - (A * (c12 + c11) * (c11 - c12 - 2 * c44) * q ** 2 + b2 ** 2 * (c11 + 2 * c12 - c44) / 4) * H * ro * ge ** 2 * M0 - (A ** 2 * (c12 + c11) * (c11 - c12 - 2 * c44) * q ** 4 + A * b2 ** 2 * (c11 + 2 * c12 - c44) * q ** 2 / 2 + b2 ** 4 / 4) * ro * ge ** 2) * cos(t) ** 2 + (c12 + c11) * (4 * M0 ** 4 * ge ** 2 * pi ** 2 * ro + 2 * H * M0 ** 3 * ge ** 2 * pi * ro + (4 * (H ** 2 / 16 + A * q ** 2 * pi) * ro * ge ** 2 + c44 * q ** 2 * (al ** 2 + 1) / 4) * M0 ** 2 + A * H * M0 * ge ** 2 * q ** 2 * ro + A ** 2 * ge ** 2 * q ** 4 * ro) * (c11 - c12 - 2 * c44) * cos(fi) ** 4 - (c12 + c11) * (4 * M0 ** 4 * ge ** 2 * pi ** 2 * ro + 2 * H * M0 ** 3 * ge ** 2 * pi * ro + (4 * (H ** 2 / 16 + A * q ** 2 * pi) * ro * ge ** 2 + c44 * q ** 2 * (al ** 2 + 1) / 4) * M0 ** 2 + A * H * M0 * ge ** 2 * q ** 2 * ro + A ** 2 * ge ** 2 * q ** 4 * ro) * (c11 - c12 - 2 * c44) * cos(fi) ** 2 - 8 * ro * ge ** 2 * (c11 + c44 / 2) * pi ** 2 * c44 * M0 ** 4 - 4 * H * ro * ge ** 2 * (c11 + c44 / 2) * pi * c44 * M0 ** 3 + (-8 * (A * c44 * pi * (c11 + c44 / 2) * q ** 2 + H ** 2 * c44 ** 2 / 32 + (c11 * H ** 2 / 16 - b2 ** 2 * pi / 8) * c44 - b2 ** 2 * pi * c11 / 8) * ro * ge ** 2 - c11 * c44 ** 2 * q ** 2 * (al ** 2 + 1) / 4) * M0 ** 2 - 2 * (A * c44 * (c11 + c44 / 2) * q ** 2 - b2 ** 2 * (c11 + c44) / 8) * H * ro * ge ** 2 * M0 - 2 * (A * c44 * (c11 + c44 / 2) * q ** 2 - b2 ** 2 * (c11 + c44) / 4) * ro * ge ** 2 * A * q ** 2) * q ** 4 / M0 ** 2
    p3 = complex(0, -4) * al * (-2 * M0 ** 2 * pi * (cos(fi) ** 4 - cos(fi) ** 2 + 1) * (c12 + c11) * (c11 - c12 - 2 * c44) * cos(t) ** 6 + (c12 + c11) * ((A * q ** 2 + 6 * M0 ** 2 * pi + H * M0 / 2) * (c11 - c12 - 2 * c44) * cos(fi) ** 4 - (A * q ** 2 + 6 * M0 ** 2 * pi + H * M0 / 2) * (c11 - c12 - 2 * c44) * cos(fi) ** 2 + 4 * pi * (c11 - c12 - 2 * c44) * M0 ** 2 + H * (c11 - c12 - 2 * c44) * M0 / 2 + A * c11 * q ** 2 - A * c12 * q ** 2 - 2 * A * c44 * q ** 2 + b2 ** 2 / 2) * cos(t) ** 4 + (-2 * (c12 + c11) * (A * q ** 2 + 3 * M0 ** 2 * pi + H * M0 / 2) * (c11 - c12 - 2 * c44) * cos(fi) ** 4 + 2 * (c12 + c11) * (A * q ** 2 + 3 * M0 ** 2 * pi + H * M0 / 2) * (c11 - c12 - 2 * c44) * cos(fi) ** 2 - 2 * (-c44 ** 2 + (-4 * c11 - 2 * c12) * c44 + c11 ** 2 - c12 ** 2) * pi * M0 ** 2 - H * (c12 + c11) * (c11 - c12 - 2 * c44) * M0 / 2 + (2 * A * c12 * q ** 2 + 2 * A * c11 * q ** 2 + b2 ** 2 / 4) * c44 - A * q ** 2 * c11 ** 2 - b2 ** 2 * c11 / 4 + c12 * (A * c12 * q ** 2 - b2 ** 2 / 2)) * cos(t) ** 2 + (c12 + c11) * (c11 - c12 - 2 * c44) * (A * q ** 2 + 2 * M0 ** 2 * pi + H * M0 / 2) * cos(fi) ** 4 - (c12 + c11) * (c11 - c12 - 2 * c44) * (A * q ** 2 + 2 * M0 ** 2 * pi + H * M0 / 2) * cos(fi) ** 2 - 4 * (c11 + c44 / 2) * pi * c44 * M0 ** 2 - H * (c11 + c44 / 2) * c44 * M0 - A * c44 ** 2 * q ** 2 + (-2 * A * c11 * q ** 2 + b2 ** 2 / 4) * c44 + b2 ** 2 * c11 / 4) * ro * ge * q ** 4 / M0
    p4 = 4 * (4 * M0 ** 2 * (-q ** 2 * (al ** 2 + 1) * (c12 + c11) * (c11 - c12 - 2 * c44) * cos(fi) ** 4 / 16 + q ** 2 * (al ** 2 + 1) * (c12 + c11) * (c11 - c12 - 2 * c44) * cos(fi) ** 2 / 16 + ro * ge ** 2 * pi ** 2 * (c11 + 2 * c44) * M0 ** 2 - q ** 2 * (al ** 2 + 1) * (c12 + c11) * (c11 - c12 - 2 * c44) / 16 + b2 ** 2 * ge ** 2 * pi * ro / 4) * cos(t) ** 4 + (q ** 2 * M0 ** 2 * (al ** 2 + 1) * (c12 + c11) * (c11 - c12 - 2 * c44) * cos(fi) ** 4 / 2 - q ** 2 * M0 ** 2 * (al ** 2 + 1) * (c12 + c11) * (c11 - c12 - 2 * c44) * cos(fi) ** 2 / 2 - 8 * ro * ge ** 2 * pi ** 2 * (c11 + 2 * c44) * M0 ** 4 - 2 * ro * H * ge ** 2 * pi * (c11 + 2 * c44) * M0 ** 3 - 4 * (((al ** 2 / 8 + 0.1e1 / 0.8e1) * c11 + 2 * A * ro * pi * ge ** 2 + al ** 2 * c12 / 8 + c12 / 8) * c44 + (-al ** 2 / 16 - 0.1e1 / 0.16e2) * c11 ** 2 + A * ro * pi * ge ** 2 * c11 + c12 ** 2 * (al ** 2 + 1) / 16) * q ** 2 * M0 ** 2 - H * M0 * b2 ** 2 * ge ** 2 * ro / 4 - A * b2 ** 2 * ge ** 2 * q ** 2 * ro / 2) * cos(t) ** 2 - q ** 2 * M0 ** 2 * (al ** 2 + 1) * (c12 + c11) * (c11 - c12 - 2 * c44) * cos(fi) ** 4 / 4 + q ** 2 * M0 ** 2 * (al ** 2 + 1) * (c12 + c11) * (c11 - c12 - 2 * c44) * cos(fi) ** 2 / 4 + 4 * ro * ge ** 2 * pi ** 2 * (c11 + 2 * c44) * M0 ** 4 + 2 * ro * H * ge ** 2 * pi * (c11 + 2 * c44) * M0 ** 3 + (((al ** 2 / 4 + 0.1e1 / 0.4e1) * c44 ** 2 + ((al ** 2 / 2 + 0.1e1 / 0.2e1) * c11 + 8 * A * ro * pi * ge ** 2) * c44 + 4 * A * ro * pi * ge ** 2 * c11) * q ** 2 + ro * ge ** 2 * (c11 * H ** 2 + 2 * H ** 2 * c44 - 4 * b2 ** 2 * pi) / 4) * M0 ** 2 + H * ro * ge ** 2 * (A * (c11 + 2 * c44) * q ** 2 - b2 ** 2 / 4) * M0 + ro * (A * (c11 + 2 * c44) * q ** 2 - b2 ** 2 / 2) * ge ** 2 * A * q ** 2) * ro * q ** 2 / M0 ** 2
    p5 = complex(0, -4) * ((-2 * pi * (c11 + 2 * c44) * M0 ** 2 - b2 ** 2 / 4) * cos(t) ** 2 + 2 * pi * (c11 + 2 * c44) * M0 ** 2 + H * (c11 + 2 * c44) * M0 / 2 + A * c11 * q ** 2 + 2 * A * c44 * q ** 2 - b2 ** 2 / 4) * al * ro ** 2 * ge * q ** 2 / M0
    p6 = -4 * (4 * M0 ** 4 * cos(t) ** 4 * ge ** 2 * pi ** 2 * ro - 4 * pi * M0 ** 2 * ge ** 2 * (A * q ** 2 + 2 * M0 ** 2 * pi + H * M0 / 2) * ro * cos(t) ** 2 + 4 * M0 ** 4 * ge ** 2 * pi ** 2 * ro + 2 * H * M0 ** 3 * ge ** 2 * pi * ro + (4 * (H ** 2 / 16 + A * q ** 2 * pi) * ro * ge ** 2 + q ** 2 * (al ** 2 + 1) * (c11 + 2 * c44) / 4) * M0 ** 2 + A * H * M0 * ge ** 2 * q ** 2 * ro + A ** 2 * ge ** 2 * q ** 4 * ro) * ro ** 2 / M0 ** 2
    p7 = complex(0, 2) / M0 * al * ge * ro ** 3 * (-4 * M0 ** 2 * cos(t) ** 2 * pi + 2 * A * q ** 2 + 4 * M0 ** 2 * pi + H * M0)
    p8 = ro ** 3 * (al ** 2 + 1)    

    return roots([p8, p7, p6, p5, p4, p3, p2, p1, p0])

def Spec_q(w,t,fi,x,H):
    mb,hp,g,ge,Ka,ro,a0,c11,c12,c44,M0,A,b2,al = Const(x)

    p0 = ro ** 3 * w ** 6 * (complex(0, 2) * H * al * ge * w + al ** 2 * w ** 2 - H ** 2 * ge ** 2 + w ** 2)
    p2 = 4 * ro ** 2 * (b2 ** 2 * ge * (complex(0, 1) * w * al - H * ge) * cos(t) ** 2 / 4 + complex(0, 1) * A * al * ge * ro * w ** 3 + (-A * H * ge ** 2 * ro - M0 * (al ** 2 + 1) * (c11 + 2 * c44) / 4) * w ** 2 + complex(0, -0.1e1 / 0.2e1) * (H * (c11 + 2 * c44) * M0 - b2 ** 2 / 2) * ge * al * w + H * ge ** 2 * (H * (c11 + 2 * c44) * M0 - b2 ** 2) / 4) * w ** 4 / M0
    p4 = -4 * ((((al ** 2 / 2 + 0.1e1 / 0.2e1) * w ** 2 + complex(0, 1) * H * al * ge * w - H ** 2 * ge ** 2 / 2) * (c11 - c12 - 2 * c44) * M0 * cos(fi) ** 4 - ((al ** 2 / 2 + 0.1e1 / 0.2e1) * w ** 2 + complex(0, 1) * H * al * ge * w - H ** 2 * ge ** 2 / 2) * (c11 - c12 - 2 * c44) * M0 * cos(fi) ** 2 + ((al ** 2 / 2 + 0.1e1 / 0.2e1) * w ** 2 + complex(0, 1) * H * al * ge * w - H ** 2 * ge ** 2 / 2) * (c11 - c12 - 2 * c44) * M0 + b2 ** 2 * ge * (complex(0, 1) * w * al - H * ge)) * (c11 + c12) * M0 * cos(t) ** 4 / 2 + (-((al ** 2 / 2 + 0.1e1 / 0.2e1) * w ** 2 + complex(0, 1) * H * al * ge * w - H ** 2 * ge ** 2 / 2) * (c11 - c12 - 2 * c44) * (c11 + c12) * M0 ** 2 * cos(fi) ** 4 + ((al ** 2 / 2 + 0.1e1 / 0.2e1) * w ** 2 + complex(0, 1) * H * al * ge * w - H ** 2 * ge ** 2 / 2) * (c11 - c12 - 2 * c44) * (c11 + c12) * M0 ** 2 * cos(fi) ** 2 - ((al ** 2 / 2 + 0.1e1 / 0.2e1) * w ** 2 + complex(0, 1) * H * al * ge * w - H ** 2 * ge ** 2 / 2) * (c11 - c12 - 2 * c44) * (c11 + c12) * M0 ** 2 / 2 - b2 ** 2 * ge * (complex(0, 1) * w * al - H * ge) * (c11 + 2 * c12 - c44) * M0 / 4 + b2 ** 2 * (A * w ** 2 * ro + b2 ** 2 / 2) * ge ** 2 / 2) * cos(t) ** 2 + ((al ** 2 / 2 + 0.1e1 / 0.2e1) * w ** 2 + complex(0, 1) * H * al * ge * w - H ** 2 * ge ** 2 / 2) * (c11 - c12 - 2 * c44) * (c11 + c12) * M0 ** 2 * cos(fi) ** 4 / 2 - ((al ** 2 / 2 + 0.1e1 / 0.2e1) * w ** 2 + complex(0, 1) * H * al * ge * w - H ** 2 * ge ** 2 / 2) * (c11 - c12 - 2 * c44) * (c11 + c12) * M0 ** 2 * cos(fi) ** 2 / 2 - ((al ** 2 / 2 + 0.1e1 / 0.2e1) * w ** 2 + complex(0, 1) * H * al * ge * w - H ** 2 * ge ** 2 / 2) * c44 * (c11 + c44 / 2) * M0 ** 2 + (A * ro * (c11 + 2 * c44) * w ** 2 + b2 ** 2 * (c11 + c44) / 4) * ge * (complex(0, 1) * w * al - H * ge) * M0 + A * ge ** 2 * ro * w ** 2 * (A * w ** 2 * ro + b2 ** 2 / 2)) * ro * w ** 2 / M0 ** 2
    p6 = ((2 * (c11 - c12 - 2 * c44) * ((c11 - c12 - 2 * c44) * (-H ** 2 * ge ** 2 / 2 + complex(0, 1) * H * al * ge * w + (al ** 2 + 1) * w ** 2 / 2) * (c11 + 2 * c12 + c44) * M0 ** 2 + b2 ** 2 * (c11 + 5 * c12 + 4 * c44) * ge * (complex(0, 1) * w * al - H * ge) * M0 / 2 + b2 ** 4 * ge ** 2) * cos(fi) ** 4 - 2 * (c11 - c12 - 2 * c44) * ((c11 - c12 - 2 * c44) * (-H ** 2 * ge ** 2 / 2 + complex(0, 1) * H * al * ge * w + (al ** 2 + 1) * w ** 2 / 2) * (c11 + 2 * c12 + c44) * M0 ** 2 + b2 ** 2 * (c11 + 5 * c12 + 4 * c44) * ge * (complex(0, 1) * w * al - H * ge) * M0 / 2 + b2 ** 4 * ge ** 2) * cos(fi) ** 2 - b2 ** 2 * ((c11 - c12 - 2 * c44) * (complex(0, 1) * w * al - H * ge) * M0 - 2 * b2 ** 2 * ge) * ge * (c11 + c12)) * cos(t) ** 6 + (-4 * ((-2 * c44 ** 2 + (-0.3e1 / 0.2e1 * c11 - 0.11e2 / 0.2e1 * c12) * c44 + (c11 + 2 * c12) * (c11 - c12)) * (-H ** 2 * ge ** 2 / 2 + complex(0, 1) * H * al * ge * w + (al ** 2 + 1) * w ** 2 / 2) * M0 ** 2 + (A * ro * (c11 + c12) * w ** 2 + 0.3e1 / 0.4e1 * b2 ** 2 * (c11 + 0.11e2 / 0.3e1 * c12 + 0.8e1 / 0.3e1 * c44)) * ge * (complex(0, 1) * w * al - H * ge) * M0 + b2 ** 4 * ge ** 2) * (c11 - c12 - 2 * c44) * cos(fi) ** 4 + 4 * ((-2 * c44 ** 2 + (-0.3e1 / 0.2e1 * c11 - 0.11e2 / 0.2e1 * c12) * c44 + (c11 + 2 * c12) * (c11 - c12)) * (-H ** 2 * ge ** 2 / 2 + complex(0, 1) * H * al * ge * w + (al ** 2 + 1) * w ** 2 / 2) * M0 ** 2 + (A * ro * (c11 + c12) * w ** 2 + 0.3e1 / 0.4e1 * b2 ** 2 * (c11 + 0.11e2 / 0.3e1 * c12 + 0.8e1 / 0.3e1 * c44)) * ge * (complex(0, 1) * w * al - H * ge) * M0 + b2 ** 4 * ge ** 2) * (c11 - c12 - 2 * c44) * cos(fi) ** 2 - 4 * (-(c11 - c12 - 2 * c44) * (-H ** 2 * ge ** 2 / 2 + complex(0, 1) * H * al * ge * w + (al ** 2 + 1) * w ** 2 / 2) * c44 * M0 ** 2 / 2 + (A * ro * (c11 - c12 - 2 * c44) * w ** 2 - b2 ** 2 * (c11 - c12) / 4) * ge * (complex(0, 1) * w * al - H * ge) * M0 - b2 ** 2 * ge ** 2 * (A * w ** 2 * ro - b2 ** 2 / 2)) * (c11 + c12)) * cos(t) ** 4 + (8 * (c11 - c12 - 2 * c44) * ((-H ** 2 * ge ** 2 / 2 + complex(0, 1) * H * al * ge * w + (al ** 2 + 1) * w ** 2 / 2) * (-2 * c44 ** 2 + (-3 * c11 - 7 * c12) * c44 + (c11 + 2 * c12) * (c11 - c12)) * M0 ** 2 / 4 + (A * ro * (c11 + c12) * w ** 2 + 0.3e1 / 0.8e1 * b2 ** 2 * (c11 + 0.7e1 / 0.3e1 * c12 + 0.4e1 / 0.3e1 * c44)) * ge * (complex(0, 1) * w * al - H * ge) * M0 + b2 ** 4 * ge ** 2 / 4) * cos(fi) ** 4 - 8 * (c11 - c12 - 2 * c44) * ((-H ** 2 * ge ** 2 / 2 + complex(0, 1) * H * al * ge * w + (al ** 2 + 1) * w ** 2 / 2) * (-2 * c44 ** 2 + (-3 * c11 - 7 * c12) * c44 + (c11 + 2 * c12) * (c11 - c12)) * M0 ** 2 / 4 + (A * ro * (c11 + c12) * w ** 2 + 0.3e1 / 0.8e1 * b2 ** 2 * (c11 + 0.7e1 / 0.3e1 * c12 + 0.4e1 / 0.3e1 * c44)) * ge * (complex(0, 1) * w * al - H * ge) * M0 + b2 ** 4 * ge ** 2 / 4) * cos(fi) ** 2 - 2 * (c11 - c12 - 2 * c44) * (-H ** 2 * ge ** 2 / 2 + complex(0, 1) * H * al * ge * w + (al ** 2 + 1) * w ** 2 / 2) * (c11 + c12) * c44 * M0 ** 2 + 4 * ge * (A * ro * (c11 + c12) * (c11 - c12 - 2 * c44) * w ** 2 - c44 * b2 ** 2 * (c11 + 2 * c12) / 4) * (complex(0, 1) * w * al - H * ge) * M0 - 2 * b2 ** 2 * ge ** 2 * (A * ro * (c11 + 2 * c12 - c44) * w ** 2 - c11 * b2 ** 2 / 2)) * cos(t) ** 2 - 4 * (c11 - c12 - 2 * c44) * (-(-H ** 2 * ge ** 2 / 2 + complex(0, 1) * H * al * ge * w + (al ** 2 + 1) * w ** 2 / 2) * c44 * M0 / 2 + (A * w ** 2 * ro + b2 ** 2 / 4) * ge * (complex(0, 1) * w * al - H * ge)) * (c11 + c12) * M0 * cos(fi) ** 4 + 4 * (c11 - c12 - 2 * c44) * (-(-H ** 2 * ge ** 2 / 2 + complex(0, 1) * H * al * ge * w + (al ** 2 + 1) * w ** 2 / 2) * c44 * M0 / 2 + (A * w ** 2 * ro + b2 ** 2 / 4) * ge * (complex(0, 1) * w * al - H * ge)) * (c11 + c12) * M0 * cos(fi) ** 2 - 2 * (-H ** 2 * ge ** 2 / 2 + complex(0, 1) * H * al * ge * w + (al ** 2 + 1) * w ** 2 / 2) * c44 ** 2 * c11 * M0 ** 2 + 8 * (A * ro * (c11 + c44 / 2) * w ** 2 + c11 * b2 ** 2 / 8) * ge * c44 * (complex(0, 1) * w * al - H * ge) * M0 + 4 * (A * ro * (c11 + 2 * c44) * w ** 2 + b2 ** 2 * (c11 + c44) / 2) * ro * A * ge ** 2 * w ** 2) / M0 ** 2
    p8 = 4 * A * ge * ((c11 - c12 - 2 * c44) * (cos(t) + 1) ** 2 * (((2 * c44 ** 2 * H * M0 + (H * (c11 + 5 * c12) * M0 - 2 * b2 ** 2) * c44 - H * (c11 + 2 * c12) * (c11 - c12) * M0 - b2 ** 2 * (c11 + 5 * c12) / 2) * ge + complex(0, 1) * (c11 - c12 - 2 * c44) * (c11 + 2 * c12 + c44) * w * al * M0) * cos(t) ** 2 + (c11 + c12) * ((A * w ** 2 * ro - M0 * H * c44 + b2 ** 2 / 2) * ge + complex(0, 1) * c44 * w * M0 * al)) * (cos(t) - 1) ** 2 * cos(fi) ** 4 - (c11 - c12 - 2 * c44) * (cos(t) + 1) ** 2 * (((2 * c44 ** 2 * H * M0 + (H * (c11 + 5 * c12) * M0 - 2 * b2 ** 2) * c44 - H * (c11 + 2 * c12) * (c11 - c12) * M0 - b2 ** 2 * (c11 + 5 * c12) / 2) * ge + complex(0, 1) * (c11 - c12 - 2 * c44) * (c11 + 2 * c12 + c44) * w * al * M0) * cos(t) ** 2 + (c11 + c12) * ((A * w ** 2 * ro - M0 * H * c44 + b2 ** 2 / 2) * ge + complex(0, 1) * c44 * w * M0 * al)) * (cos(t) - 1) ** 2 * cos(fi) ** 2 + b2 ** 2 * ge * (c11 + c12) * (c11 - c12 - 2 * c44) * cos(t) ** 6 / 2 + ((2 * c44 ** 2 * H * M0 + (-H * (c11 - c12) * M0 - 2 * A * w ** 2 * ro) * c44 + (c11 - c12) * (A * w ** 2 * ro - b2 ** 2 / 2)) * ge + complex(0, 1) * (c11 - c12 - 2 * c44) * w * al * M0 * c44) * (c11 + c12) * cos(t) ** 4 + ((-2 * M0 * H * (c11 + c12) * c44 ** 2 + ((H * c11 ** 2 - H * c12 ** 2) * M0 + (b2 ** 2 / 2 + 2 * A * w ** 2 * ro) * c11 + c12 * (2 * A * w ** 2 * ro + b2 ** 2)) * c44 - A * w ** 2 * ro * (c11 - c12) * (c11 + c12)) * ge + complex(0, -1) * (c11 - c12 - 2 * c44) * w * al * (c11 + c12) * M0 * c44) * cos(t) ** 2 - c44 * (((A * w ** 2 * ro - H * M0 * c11) * c44 + 2 * (A * w ** 2 * ro + b2 ** 2 / 4) * c11) * ge + complex(0, 1) * c11 * c44 * w * M0 * al)) / M0 ** 2
    p10 = -4 * ((cos(t) - 1) ** 2 * (c11 - c12 - 2 * c44) * ((c11 + 2 * c12 + c44) * (c11 - c12 - 2 * c44) * cos(t) ** 2 + c44 * (c11 + c12)) * (cos(t) + 1) ** 2 * cos(fi) ** 4 - (cos(t) - 1) ** 2 * (c11 - c12 - 2 * c44) * ((c11 + 2 * c12 + c44) * (c11 - c12 - 2 * c44) * cos(t) ** 2 + c44 * (c11 + c12)) * (cos(t) + 1) ** 2 * cos(fi) ** 2 + c44 * ((c11 + c12) * (c11 - c12 - 2 * c44) * cos(t) ** 4 - (c11 + c12) * (c11 - c12 - 2 * c44) * cos(t) ** 2 - c44 * c11)) * ge ** 2 * A ** 2 / M0 ** 2

    return roots([p10, 0, p8, 0, p6, 0, p4, 0, p2, 0, p0])

def Curvarure(w,q,t,fi,x,H):
    mb,hp,g,ge,Ka,ro,a0,c11,c12,c44,M0,A,b2,al = Const(x)

    Gq = 8*w**4*(ge*(w*al*complex(0, 1) - H*ge)*b2**2*cos(t)**2/4 + A*al*ge*ro*w**3*complex(0, 1) + (-A*H*ge**2*ro - M0*(al**2 + 1)*(c11 + 2*c44)/4)*w**2 - (H*(c11 + 2*c44)*M0 - b2**2/2)*ge*al*w*complex(0, 1)/2 + ge**2*H*(H*(c11 + 2*c44)*M0 - b2**2)/4)*ro**2*q/M0 - 16*(M0*(M0*(c11 - c12 - 2*c44)*((al**2/2 + 1/2)*w**2 + H*al*ge*w*complex(0, 1) - H**2*ge**2/2)*cos(fi)**4 - M0*(c11 - c12 - 2*c44)*((al**2/2 + 1/2)*w**2 + H*al*ge*w*complex(0, 1) - H**2*ge**2/2)*cos(fi)**2 + M0*(c11 - c12 - 2*c44)*((al**2/2 + 1/2)*w**2 + H*al*ge*w*complex(0, 1) - H**2*ge**2/2) + ge*(w*al*complex(0, 1) - H*ge)*b2**2)*(c11 + c12)*cos(t)**4/2 + (-M0**2*(c11 - c12 - 2*c44)*((al**2/2 + 1/2)*w**2 + H*al*ge*w*complex(0, 1) - H**2*ge**2/2)*(c11 + c12)*cos(fi)**4 + M0**2*(c11 - c12 - 2*c44)*((al**2/2 + 1/2)*w**2 + H*al*ge*w*complex(0, 1) - H**2*ge**2/2)*(c11 + c12)*cos(fi)**2 - M0**2*(c11 - c12 - 2*c44)*((al**2/2 + 1/2)*w**2 + H*al*ge*w*complex(0, 1) - H**2*ge**2/2)*(c11 + c12)/2 - ge*(w*al*complex(0, 1) - H*ge)*(c11 + 2*c12 - c44)*b2**2*M0/4 + ((A*w**2*ro + b2**2/2)*ge**2*b2**2)/2)*cos(t)**2 + M0**2*(c11 - c12 - 2*c44)*((al**2/2 + 1/2)*w**2 + H*al*ge*w*complex(0, 1) - H**2*ge**2/2)*(c11 + c12)*cos(fi)**4/2 - M0**2*(c11 - c12 - 2*c44)*((al**2/2 + 1/2)*w**2 + H*al*ge*w*complex(0, 1) - H**2*ge**2/2)*(c11 + c12)*cos(fi)**2/2 - (c11 + c44/2)*((al**2/2 + 1/2)*w**2 + H*al*ge*w*complex(0, 1) - H**2*ge**2/2)*c44*M0**2 + ge*(w*al*complex(0, 1) - H*ge)*(A*ro*(c11 + 2*c44)*w**2 + b2**2*(c11 + c44)/4)*M0 + A*ge**2*ro*w**2*(A*w**2*ro + b2**2/2))*w**2*ro*q**3/M0**2 + ((12*((c11 - c12 - 2*c44)*(c11 + 2*c12 + c44)*(-H**2*ge**2/2 + H*al*ge*w*complex(0, 1) + ((al**2 + 1)*w**2)/2)*M0**2 + ge*(c11 + 5*c12 + 4*c44)*(w*al*complex(0, 1) - H*ge)*b2**2*M0/2 + ge**2*b2**4)*(c11 - c12 - 2*c44)*cos(fi)**4 - 12*((c11 - c12 - 2*c44)*(c11 + 2*c12 + c44)*(-H**2*ge**2/2 + H*al*ge*w*complex(0, 1) + ((al**2 + 1)*w**2)/2)*M0**2 + ge*(c11 + 5*c12 + 4*c44)*(w*al*complex(0, 1) - H*ge)*b2**2*M0/2 + ge**2*b2**4)*(c11 - c12 - 2*c44)*cos(fi)**2 - 6*ge*((c11 - c12 - 2*c44)*(w*al*complex(0, 1) - H*ge)*M0 - 2*ge*b2**2)*b2**2*(c11 + c12))*cos(t)**6 + (-24*(c11 - c12 - 2*c44)*((-H**2*ge**2/2 + H*al*ge*w*complex(0, 1) + ((al**2 + 1)*w**2)/2)*(-2*c44**2 + (-(3*c11)/2 - (11*c12)/2)*c44 + (c11 + 2*c12)*(c11 - c12))*M0**2 + ge*(A*ro*(c11 + c12)*w**2 + 3*(c11 + (11*c12)/3 + (8*c44)/3)*b2**2/4)*(w*al*complex(0, 1) - H*ge)*M0 + ge**2*b2**4)*cos(fi)**4 + 24*(c11 - c12 - 2*c44)*((-H**2*ge**2/2 + H*al*ge*w*complex(0, 1) + ((al**2 + 1)*w**2)/2)*(-2*c44**2 + (-(3*c11)/2 - (11*c12)/2)*c44 + (c11 + 2*c12)*(c11 - c12))*M0**2 + ge*(A*ro*(c11 + c12)*w**2 + 3*(c11 + (11*c12)/3 + (8*c44)/3)*b2**2/4)*(w*al*complex(0, 1) - H*ge)*M0 + ge**2*b2**4)*cos(fi)**2 - 24*(-((c11 - c12 - 2*c44)*(-H**2*ge**2/2 + H*al*ge*w*complex(0, 1) + ((al**2 + 1)*w**2)/2)*c44*M0**2)/2 + ge*(w*al*complex(0, 1) - H*ge)*(A*ro*(c11 - c12 - 2*c44)*w**2 - b2**2*(c11 - c12)/4)*M0 - ge**2*(A*w**2*ro - b2**2/2)*b2**2)*(c11 + c12))*cos(t)**4 + (48*(c11 - c12 - 2*c44)*(((-H**2*ge**2/2 + H*al*ge*w*complex(0, 1) + ((al**2 + 1)*w**2)/2)*(-2*c44**2 + (-3*c11 - 7*c12)*c44 + (c11 + 2*c12)*(c11 - c12))*M0**2)/4 + ge*(w*al*complex(0, 1) - H*ge)*(A*ro*(c11 + c12)*w**2 + 3*(c11 + (7*c12)/3 + (4*c44)/3)*b2**2/8)*M0 + ge**2*b2**4/4)*cos(fi)**4 - 48*(c11 - c12 - 2*c44)*(((-H**2*ge**2/2 + H*al*ge*w*complex(0, 1) + ((al**2 + 1)*w**2)/2)*(-2*c44**2 + (-3*c11 - 7*c12)*c44 + (c11 + 2*c12)*(c11 - c12))*M0**2)/4 + ge*(w*al*complex(0, 1) - H*ge)*(A*ro*(c11 + c12)*w**2 + 3*(c11 + (7*c12)/3 + (4*c44)/3)*b2**2/8)*M0 + ge**2*b2**4/4)*cos(fi)**2 - 12*(c11 - c12 - 2*c44)*(-H**2*ge**2/2 + H*al*ge*w*complex(0, 1) + ((al**2 + 1)*w**2)/2)*c44*(c11 + c12)*M0**2 + 24*ge*(A*ro*(c11 + c12)*(c11 - c12 - 2*c44)*w**2 - c44*b2**2*(c11 + 2*c12)/4)*(w*al*complex(0, 1) - H*ge)*M0 - 12*(A*ro*(c11 + 2*c12 - c44)*w**2 - b2**2*c11/2)*ge**2*b2**2)*cos(t)**2 - 24*M0*(c11 - c12 - 2*c44)*(-((-H**2*ge**2/2 + H*al*ge*w*complex(0, 1) + ((al**2 + 1)*w**2)/2)*c44*M0)/2 + ge*(A*w**2*ro + b2**2/4)*(w*al*complex(0, 1) - H*ge))*(c11 + c12)*cos(fi)**4 + 24*M0*(c11 - c12 - 2*c44)*(-((-H**2*ge**2/2 + H*al*ge*w*complex(0, 1) + ((al**2 + 1)*w**2)/2)*c44*M0)/2 + ge*(A*w**2*ro + b2**2/4)*(w*al*complex(0, 1) - H*ge))*(c11 + c12)*cos(fi)**2 - 12*(-H**2*ge**2/2 + H*al*ge*w*complex(0, 1) + ((al**2 + 1)*w**2)/2)*c11*c44**2*M0**2 + 48*ge*c44*(w*al*complex(0, 1) - H*ge)*(A*ro*(c11 + c44/2)*w**2 + b2**2*c11/8)*M0 + 24*ge**2*w**2*A*ro*(A*ro*(c11 + 2*c44)*w**2 + b2**2*(c11 + c44)/2))*q**5/M0**2 + 32*ge*A*((((2*c44**2*H*M0 + (H*(c11 + 5*c12)*M0 - 2*b2**2)*c44 - H*(c11 + 2*c12)*(c11 - c12)*M0 - b2**2*(c11 + 5*c12)/2)*ge + M0*(c11 - c12 - 2*c44)*w*(c11 + 2*c12 + c44)*al*complex(0, 1))*cos(t)**2 + (c11 + c12)*((A*w**2*ro - c44*H*M0 + b2**2/2)*ge + c44*w*M0*al*complex(0, 1)))*(c11 - c12 - 2*c44)*(cos(t) + 1)**2*(cos(t) - 1)**2*cos(fi)**4 - (((2*c44**2*H*M0 + (H*(c11 + 5*c12)*M0 - 2*b2**2)*c44 - H*(c11 + 2*c12)*(c11 - c12)*M0 - b2**2*(c11 + 5*c12)/2)*ge + M0*(c11 - c12 - 2*c44)*w*(c11 + 2*c12 + c44)*al*complex(0, 1))*cos(t)**2 + (c11 + c12)*((A*w**2*ro - c44*H*M0 + b2**2/2)*ge + c44*w*M0*al*complex(0, 1)))*(c11 - c12 - 2*c44)*(cos(t) + 1)**2*(cos(t) - 1)**2*cos(fi)**2 + b2**2*ge*(c11 + c12)*(c11 - c12 - 2*c44)*cos(t)**6/2 + ((2*c44**2*H*M0 + (-H*(c11 - c12)*M0 - 2*A*w**2*ro)*c44 + (c11 - c12)*(A*w**2*ro - b2**2/2))*ge + M0*(c11 - c12 - 2*c44)*w*c44*al*complex(0, 1))*(c11 + c12)*cos(t)**4 + ((-2*H*M0*(c11 + c12)*c44**2 + ((H*c11**2 - H*c12**2)*M0 + (b2**2/2 + 2*A*w**2*ro)*c11 + c12*(2*A*ro*w**2 + b2**2))*c44 - A*w**2*ro*(c11 - c12)*(c11 + c12))*ge - M0*(c11 - c12 - 2*c44)*w*c44*al*(c11 + c12)*complex(0, 1))*cos(t)**2 - c44*(((A*ro*w**2 - H*M0*c11)*c44 + 2*c11*(A*w**2*ro + b2**2/4))*ge + c11*c44*w*M0*al*complex(0, 1)))*q**7/M0**2 - 40*A**2*((c11 - c12 - 2*c44)*(cos(t) + 1)**2*((c11 + 2*c12 + c44)*(c11 - c12 - 2*c44)*cos(t)**2 + c44*(c11 + c12))*(cos(t) - 1)**2*cos(fi)**4 - (c11 - c12 - 2*c44)*(cos(t) + 1)**2*((c11 + 2*c12 + c44)*(c11 - c12 - 2*c44)*cos(t)**2 + c44*(c11 + c12))*(cos(t) - 1)**2*cos(fi)**2 + ((c11 + c12)*(c11 - c12 - 2*c44)*cos(t)**4 - (c11 + c12)*(c11 - c12 - 2*c44)*cos(t)**2 - c11*c44)*c44)*ge**2*q**9/M0**2
    Gt = 2*w**4*ge*(-w*al*complex(0, 1) + H*ge)*b2**2*cos(t)*sin(t)*ro**2*q**2/M0 + 8*w**2*sin(t)*ro*cos(t)*(M0**2*((al**2/2 + 1/2)*w**2 + H*al*ge*w*complex(0, 1) - H**2*ge**2/2)*(c11 - c12 - 2*c44)*(cos(t) + 1)*(cos(t) - 1)*(c11 + c12)*cos(fi)**4 - M0**2*((al**2/2 + 1/2)*w**2 + H*al*ge*w*complex(0, 1) - H**2*ge**2/2)*(c11 - c12 - 2*c44)*(cos(t) + 1)*(cos(t) - 1)*(c11 + c12)*cos(fi)**2 + M0*(M0*(c11 - c12 - 2*c44)*((al**2/2 + 1/2)*w**2 + H*al*ge*w*complex(0, 1) - H**2*ge**2/2) + ge*(w*al*complex(0, 1) - H*ge)*b2**2)*(c11 + c12)*cos(t)**2 - M0**2*(c11 - c12 - 2*c44)*((al**2/2 + 1/2)*w**2 + H*al*ge*w*complex(0, 1) - H**2*ge**2/2)*(c11 + c12)/2 - ge*(w*al*complex(0, 1) - H*ge)*(c11 + 2*c12 - c44)*b2**2*M0/4 + ((A*w**2*ro + b2**2/2)*ge**2*b2**2)/2)*q**4/M0**2 + 16*((c11 - c12 - 2*c44)*(cos(t) + 1)*(cos(t) - 1)*((-3*(c11 - c12 - 2*c44)*(c11 + 2*c12 + c44)*(-H**2*ge**2/2 + H*al*ge*w*complex(0, 1) + ((al**2 + 1)*w**2)/2)*M0**2/4 - (3*ge*(c11 + 5*c12 + 4*c44)*(w*al*complex(0, 1) - H*ge)*b2**2*M0)/8 - (3*ge**2*b2**4)/4)*cos(t)**2 + ((-H**2*ge**2/2 + H*al*ge*w*complex(0, 1) + ((al**2 + 1)*w**2)/2)*(-2*c44**2 + (-3*c11 - 7*c12)*c44 + (c11 + 2*c12)*(c11 - c12))*M0**2)/4 + ge*(w*al*complex(0, 1) - H*ge)*(A*ro*(c11 + c12)*w**2 + 3*(c11 + (7*c12)/3 + (4*c44)/3)*b2**2/8)*M0 + ge**2*b2**4/4)*cos(fi)**4 - (c11 - c12 - 2*c44)*(cos(t) + 1)*(cos(t) - 1)*((-3*(c11 - c12 - 2*c44)*(c11 + 2*c12 + c44)*(-H**2*ge**2/2 + H*al*ge*w*complex(0, 1) + ((al**2 + 1)*w**2)/2)*M0**2/4 - (3*ge*(c11 + 5*c12 + 4*c44)*(w*al*complex(0, 1) - H*ge)*b2**2*M0)/8 - (3*ge**2*b2**4)/4)*cos(t)**2 + ((-H**2*ge**2/2 + H*al*ge*w*complex(0, 1) + ((al**2 + 1)*w**2)/2)*(-2*c44**2 + (-3*c11 - 7*c12)*c44 + (c11 + 2*c12)*(c11 - c12))*M0**2)/4 + ge*(w*al*complex(0, 1) - H*ge)*(A*ro*(c11 + c12)*w**2 + 3*(c11 + (7*c12)/3 + (4*c44)/3)*b2**2/8)*M0 + ge**2*b2**4/4)*cos(fi)**2 + (3*ge*((c11 - c12 - 2*c44)*(w*al*complex(0, 1) - H*ge)*M0 - 2*ge*b2**2)*b2**2*(c11 + c12)*cos(t)**4)/8 + (-((c11 - c12 - 2*c44)*(-H**2*ge**2/2 + H*al*ge*w*complex(0, 1) + ((al**2 + 1)*w**2)/2)*c44*M0**2)/2 + ge*(w*al*complex(0, 1) - H*ge)*(A*ro*(c11 - c12 - 2*c44)*w**2 - b2**2*(c11 - c12)/4)*M0 - ge**2*(A*w**2*ro - b2**2/2)*b2**2)*(c11 + c12)*cos(t)**2 + ((c11 - c12 - 2*c44)*(-H**2*ge**2/2 + H*al*ge*w*complex(0, 1) + ((al**2 + 1)*w**2)/2)*c44*(c11 + c12)*M0**2)/4 - ge*(A*ro*(c11 + c12)*(c11 - c12 - 2*c44)*w**2 - c44*b2**2*(c11 + 2*c12)/4)*(w*al*complex(0, 1) - H*ge)*M0/2 + ((A*ro*(c11 + 2*c12 - c44)*w**2 - b2**2*c11/2)*ge**2*b2**2)/4)*sin(t)*cos(t)*q**6/M0**2 - 24*ge*A*sin(t)*cos(t)*((c11 - c12 - 2*c44)*(cos(t) + 1)*(((-H*(c11 + 2*c12 + c44)*(c11 - c12 - 2*c44)*M0 - b2**2*(c11 + 5*c12 + 4*c44)/2)*ge + M0*(c11 - c12 - 2*c44)*w*(c11 + 2*c12 + c44)*al*complex(0, 1))*cos(t)**2 + (((-2*c44**2 + (-3*c11 - 7*c12)*c44 + (c11 + 2*c12)*(c11 - c12))*H*M0)/3 + (2*b2**2*c44)/3 + ((7*b2**2)/6 + (2*A*w**2*ro)/3)*c12 + (2*c11*(A*w**2*ro + (3*b2**2)/4))/3)*ge - M0*w*(-2*c44**2 + (-3*c11 - 7*c12)*c44 + (c11 + 2*c12)*(c11 - c12))*al*complex(0, 1)/3)*(cos(t) - 1)*cos(fi)**4 - (c11 - c12 - 2*c44)*(cos(t) + 1)*(((-H*(c11 + 2*c12 + c44)*(c11 - c12 - 2*c44)*M0 - b2**2*(c11 + 5*c12 + 4*c44)/2)*ge + M0*(c11 - c12 - 2*c44)*w*(c11 + 2*c12 + c44)*al*complex(0, 1))*cos(t)**2 + (((-2*c44**2 + (-3*c11 - 7*c12)*c44 + (c11 + 2*c12)*(c11 - c12))*H*M0)/3 + (2*b2**2*c44)/3 + ((7*b2**2)/6 + (2*A*w**2*ro)/3)*c12 + (2*c11*(A*w**2*ro + (3*b2**2)/4))/3)*ge - M0*w*(-2*c44**2 + (-3*c11 - 7*c12)*c44 + (c11 + 2*c12)*(c11 - c12))*al*complex(0, 1)/3)*(cos(t) - 1)*cos(fi)**2 + b2**2*ge*(c11 + c12)*(c11 - c12 - 2*c44)*cos(t)**4/2 + 2*((-H*c44*(c11 - c12 - 2*c44)*M0 - 2*A*w**2*ro*c44 + (c11 - c12)*(A*w**2*ro - b2**2/2))*ge + M0*(c11 - c12 - 2*c44)*w*c44*al*complex(0, 1))*(c11 + c12)*cos(t)**2/3 + (H*c44*(c11 + c12)*(c11 - c12 - 2*c44)*M0/3 + (((2*A*w**2*ro)/3 + b2**2/3)*c12 + (2*c11*(A*w**2*ro + b2**2/4))/3)*c44 - A*w**2*ro*(c11 - c12)*(c11 + c12)/3)*ge - M0*(c11 - c12 - 2*c44)*w*c44*al*(c11 + c12)*complex(0, 1)/3)*q**8/M0**2 + 24*(c11 - c12 - 2*c44)*sin(t)*A**2*cos(t)*ge**2*(((c11 + 2*c12 + c44)*(c11 - c12 - 2*c44)*cos(t)**2 + (2*c44**2)/3 + (c11 + (7*c12)/3)*c44 - ((c11 + 2*c12)*(c11 - c12))/3)*(cos(t) + 1)*(cos(t) - 1)*cos(fi)**4 - ((c11 + 2*c12 + c44)*(c11 - c12 - 2*c44)*cos(t)**2 + (2*c44**2)/3 + (c11 + (7*c12)/3)*c44 - ((c11 + 2*c12)*(c11 - c12))/3)*(cos(t) + 1)*(cos(t) - 1)*cos(fi)**2 + 2*(c11 + c12)*(cos(t)**2 - 1/2)*c44/3)*q**10/M0**2
    Gf = 8*sin(fi)*cos(fi)*(c11 - c12 - 2*c44)*ro*((al**2/2 + 1/2)*w**2 + H*al*ge*w*complex(0, 1) - H**2*ge**2/2)*w**2*(c11 + c12)*(cos(t) + 1)**2*(cos(t) - 1)**2*(cos(fi)**2 - 1/2)*q**4 + 16*(cos(fi)**2 - 1/2)*(c11 - c12 - 2*c44)*(cos(t) + 1)**2*cos(fi)*((-((c11 - c12 - 2*c44)*(c11 + 2*c12 + c44)*((al**2/2 + 1/2)*w**2 + H*al*ge*w*complex(0, 1) - H**2*ge**2/2)*M0**2)/2 - ge*(c11 + 5*c12 + 4*c44)*(w*al*complex(0, 1) - H*ge)*b2**2*M0/4 - ge**2*b2**4/2)*cos(t)**2 + M0*(-c44*((al**2/2 + 1/2)*w**2 + H*al*ge*w*complex(0, 1) - H**2*ge**2/2)*M0/2 + ge*(A*w**2*ro + b2**2/4)*(w*al*complex(0, 1) - H*ge))*(c11 + c12))*(cos(t) - 1)**2*sin(fi)*q**6/M0**2 - 16*(cos(fi)**2 - 1/2)*(((c11 - c12 - 2*c44)*(c11 + 2*c12 + c44)*(w*al*complex(0, 1) - H*ge)*M0 - b2**2*ge*(c11 + 5*c12 + 4*c44)/2)*cos(t)**2 + (c44*(w*al*complex(0, 1) - H*ge)*M0 + ge*(A*w**2*ro + b2**2/2))*(c11 + c12))*(c11 - c12 - 2*c44)*ge*A*(cos(t) + 1)**2*cos(fi)*(cos(t) - 1)**2*sin(fi)*q**8/M0**2 + 16*(c11 - c12 - 2*c44)*(cos(fi)**2 - 1/2)*cos(fi)*A**2*(cos(t) + 1)**2*ge**2*sin(fi)*((c11 + 2*c12 + c44)*(c11 - c12 - 2*c44)*cos(t)**2 + c44*(c11 + c12))*(cos(t) - 1)**2*q**10/M0**2

    qt = -Gt/Gq
    qf = -Gf/Gq

    Gqq = 8*w**4*(ge*(w*al*complex(0, 1) - H*ge)*b2**2*cos(t)**2/4 + A*al*ge*ro*w**3*complex(0, 1) + (-A*H*ge**2*ro - M0*(al**2 + 1)*(c11 + 2*c44)/4)*w**2 - (H*(c11 + 2*c44)*M0 - b2**2/2)*ge*al*w*complex(0, 1)/2 + ge**2*H*(H*(c11 + 2*c44)*M0 - b2**2)/4)*ro**2/M0 - 48*(M0*(M0*(c11 - c12 - 2*c44)*((al**2/2 + 1/2)*w**2 + H*al*ge*w*complex(0, 1) - H**2*ge**2/2)*cos(fi)**4 - M0*(c11 - c12 - 2*c44)*((al**2/2 + 1/2)*w**2 + H*al*ge*w*complex(0, 1) - H**2*ge**2/2)*cos(fi)**2 + M0*(c11 - c12 - 2*c44)*((al**2/2 + 1/2)*w**2 + H*al*ge*w*complex(0, 1) - H**2*ge**2/2) + ge*(w*al*complex(0, 1) - H*ge)*b2**2)*(c11 + c12)*cos(t)**4/2 + (-M0**2*(c11 - c12 - 2*c44)*((al**2/2 + 1/2)*w**2 + H*al*ge*w*complex(0, 1) - H**2*ge**2/2)*(c11 + c12)*cos(fi)**4 + M0**2*(c11 - c12 - 2*c44)*((al**2/2 + 1/2)*w**2 + H*al*ge*w*complex(0, 1) - H**2*ge**2/2)*(c11 + c12)*cos(fi)**2 - M0**2*(c11 - c12 - 2*c44)*((al**2/2 + 1/2)*w**2 + H*al*ge*w*complex(0, 1) - H**2*ge**2/2)*(c11 + c12)/2 - ge*(w*al*complex(0, 1) - H*ge)*(c11 + 2*c12 - c44)*b2**2*M0/4 + ((A*w**2*ro + b2**2/2)*ge**2*b2**2)/2)*cos(t)**2 + M0**2*(c11 - c12 - 2*c44)*((al**2/2 + 1/2)*w**2 + H*al*ge*w*complex(0, 1) - H**2*ge**2/2)*(c11 + c12)*cos(fi)**4/2 - M0**2*(c11 - c12 - 2*c44)*((al**2/2 + 1/2)*w**2 + H*al*ge*w*complex(0, 1) - H**2*ge**2/2)*(c11 + c12)*cos(fi)**2/2 - (c11 + c44/2)*((al**2/2 + 1/2)*w**2 + H*al*ge*w*complex(0, 1) - H**2*ge**2/2)*c44*M0**2 + ge*(w*al*complex(0, 1) - H*ge)*(A*ro*(c11 + 2*c44)*w**2 + b2**2*(c11 + c44)/4)*M0 + A*ge**2*ro*w**2*(A*w**2*ro + b2**2/2))*w**2*ro*q**2/M0**2 + ((60*((c11 - c12 - 2*c44)*(c11 + 2*c12 + c44)*(-H**2*ge**2/2 + H*al*ge*w*complex(0, 1) + ((al**2 + 1)*w**2)/2)*M0**2 + ge*(c11 + 5*c12 + 4*c44)*(w*al*complex(0, 1) - H*ge)*b2**2*M0/2 + ge**2*b2**4)*(c11 - c12 - 2*c44)*cos(fi)**4 - 60*((c11 - c12 - 2*c44)*(c11 + 2*c12 + c44)*(-H**2*ge**2/2 + H*al*ge*w*complex(0, 1) + ((al**2 + 1)*w**2)/2)*M0**2 + ge*(c11 + 5*c12 + 4*c44)*(w*al*complex(0, 1) - H*ge)*b2**2*M0/2 + ge**2*b2**4)*(c11 - c12 - 2*c44)*cos(fi)**2 - 30*ge*((c11 - c12 - 2*c44)*(w*al*complex(0, 1) - H*ge)*M0 - 2*ge*b2**2)*b2**2*(c11 + c12))*cos(t)**6 + (-120*(c11 - c12 - 2*c44)*((-H**2*ge**2/2 + H*al*ge*w*complex(0, 1) + ((al**2 + 1)*w**2)/2)*(-2*c44**2 + (-(3*c11)/2 - (11*c12)/2)*c44 + (c11 + 2*c12)*(c11 - c12))*M0**2 + ge*(A*ro*(c11 + c12)*w**2 + 3*(c11 + (11*c12)/3 + (8*c44)/3)*b2**2/4)*(w*al*complex(0, 1) - H*ge)*M0 + ge**2*b2**4)*cos(fi)**4 + 120*(c11 - c12 - 2*c44)*((-H**2*ge**2/2 + H*al*ge*w*complex(0, 1) + ((al**2 + 1)*w**2)/2)*(-2*c44**2 + (-(3*c11)/2 - (11*c12)/2)*c44 + (c11 + 2*c12)*(c11 - c12))*M0**2 + ge*(A*ro*(c11 + c12)*w**2 + 3*(c11 + (11*c12)/3 + (8*c44)/3)*b2**2/4)*(w*al*complex(0, 1) - H*ge)*M0 + ge**2*b2**4)*cos(fi)**2 - 120*(-((c11 - c12 - 2*c44)*(-H**2*ge**2/2 + H*al*ge*w*complex(0, 1) + ((al**2 + 1)*w**2)/2)*c44*M0**2)/2 + ge*(w*al*complex(0, 1) - H*ge)*(A*ro*(c11 - c12 - 2*c44)*w**2 - b2**2*(c11 - c12)/4)*M0 - ge**2*(A*w**2*ro - b2**2/2)*b2**2)*(c11 + c12))*cos(t)**4 + (240*(c11 - c12 - 2*c44)*(((-H**2*ge**2/2 + H*al*ge*w*complex(0, 1) + ((al**2 + 1)*w**2)/2)*(-2*c44**2 + (-3*c11 - 7*c12)*c44 + (c11 + 2*c12)*(c11 - c12))*M0**2)/4 + ge*(w*al*complex(0, 1) - H*ge)*(A*ro*(c11 + c12)*w**2 + 3*(c11 + (7*c12)/3 + (4*c44)/3)*b2**2/8)*M0 + ge**2*b2**4/4)*cos(fi)**4 - 240*(c11 - c12 - 2*c44)*(((-H**2*ge**2/2 + H*al*ge*w*complex(0, 1) + ((al**2 + 1)*w**2)/2)*(-2*c44**2 + (-3*c11 - 7*c12)*c44 + (c11 + 2*c12)*(c11 - c12))*M0**2)/4 + ge*(w*al*complex(0, 1) - H*ge)*(A*ro*(c11 + c12)*w**2 + 3*(c11 + (7*c12)/3 + (4*c44)/3)*b2**2/8)*M0 + ge**2*b2**4/4)*cos(fi)**2 - 60*(c11 - c12 - 2*c44)*(-H**2*ge**2/2 + H*al*ge*w*complex(0, 1) + ((al**2 + 1)*w**2)/2)*c44*(c11 + c12)*M0**2 + 120*ge*(A*ro*(c11 + c12)*(c11 - c12 - 2*c44)*w**2 - c44*b2**2*(c11 + 2*c12)/4)*(w*al*complex(0, 1) - H*ge)*M0 - 60*(A*ro*(c11 + 2*c12 - c44)*w**2 - b2**2*c11/2)*ge**2*b2**2)*cos(t)**2 - 120*M0*(c11 - c12 - 2*c44)*(-((-H**2*ge**2/2 + H*al*ge*w*complex(0, 1) + ((al**2 + 1)*w**2)/2)*c44*M0)/2 + ge*(A*w**2*ro + b2**2/4)*(w*al*complex(0, 1) - H*ge))*(c11 + c12)*cos(fi)**4 + 120*M0*(c11 - c12 - 2*c44)*(-((-H**2*ge**2/2 + H*al*ge*w*complex(0, 1) + ((al**2 + 1)*w**2)/2)*c44*M0)/2 + ge*(A*w**2*ro + b2**2/4)*(w*al*complex(0, 1) - H*ge))*(c11 + c12)*cos(fi)**2 - 60*(-H**2*ge**2/2 + H*al*ge*w*complex(0, 1) + ((al**2 + 1)*w**2)/2)*c11*c44**2*M0**2 + 240*ge*c44*(w*al*complex(0, 1) - H*ge)*(A*ro*(c11 + c44/2)*w**2 + b2**2*c11/8)*M0 + 120*ge**2*w**2*A*ro*(A*ro*(c11 + 2*c44)*w**2 + b2**2*(c11 + c44)/2))*q**4/M0**2 + 224*ge*A*((((2*c44**2*H*M0 + (H*(c11 + 5*c12)*M0 - 2*b2**2)*c44 - H*(c11 + 2*c12)*(c11 - c12)*M0 - b2**2*(c11 + 5*c12)/2)*ge + M0*(c11 - c12 - 2*c44)*w*(c11 + 2*c12 + c44)*al*complex(0, 1))*cos(t)**2 + (c11 + c12)*((A*w**2*ro - c44*H*M0 + b2**2/2)*ge + c44*w*M0*al*complex(0, 1)))*(c11 - c12 - 2*c44)*(cos(t) + 1)**2*(cos(t) - 1)**2*cos(fi)**4 - (((2*c44**2*H*M0 + (H*(c11 + 5*c12)*M0 - 2*b2**2)*c44 - H*(c11 + 2*c12)*(c11 - c12)*M0 - b2**2*(c11 + 5*c12)/2)*ge + M0*(c11 - c12 - 2*c44)*w*(c11 + 2*c12 + c44)*al*complex(0, 1))*cos(t)**2 + (c11 + c12)*((A*w**2*ro - c44*H*M0 + b2**2/2)*ge + c44*w*M0*al*complex(0, 1)))*(c11 - c12 - 2*c44)*(cos(t) + 1)**2*(cos(t) - 1)**2*cos(fi)**2 + b2**2*ge*(c11 + c12)*(c11 - c12 - 2*c44)*cos(t)**6/2 + ((2*c44**2*H*M0 + (-H*(c11 - c12)*M0 - 2*A*w**2*ro)*c44 + (c11 - c12)*(A*w**2*ro - b2**2/2))*ge + M0*(c11 - c12 - 2*c44)*w*c44*al*complex(0, 1))*(c11 + c12)*cos(t)**4 + ((-2*H*M0*(c11 + c12)*c44**2 + ((H*c11**2 - H*c12**2)*M0 + (b2**2/2 + 2*A*w**2*ro)*c11 + c12*(2*A*ro*w**2 + b2**2))*c44 - A*w**2*ro*(c11 - c12)*(c11 + c12))*ge - M0*(c11 - c12 - 2*c44)*w*c44*al*(c11 + c12)*complex(0, 1))*cos(t)**2 - c44*(((A*ro*w**2 - H*M0*c11)*c44 + 2*c11*(A*w**2*ro + b2**2/4))*ge + c11*c44*w*M0*al*complex(0, 1)))*q**6/M0**2 - 360*A**2*((c11 - c12 - 2*c44)*(cos(t) + 1)**2*((c11 + 2*c12 + c44)*(c11 - c12 - 2*c44)*cos(t)**2 + c44*(c11 + c12))*(cos(t) - 1)**2*cos(fi)**4 - (c11 - c12 - 2*c44)*(cos(t) + 1)**2*((c11 + 2*c12 + c44)*(c11 - c12 - 2*c44)*cos(t)**2 + c44*(c11 + c12))*(cos(t) - 1)**2*cos(fi)**2 + ((c11 + c12)*(c11 - c12 - 2*c44)*cos(t)**4 - (c11 + c12)*(c11 - c12 - 2*c44)*cos(t)**2 - c11*c44)*c44)*ge**2*q**8/M0**2
    Gtt = -4*ro**2*(cos(t)**2 - 1/2)*(w*al*complex(0, 1) - H*ge)*b2**2*w**4*ge*q**2/M0 + 32*w**2*ro*(M0*(M0*(c11 - c12 - 2*c44)*((al**2/2 + 1/2)*w**2 + H*al*ge*w*complex(0, 1) - H**2*ge**2/2)*cos(fi)**4 - M0*(c11 - c12 - 2*c44)*((al**2/2 + 1/2)*w**2 + H*al*ge*w*complex(0, 1) - H**2*ge**2/2)*cos(fi)**2 + M0*(c11 - c12 - 2*c44)*((al**2/2 + 1/2)*w**2 + H*al*ge*w*complex(0, 1) - H**2*ge**2/2) + ge*(w*al*complex(0, 1) - H*ge)*b2**2)*(c11 + c12)*cos(t)**4 + (-(5*M0**2*(c11 - c12 - 2*c44)*((al**2/2 + 1/2)*w**2 + H*al*ge*w*complex(0, 1) - H**2*ge**2/2)*(c11 + c12)*cos(fi)**4)/4 + (5*M0**2*(c11 - c12 - 2*c44)*((al**2/2 + 1/2)*w**2 + H*al*ge*w*complex(0, 1) - H**2*ge**2/2)*(c11 + c12)*cos(fi)**2)/4 - M0**2*(c11 - c12 - 2*c44)*((al**2/2 + 1/2)*w**2 + H*al*ge*w*complex(0, 1) - H**2*ge**2/2)*(c11 + c12) - (7*ge*(c11 + (8*c12)/7 - c44/7)*(w*al*complex(0, 1) - H*ge)*b2**2*M0)/8 + ((A*w**2*ro + b2**2/2)*ge**2*b2**2)/4)*cos(t)**2 + M0**2*(c11 - c12 - 2*c44)*((al**2/2 + 1/2)*w**2 + H*al*ge*w*complex(0, 1) - H**2*ge**2/2)*(c11 + c12)*cos(fi)**4/4 - M0**2*(c11 - c12 - 2*c44)*((al**2/2 + 1/2)*w**2 + H*al*ge*w*complex(0, 1) - H**2*ge**2/2)*(c11 + c12)*cos(fi)**2/4 + M0**2*(c11 - c12 - 2*c44)*((al**2/2 + 1/2)*w**2 + H*al*ge*w*complex(0, 1) - H**2*ge**2/2)*(c11 + c12)/8 + ge*(w*al*complex(0, 1) - H*ge)*(c11 + 2*c12 - c44)*b2**2*M0/16 - ((A*w**2*ro + b2**2/2)*ge**2*b2**2)/8)*q**4/M0**2 + (64*(c11 - c12 - 2*c44)*(cos(t) + 1)*(cos(t) - 1)*((-9*(c11 - c12 - 2*c44)*(c11 + 2*c12 + c44)*(-H**2*ge**2/2 + H*al*ge*w*complex(0, 1) + ((al**2 + 1)*w**2)/2)*M0**2/8 - (9*ge*(c11 + 5*c12 + 4*c44)*(w*al*complex(0, 1) - H*ge)*b2**2*M0)/16 - (9*ge**2*b2**4)/8)*cos(t)**4 + (13*(-H**2*ge**2/2 + H*al*ge*w*complex(0, 1) + ((al**2 + 1)*w**2)/2)*(-2*c44**2 + (-(21*c11)/13 - (73*c12)/13)*c44 + (c11 + 2*c12)*(c11 - c12))*M0**2/16 + ge*(A*ro*(c11 + c12)*w**2 + 21*(c11 + (73*c12)/21 + (52*c44)/21)*b2**2/32)*(w*al*complex(0, 1) - H*ge)*M0 + (13*ge**2*b2**4)/16)*cos(t)**2 - ((-H**2*ge**2/2 + H*al*ge*w*complex(0, 1) + ((al**2 + 1)*w**2)/2)*(-2*c44**2 + (-3*c11 - 7*c12)*c44 + (c11 + 2*c12)*(c11 - c12))*M0**2)/16 - ge*(w*al*complex(0, 1) - H*ge)*(A*ro*(c11 + c12)*w**2 + 3*(c11 + (7*c12)/3 + (4*c44)/3)*b2**2/8)*M0/4 - ge**2*b2**4/16)*cos(fi)**4 - 64*(c11 - c12 - 2*c44)*(cos(t) + 1)*(cos(t) - 1)*((-9*(c11 - c12 - 2*c44)*(c11 + 2*c12 + c44)*(-H**2*ge**2/2 + H*al*ge*w*complex(0, 1) + ((al**2 + 1)*w**2)/2)*M0**2/8 - (9*ge*(c11 + 5*c12 + 4*c44)*(w*al*complex(0, 1) - H*ge)*b2**2*M0)/16 - (9*ge**2*b2**4)/8)*cos(t)**4 + (13*(-H**2*ge**2/2 + H*al*ge*w*complex(0, 1) + ((al**2 + 1)*w**2)/2)*(-2*c44**2 + (-(21*c11)/13 - (73*c12)/13)*c44 + (c11 + 2*c12)*(c11 - c12))*M0**2/16 + ge*(A*ro*(c11 + c12)*w**2 + 21*(c11 + (73*c12)/21 + (52*c44)/21)*b2**2/32)*(w*al*complex(0, 1) - H*ge)*M0 + (13*ge**2*b2**4)/16)*cos(t)**2 - ((-H**2*ge**2/2 + H*al*ge*w*complex(0, 1) + ((al**2 + 1)*w**2)/2)*(-2*c44**2 + (-3*c11 - 7*c12)*c44 + (c11 + 2*c12)*(c11 - c12))*M0**2)/16 - ge*(w*al*complex(0, 1) - H*ge)*(A*ro*(c11 + c12)*w**2 + 3*(c11 + (7*c12)/3 + (4*c44)/3)*b2**2/8)*M0/4 - ge**2*b2**4/16)*cos(fi)**2 + 36*ge*((c11 - c12 - 2*c44)*(w*al*complex(0, 1) - H*ge)*M0 - 2*ge*b2**2)*b2**2*(c11 + c12)*cos(t)**6 + 64*(-((c11 - c12 - 2*c44)*(-H**2*ge**2/2 + H*al*ge*w*complex(0, 1) + ((al**2 + 1)*w**2)/2)*c44*M0**2)/2 + ge*(A*ro*(c11 - c12 - 2*c44)*w**2 - 23*(c11 - c12 - (30*c44)/23)*b2**2/32)*(w*al*complex(0, 1) - H*ge)*M0 - ge**2*(A*w**2*ro - (23*b2**2)/16)*b2**2)*(c11 + c12)*cos(t)**4 + (32*(c11 - c12 - 2*c44)*(-H**2*ge**2/2 + H*al*ge*w*complex(0, 1) + ((al**2 + 1)*w**2)/2)*c44*(c11 + c12)*M0**2 - 64*ge*(A*ro*(c11 + c12)*(c11 - c12 - 2*c44)*w**2 - 3*((c11/3 + (2*c12)/3)*c44 + c11**2 - c12**2)*b2**2/16)*(w*al*complex(0, 1) - H*ge)*M0 + 56*ge**2*(A*ro*(c11 + (8*c12)/7 - c44/7)*w**2 - ((c11 + (6*c12)/7)*b2**2)/2)*b2**2)*cos(t)**2 - 4*(c11 - c12 - 2*c44)*(-H**2*ge**2/2 + H*al*ge*w*complex(0, 1) + ((al**2 + 1)*w**2)/2)*c44*(c11 + c12)*M0**2 + 8*ge*(A*ro*(c11 + c12)*(c11 - c12 - 2*c44)*w**2 - c44*b2**2*(c11 + 2*c12)/4)*(w*al*complex(0, 1) - H*ge)*M0 - 4*(A*ro*(c11 + 2*c12 - c44)*w**2 - b2**2*c11/2)*ge**2*b2**2)*q**6/M0**2 - 144*((c11 - c12 - 2*c44)*(cos(t) + 1)*(((2*c44**2*H*M0 + (H*(c11 + 5*c12)*M0 - 2*b2**2)*c44 - H*(c11 + 2*c12)*(c11 - c12)*M0 - b2**2*(c11 + 5*c12)/2)*ge + M0*(c11 - c12 - 2*c44)*w*(c11 + 2*c12 + c44)*al*complex(0, 1))*cos(t)**4 + ((-(13*c44**2*H*M0)/9 + (-(7*H*(c11 + (73*c12)/21)*M0)/6 + (13*b2**2)/9)*c44 + (13*H*(c11 + 2*c12)*(c11 - c12)*M0)/18 + ((4*A*w**2*ro)/9 + (73*b2**2)/36)*c12 + 4*(A*w**2*ro + (21*b2**2)/16)*c11/9)*ge - 13*complex(0, 1)*M0*w*al*(-2*c44**2 + (-(21*c11)/13 - (73*c12)/13)*c44 + (c11 + 2*c12)*(c11 - c12))/18)*cos(t)**2 + (c44**2*H*M0/9 + (H*(c11 + (7*c12)/3)*M0/6 - b2**2/9)*c44 - H*(c11 + 2*c12)*(c11 - c12)*M0/18 + (-(7*b2**2)/36 - A*w**2*ro/9)*c12 - c11*(A*w**2*ro + (3*b2**2)/4)/9)*ge + M0*w*(-2*c44**2 + (-3*c11 - 7*c12)*c44 + (c11 + 2*c12)*(c11 - c12))*al*complex(0, 1)/18)*(cos(t) - 1)*cos(fi)**4 - (c11 - c12 - 2*c44)*(cos(t) + 1)*(((2*c44**2*H*M0 + (H*(c11 + 5*c12)*M0 - 2*b2**2)*c44 - H*(c11 + 2*c12)*(c11 - c12)*M0 - b2**2*(c11 + 5*c12)/2)*ge + M0*(c11 - c12 - 2*c44)*w*(c11 + 2*c12 + c44)*al*complex(0, 1))*cos(t)**4 + ((-(13*c44**2*H*M0)/9 + (-(7*H*(c11 + (73*c12)/21)*M0)/6 + (13*b2**2)/9)*c44 + (13*H*(c11 + 2*c12)*(c11 - c12)*M0)/18 + ((4*A*w**2*ro)/9 + (73*b2**2)/36)*c12 + 4*(A*w**2*ro + (21*b2**2)/16)*c11/9)*ge - 13*complex(0, 1)*M0*w*al*(-2*c44**2 + (-(21*c11)/13 - (73*c12)/13)*c44 + (c11 + 2*c12)*(c11 - c12))/18)*cos(t)**2 + (c44**2*H*M0/9 + (H*(c11 + (7*c12)/3)*M0/6 - b2**2/9)*c44 - H*(c11 + 2*c12)*(c11 - c12)*M0/18 + (-(7*b2**2)/36 - A*w**2*ro/9)*c12 - c11*(A*w**2*ro + (3*b2**2)/4)/9)*ge + M0*w*(-2*c44**2 + (-3*c11 - 7*c12)*c44 + (c11 + 2*c12)*(c11 - c12))*al*complex(0, 1)/18)*(cos(t) - 1)*cos(fi)**2 + b2**2*ge*(c11 + c12)*(c11 - c12 - 2*c44)*cos(t)**6/2 + 4*((2*c44**2*H*M0 + (-H*(c11 - c12)*M0 - 2*A*w**2*ro + (15*b2**2)/8)*c44 + (A*w**2*ro - (23*b2**2)/16)*(c11 - c12))*ge + M0*(c11 - c12 - 2*c44)*w*c44*al*complex(0, 1))*(c11 + c12)*cos(t)**4/9 + ((-(8*H*M0*(c11 + c12)*c44**2)/9 + ((4/9*c11**2*H - 4/9*c12**2*H)*M0 + (b2**2/9 + (8*A*w**2*ro)/9)*c12 + 8*(A*w**2*ro + b2**2/16)*c11/9)*c44 - 4*(A*w**2*ro - (3*b2**2)/8)*(c11 - c12)*(c11 + c12)/9)*ge - 4*complex(0, 1)*M0*(c11 - c12 - 2*c44)*w*c44*al*(c11 + c12)/9)*cos(t)**2 + (H*M0*(c11 + c12)*c44**2/9 + ((-1/18*c11**2*H + 1/18*c12**2*H)*M0 + (-A*w**2*ro/9 - b2**2/18)*c12 - c11*(A*w**2*ro + b2**2/4)/9)*c44 + A*w**2*ro*(c11 - c12)*(c11 + c12)/18)*ge + M0*(c11 - c12 - 2*c44)*w*c44*al*(c11 + c12)*complex(0, 1)/18)*ge*A*q**8/M0**2 + 144*(c11 - c12 - 2*c44)*(((c11 + 2*c12 + c44)*(c11 - c12 - 2*c44)*cos(t)**4 + ((13*c44**2)/9 + ((7*c11)/6 + (73*c12)/18)*c44 - 13*(c11 + 2*c12)*(c11 - c12)/18)*cos(t)**2 - c44**2/9 + (-c11/6 - (7*c12)/18)*c44 + ((c11 + 2*c12)*(c11 - c12))/18)*(cos(t) + 1)*(cos(t) - 1)*cos(fi)**4 - ((c11 + 2*c12 + c44)*(c11 - c12 - 2*c44)*cos(t)**4 + ((13*c44**2)/9 + ((7*c11)/6 + (73*c12)/18)*c44 - 13*(c11 + 2*c12)*(c11 - c12)/18)*cos(t)**2 - c44**2/9 + (-c11/6 - (7*c12)/18)*c44 + ((c11 + 2*c12)*(c11 - c12))/18)*(cos(t) + 1)*(cos(t) - 1)*cos(fi)**2 + 4*(cos(t)**4 - cos(t)**2 + 1/8)*(c11 + c12)*c44/9)*A**2*ge**2*q**10/M0**2
    Gff = 32*((al**2/2 + 1/2)*w**2 + H*al*ge*w*complex(0, 1) - H**2*ge**2/2)*(c11 - c12 - 2*c44)*ro*w**2*(c11 + c12)*(cos(t) + 1)**2*(cos(t) - 1)**2*(cos(fi)**4 - cos(fi)**2 + 1/8)*q**4 + 64*(c11 - c12 - 2*c44)*(cos(t) + 1)**2*(cos(fi)**4 - cos(fi)**2 + 1/8)*((-((c11 - c12 - 2*c44)*(c11 + 2*c12 + c44)*((al**2/2 + 1/2)*w**2 + H*al*ge*w*complex(0, 1) - H**2*ge**2/2)*M0**2)/2 - ge*(c11 + 5*c12 + 4*c44)*(w*al*complex(0, 1) - H*ge)*b2**2*M0/4 - ge**2*b2**4/2)*cos(t)**2 + M0*(-c44*((al**2/2 + 1/2)*w**2 + H*al*ge*w*complex(0, 1) - H**2*ge**2/2)*M0/2 + ge*(A*w**2*ro + b2**2/4)*(w*al*complex(0, 1) - H*ge))*(c11 + c12))*(cos(t) - 1)**2*q**6/M0**2 - 64*(((c11 - c12 - 2*c44)*(c11 + 2*c12 + c44)*(w*al*complex(0, 1) - H*ge)*M0 - b2**2*ge*(c11 + 5*c12 + 4*c44)/2)*cos(t)**2 + (c44*(w*al*complex(0, 1) - H*ge)*M0 + ge*(A*w**2*ro + b2**2/2))*(c11 + c12))*(c11 - c12 - 2*c44)*ge*A*(cos(t) + 1)**2*(cos(fi)**4 - cos(fi)**2 + 1/8)*(cos(t) - 1)**2*q**8/M0**2 + 64*(c11 - c12 - 2*c44)*A**2*(cos(fi)**4 - cos(fi)**2 + 1/8)*(cos(t) + 1)**2*ge**2*((c11 + 2*c12 + c44)*(c11 - c12 - 2*c44)*cos(t)**2 + c44*(c11 + c12))*(cos(t) - 1)**2*q**10/M0**2
    Gqt = 4*w**4*ge*(-w*al*complex(0, 1) + H*ge)*b2**2*cos(t)*sin(t)*ro**2*q/M0 + 32*w**2*sin(t)*ro*cos(t)*(M0**2*((al**2/2 + 1/2)*w**2 + H*al*ge*w*complex(0, 1) - H**2*ge**2/2)*(c11 - c12 - 2*c44)*(cos(t) + 1)*(cos(t) - 1)*(c11 + c12)*cos(fi)**4 - M0**2*((al**2/2 + 1/2)*w**2 + H*al*ge*w*complex(0, 1) - H**2*ge**2/2)*(c11 - c12 - 2*c44)*(cos(t) + 1)*(cos(t) - 1)*(c11 + c12)*cos(fi)**2 + M0*(M0*(c11 - c12 - 2*c44)*((al**2/2 + 1/2)*w**2 + H*al*ge*w*complex(0, 1) - H**2*ge**2/2) + ge*(w*al*complex(0, 1) - H*ge)*b2**2)*(c11 + c12)*cos(t)**2 - M0**2*(c11 - c12 - 2*c44)*((al**2/2 + 1/2)*w**2 + H*al*ge*w*complex(0, 1) - H**2*ge**2/2)*(c11 + c12)/2 - ge*(w*al*complex(0, 1) - H*ge)*(c11 + 2*c12 - c44)*b2**2*M0/4 + ((A*w**2*ro + b2**2/2)*ge**2*b2**2)/2)*q**3/M0**2 + 96*((c11 - c12 - 2*c44)*(cos(t) + 1)*(cos(t) - 1)*((-3*(c11 - c12 - 2*c44)*(c11 + 2*c12 + c44)*(-H**2*ge**2/2 + H*al*ge*w*complex(0, 1) + ((al**2 + 1)*w**2)/2)*M0**2/4 - (3*ge*(c11 + 5*c12 + 4*c44)*(w*al*complex(0, 1) - H*ge)*b2**2*M0)/8 - (3*ge**2*b2**4)/4)*cos(t)**2 + ((-H**2*ge**2/2 + H*al*ge*w*complex(0, 1) + ((al**2 + 1)*w**2)/2)*(-2*c44**2 + (-3*c11 - 7*c12)*c44 + (c11 + 2*c12)*(c11 - c12))*M0**2)/4 + ge*(w*al*complex(0, 1) - H*ge)*(A*ro*(c11 + c12)*w**2 + 3*(c11 + (7*c12)/3 + (4*c44)/3)*b2**2/8)*M0 + ge**2*b2**4/4)*cos(fi)**4 - (c11 - c12 - 2*c44)*(cos(t) + 1)*(cos(t) - 1)*((-3*(c11 - c12 - 2*c44)*(c11 + 2*c12 + c44)*(-H**2*ge**2/2 + H*al*ge*w*complex(0, 1) + ((al**2 + 1)*w**2)/2)*M0**2/4 - (3*ge*(c11 + 5*c12 + 4*c44)*(w*al*complex(0, 1) - H*ge)*b2**2*M0)/8 - (3*ge**2*b2**4)/4)*cos(t)**2 + ((-H**2*ge**2/2 + H*al*ge*w*complex(0, 1) + ((al**2 + 1)*w**2)/2)*(-2*c44**2 + (-3*c11 - 7*c12)*c44 + (c11 + 2*c12)*(c11 - c12))*M0**2)/4 + ge*(w*al*complex(0, 1) - H*ge)*(A*ro*(c11 + c12)*w**2 + 3*(c11 + (7*c12)/3 + (4*c44)/3)*b2**2/8)*M0 + ge**2*b2**4/4)*cos(fi)**2 + (3*ge*((c11 - c12 - 2*c44)*(w*al*complex(0, 1) - H*ge)*M0 - 2*ge*b2**2)*b2**2*(c11 + c12)*cos(t)**4)/8 + (-((c11 - c12 - 2*c44)*(-H**2*ge**2/2 + H*al*ge*w*complex(0, 1) + ((al**2 + 1)*w**2)/2)*c44*M0**2)/2 + ge*(w*al*complex(0, 1) - H*ge)*(A*ro*(c11 - c12 - 2*c44)*w**2 - b2**2*(c11 - c12)/4)*M0 - ge**2*(A*w**2*ro - b2**2/2)*b2**2)*(c11 + c12)*cos(t)**2 + ((c11 - c12 - 2*c44)*(-H**2*ge**2/2 + H*al*ge*w*complex(0, 1) + ((al**2 + 1)*w**2)/2)*c44*(c11 + c12)*M0**2)/4 - ge*(A*ro*(c11 + c12)*(c11 - c12 - 2*c44)*w**2 - c44*b2**2*(c11 + 2*c12)/4)*(w*al*complex(0, 1) - H*ge)*M0/2 + ((A*ro*(c11 + 2*c12 - c44)*w**2 - b2**2*c11/2)*ge**2*b2**2)/4)*sin(t)*cos(t)*q**5/M0**2 - 192*ge*A*sin(t)*cos(t)*((c11 - c12 - 2*c44)*(cos(t) + 1)*(((-H*(c11 + 2*c12 + c44)*(c11 - c12 - 2*c44)*M0 - b2**2*(c11 + 5*c12 + 4*c44)/2)*ge + M0*(c11 - c12 - 2*c44)*w*(c11 + 2*c12 + c44)*al*complex(0, 1))*cos(t)**2 + (((-2*c44**2 + (-3*c11 - 7*c12)*c44 + (c11 + 2*c12)*(c11 - c12))*H*M0)/3 + (2*b2**2*c44)/3 + ((7*b2**2)/6 + (2*A*w**2*ro)/3)*c12 + (2*c11*(A*w**2*ro + (3*b2**2)/4))/3)*ge - M0*w*(-2*c44**2 + (-3*c11 - 7*c12)*c44 + (c11 + 2*c12)*(c11 - c12))*al*complex(0, 1)/3)*(cos(t) - 1)*cos(fi)**4 - (c11 - c12 - 2*c44)*(cos(t) + 1)*(((-H*(c11 + 2*c12 + c44)*(c11 - c12 - 2*c44)*M0 - b2**2*(c11 + 5*c12 + 4*c44)/2)*ge + M0*(c11 - c12 - 2*c44)*w*(c11 + 2*c12 + c44)*al*complex(0, 1))*cos(t)**2 + (((-2*c44**2 + (-3*c11 - 7*c12)*c44 + (c11 + 2*c12)*(c11 - c12))*H*M0)/3 + (2*b2**2*c44)/3 + ((7*b2**2)/6 + (2*A*w**2*ro)/3)*c12 + (2*c11*(A*w**2*ro + (3*b2**2)/4))/3)*ge - M0*w*(-2*c44**2 + (-3*c11 - 7*c12)*c44 + (c11 + 2*c12)*(c11 - c12))*al*complex(0, 1)/3)*(cos(t) - 1)*cos(fi)**2 + b2**2*ge*(c11 + c12)*(c11 - c12 - 2*c44)*cos(t)**4/2 + 2*((-H*c44*(c11 - c12 - 2*c44)*M0 - 2*A*w**2*ro*c44 + (c11 - c12)*(A*w**2*ro - b2**2/2))*ge + M0*(c11 - c12 - 2*c44)*w*c44*al*complex(0, 1))*(c11 + c12)*cos(t)**2/3 + (H*c44*(c11 + c12)*(c11 - c12 - 2*c44)*M0/3 + (((2*A*w**2*ro)/3 + b2**2/3)*c12 + (2*c11*(A*w**2*ro + b2**2/4))/3)*c44 - A*w**2*ro*(c11 - c12)*(c11 + c12)/3)*ge - M0*(c11 - c12 - 2*c44)*w*c44*al*(c11 + c12)*complex(0, 1)/3)*q**7/M0**2 + 240*(c11 - c12 - 2*c44)*sin(t)*A**2*cos(t)*ge**2*(((c11 + 2*c12 + c44)*(c11 - c12 - 2*c44)*cos(t)**2 + (2*c44**2)/3 + (c11 + (7*c12)/3)*c44 - ((c11 + 2*c12)*(c11 - c12))/3)*(cos(t) + 1)*(cos(t) - 1)*cos(fi)**4 - ((c11 + 2*c12 + c44)*(c11 - c12 - 2*c44)*cos(t)**2 + (2*c44**2)/3 + (c11 + (7*c12)/3)*c44 - ((c11 + 2*c12)*(c11 - c12))/3)*(cos(t) + 1)*(cos(t) - 1)*cos(fi)**2 + 2*(c11 + c12)*(cos(t)**2 - 1/2)*c44/3)*q**9/M0**2
    Gtf = -8*w**2*ro*sin(t)*cos(t)*(2*complex(0, 1)*H*al*ge*w + al**2*w**2 - H**2*ge**2 + w**2)*(c11 - c12 - 2*c44)*(c11 + c12)*cos(fi)*sin(fi)*(2*cos(fi)**2 - 1)*(cos(t)**2 - 1)*q**4 - 64*(c11 - c12 - 2*c44)*((-3*(c11 - c12 - 2*c44)*(c11 + 2*c12 + c44)*((al**2/2 + 1/2)*w**2 + H*al*ge*w*complex(0, 1) - H**2*ge**2/2)*M0**2/4 - (3*ge*(c11 + 5*c12 + 4*c44)*(w*al*complex(0, 1) - H*ge)*b2**2*M0)/8 - (3*ge**2*b2**4)/4)*cos(t)**2 + ((c11**2 + (c12 - 3*c44)*c11 - 2*c12**2 - 7*c44*c12 - 2*c44**2)*((al**2/2 + 1/2)*w**2 + H*al*ge*w*complex(0, 1) - H**2*ge**2/2)*M0**2)/4 + ge*(w*al*complex(0, 1) - H*ge)*(A*ro*(c11 + c12)*w**2 + 3*(c11 + (7*c12)/3 + (4*c44)/3)*b2**2/8)*M0 + ge**2*b2**4/4)*(cos(fi)**2 - 1/2)*(cos(t) + 1)*sin(t)*cos(t)*(cos(t) - 1)*cos(fi)*sin(fi)*q**6/M0**2 + 96*(c11 - c12 - 2*c44)*ge*(((c11 - c12 - 2*c44)*(c11 + 2*c12 + c44)*(w*al*complex(0, 1) - H*ge)*M0 - b2**2*ge*(c11 + 5*c12 + 4*c44)/2)*cos(t)**2 - ((w*al*complex(0, 1) - H*ge)*(c11**2 + (c12 - 3*c44)*c11 - 2*c12**2 - 7*c44*c12 - 2*c44**2)*M0)/3 + 2*(c11*(A*w**2*ro + (3*b2**2)/4) + (A*w**2*ro + (7*b2**2)/4)*c12 + b2**2*c44)*ge/3)*A*(cos(fi)**2 - 1/2)*(cos(t) + 1)*sin(t)*cos(t)*(cos(t) - 1)*cos(fi)*sin(fi)*q**8/M0**2 - 96*(c11 - c12 - 2*c44)*((c11 + 2*c12 + c44)*(c11 - c12 - 2*c44)*cos(t)**2 - c11**2/3 + (-c12/3 + c44)*c11 + (2*c12**2)/3 + (7*c44*c12)/3 + (2*c44**2)/3)*sin(t)*A**2*sin(fi)*cos(t)*(cos(t) + 1)*ge**2*(cos(fi)**2 - 1/2)*cos(fi)*(cos(t) - 1)*q**10/M0**2
    Gqf = 32*sin(fi)*cos(fi)*(c11 - c12 - 2*c44)*ro*((al**2/2 + 1/2)*w**2 + H*al*ge*w*complex(0, 1) - H**2*ge**2/2)*w**2*(c11 + c12)*(cos(t) + 1)**2*(cos(t) - 1)**2*(cos(fi)**2 - 1/2)*q**3 + 96*(cos(fi)**2 - 1/2)*(c11 - c12 - 2*c44)*(cos(t) + 1)**2*cos(fi)*((-((c11 - c12 - 2*c44)*(c11 + 2*c12 + c44)*((al**2/2 + 1/2)*w**2 + H*al*ge*w*complex(0, 1) - H**2*ge**2/2)*M0**2)/2 - ge*(c11 + 5*c12 + 4*c44)*(w*al*complex(0, 1) - H*ge)*b2**2*M0/4 - ge**2*b2**4/2)*cos(t)**2 + M0*(-c44*((al**2/2 + 1/2)*w**2 + H*al*ge*w*complex(0, 1) - H**2*ge**2/2)*M0/2 + ge*(A*w**2*ro + b2**2/4)*(w*al*complex(0, 1) - H*ge))*(c11 + c12))*(cos(t) - 1)**2*sin(fi)*q**5/M0**2 - 128*(cos(fi)**2 - 1/2)*(((c11 - c12 - 2*c44)*(c11 + 2*c12 + c44)*(w*al*complex(0, 1) - H*ge)*M0 - b2**2*ge*(c11 + 5*c12 + 4*c44)/2)*cos(t)**2 + (c44*(w*al*complex(0, 1) - H*ge)*M0 + ge*(A*w**2*ro + b2**2/2))*(c11 + c12))*(c11 - c12 - 2*c44)*ge*A*(cos(t) + 1)**2*cos(fi)*(cos(t) - 1)**2*sin(fi)*q**7/M0**2 + 160*(c11 - c12 - 2*c44)*(cos(fi)**2 - 1/2)*cos(fi)*A**2*(cos(t) + 1)**2*ge**2*sin(fi)*((c11 + 2*c12 + c44)*(c11 - c12 - 2*c44)*cos(t)**2 + c44*(c11 + c12))*(cos(t) - 1)**2*q**9/M0**2

    qtt = -(Gqq*qt**2 + 2*Gqt*qt + Gtt)/Gq
    qff = -(Gqq*qf**2 + 2*Gqf*qf + Gff)/Gq
    qtf = -(Gqq*qt*qf + Gqt*qf + Gqf*qt + Gtf)/Gq

    qt_v = np.array([(qt*sin(t) + q*cos(t))*cos(fi), (qt*sin(t) + q*cos(t))*sin(fi), qt*cos(t) - q*sin(t)])
    qf_v = np.array([sin(t)*(qf*cos(fi) - q*sin(fi)), (qf*sin(fi) + q*cos(fi))*sin(t), qf*cos(t)])

    qtt_v = np.array([
        (qtt*sin(t) + 2*qt*cos(t) - q*sin(t))*cos(fi),
        (qtt*sin(t) + 2*qt*cos(t) - q*sin(t))*sin(fi),
        qtt*cos(t) - 2*qt*sin(t) - q*cos(t)
    ])
    
    qff_v = np.array([
        (qff*cos(fi) - 2*qf*sin(fi) - q*cos(fi))*sin(t),
        (qff*sin(fi) + 2*qf*cos(fi) - q*sin(fi))*sin(t),
        qff*cos(t)
    ])

    qtf_v = np.array([
        qtf*sin(t)*cos(fi) - qt*sin(t)*sin(fi) + qf*cos(t)*cos(fi) - q*cos(t)*sin(fi),
        qtf*sin(t)*sin(fi) + qt*sin(t)*cos(fi) + qf*cos(t)*sin(fi) + q*cos(t)*cos(fi),
        qtf*cos(t) - qf*sin(t)
    ])

    n_v = np.array([
        qt_v[1]*qf_v[2] - qt_v[2]*qf_v[1], qt_v[2]*qf_v[0] - qt_v[0]*qf_v[2], qt_v[0]*qf_v[1] - qt_v[1]*qf_v[0]
    ])
    
    E = np.abs(qt)**2 + np.abs(q)**2
    G = np.abs(qf)**2 + np.abs(q)**2*sin(t)*sin(t)
    F = qt*np.conj(qf)
    
    I = E*G-np.abs(F)**2
    
    L = np.vdot(qtt_v,n_v)/sqrt(I)
    M = np.vdot(qtf_v,n_v)/sqrt(I)
    N = np.vdot(qff_v,n_v)/sqrt(I)

    # Curvature and amlification factor
    K = (L*N - M**2)/I
    cosVq = -1/sqrt(1 + (qt/q)**2 + (qf/q/sin(t))**2)
    Ampl = np.abs(cosVq/(K*q*q))
    return [K, Ampl]

def Derivatives(w,q,t,fi,x,H):
    mb,hp,g,ge,Ka,ro,a0,c11,c12,c44,M0,A,b2,al = Const(x)
    
    Gq = 8*w**4*(ge*(w*al*complex(0, 1) - H*ge)*b2**2*cos(t)**2/4 + A*al*ge*ro*w**3*complex(0, 1) + (-A*H*ge**2*ro - M0*(al**2 + 1)*(c11 + 2*c44)/4)*w**2 - (H*(c11 + 2*c44)*M0 - b2**2/2)*ge*al*w*complex(0, 1)/2 + ge**2*H*(H*(c11 + 2*c44)*M0 - b2**2)/4)*ro**2*q/M0 - 16*(M0*(M0*(c11 - c12 - 2*c44)*((al**2/2 + 1/2)*w**2 + H*al*ge*w*complex(0, 1) - H**2*ge**2/2)*cos(fi)**4 - M0*(c11 - c12 - 2*c44)*((al**2/2 + 1/2)*w**2 + H*al*ge*w*complex(0, 1) - H**2*ge**2/2)*cos(fi)**2 + M0*(c11 - c12 - 2*c44)*((al**2/2 + 1/2)*w**2 + H*al*ge*w*complex(0, 1) - H**2*ge**2/2) + ge*(w*al*complex(0, 1) - H*ge)*b2**2)*(c11 + c12)*cos(t)**4/2 + (-M0**2*(c11 - c12 - 2*c44)*((al**2/2 + 1/2)*w**2 + H*al*ge*w*complex(0, 1) - H**2*ge**2/2)*(c11 + c12)*cos(fi)**4 + M0**2*(c11 - c12 - 2*c44)*((al**2/2 + 1/2)*w**2 + H*al*ge*w*complex(0, 1) - H**2*ge**2/2)*(c11 + c12)*cos(fi)**2 - M0**2*(c11 - c12 - 2*c44)*((al**2/2 + 1/2)*w**2 + H*al*ge*w*complex(0, 1) - H**2*ge**2/2)*(c11 + c12)/2 - ge*(w*al*complex(0, 1) - H*ge)*(c11 + 2*c12 - c44)*b2**2*M0/4 + ((A*w**2*ro + b2**2/2)*ge**2*b2**2)/2)*cos(t)**2 + M0**2*(c11 - c12 - 2*c44)*((al**2/2 + 1/2)*w**2 + H*al*ge*w*complex(0, 1) - H**2*ge**2/2)*(c11 + c12)*cos(fi)**4/2 - M0**2*(c11 - c12 - 2*c44)*((al**2/2 + 1/2)*w**2 + H*al*ge*w*complex(0, 1) - H**2*ge**2/2)*(c11 + c12)*cos(fi)**2/2 - (c11 + c44/2)*((al**2/2 + 1/2)*w**2 + H*al*ge*w*complex(0, 1) - H**2*ge**2/2)*c44*M0**2 + ge*(w*al*complex(0, 1) - H*ge)*(A*ro*(c11 + 2*c44)*w**2 + b2**2*(c11 + c44)/4)*M0 + A*ge**2*ro*w**2*(A*w**2*ro + b2**2/2))*w**2*ro*q**3/M0**2 + ((12*((c11 - c12 - 2*c44)*(c11 + 2*c12 + c44)*(-H**2*ge**2/2 + H*al*ge*w*complex(0, 1) + ((al**2 + 1)*w**2)/2)*M0**2 + ge*(c11 + 5*c12 + 4*c44)*(w*al*complex(0, 1) - H*ge)*b2**2*M0/2 + ge**2*b2**4)*(c11 - c12 - 2*c44)*cos(fi)**4 - 12*((c11 - c12 - 2*c44)*(c11 + 2*c12 + c44)*(-H**2*ge**2/2 + H*al*ge*w*complex(0, 1) + ((al**2 + 1)*w**2)/2)*M0**2 + ge*(c11 + 5*c12 + 4*c44)*(w*al*complex(0, 1) - H*ge)*b2**2*M0/2 + ge**2*b2**4)*(c11 - c12 - 2*c44)*cos(fi)**2 - 6*ge*((c11 - c12 - 2*c44)*(w*al*complex(0, 1) - H*ge)*M0 - 2*ge*b2**2)*b2**2*(c11 + c12))*cos(t)**6 + (-24*(c11 - c12 - 2*c44)*((-H**2*ge**2/2 + H*al*ge*w*complex(0, 1) + ((al**2 + 1)*w**2)/2)*(-2*c44**2 + (-(3*c11)/2 - (11*c12)/2)*c44 + (c11 + 2*c12)*(c11 - c12))*M0**2 + ge*(A*ro*(c11 + c12)*w**2 + 3*(c11 + (11*c12)/3 + (8*c44)/3)*b2**2/4)*(w*al*complex(0, 1) - H*ge)*M0 + ge**2*b2**4)*cos(fi)**4 + 24*(c11 - c12 - 2*c44)*((-H**2*ge**2/2 + H*al*ge*w*complex(0, 1) + ((al**2 + 1)*w**2)/2)*(-2*c44**2 + (-(3*c11)/2 - (11*c12)/2)*c44 + (c11 + 2*c12)*(c11 - c12))*M0**2 + ge*(A*ro*(c11 + c12)*w**2 + 3*(c11 + (11*c12)/3 + (8*c44)/3)*b2**2/4)*(w*al*complex(0, 1) - H*ge)*M0 + ge**2*b2**4)*cos(fi)**2 - 24*(-((c11 - c12 - 2*c44)*(-H**2*ge**2/2 + H*al*ge*w*complex(0, 1) + ((al**2 + 1)*w**2)/2)*c44*M0**2)/2 + ge*(w*al*complex(0, 1) - H*ge)*(A*ro*(c11 - c12 - 2*c44)*w**2 - b2**2*(c11 - c12)/4)*M0 - ge**2*(A*w**2*ro - b2**2/2)*b2**2)*(c11 + c12))*cos(t)**4 + (48*(c11 - c12 - 2*c44)*(((-H**2*ge**2/2 + H*al*ge*w*complex(0, 1) + ((al**2 + 1)*w**2)/2)*(-2*c44**2 + (-3*c11 - 7*c12)*c44 + (c11 + 2*c12)*(c11 - c12))*M0**2)/4 + ge*(w*al*complex(0, 1) - H*ge)*(A*ro*(c11 + c12)*w**2 + 3*(c11 + (7*c12)/3 + (4*c44)/3)*b2**2/8)*M0 + ge**2*b2**4/4)*cos(fi)**4 - 48*(c11 - c12 - 2*c44)*(((-H**2*ge**2/2 + H*al*ge*w*complex(0, 1) + ((al**2 + 1)*w**2)/2)*(-2*c44**2 + (-3*c11 - 7*c12)*c44 + (c11 + 2*c12)*(c11 - c12))*M0**2)/4 + ge*(w*al*complex(0, 1) - H*ge)*(A*ro*(c11 + c12)*w**2 + 3*(c11 + (7*c12)/3 + (4*c44)/3)*b2**2/8)*M0 + ge**2*b2**4/4)*cos(fi)**2 - 12*(c11 - c12 - 2*c44)*(-H**2*ge**2/2 + H*al*ge*w*complex(0, 1) + ((al**2 + 1)*w**2)/2)*c44*(c11 + c12)*M0**2 + 24*ge*(A*ro*(c11 + c12)*(c11 - c12 - 2*c44)*w**2 - c44*b2**2*(c11 + 2*c12)/4)*(w*al*complex(0, 1) - H*ge)*M0 - 12*(A*ro*(c11 + 2*c12 - c44)*w**2 - b2**2*c11/2)*ge**2*b2**2)*cos(t)**2 - 24*M0*(c11 - c12 - 2*c44)*(-((-H**2*ge**2/2 + H*al*ge*w*complex(0, 1) + ((al**2 + 1)*w**2)/2)*c44*M0)/2 + ge*(A*w**2*ro + b2**2/4)*(w*al*complex(0, 1) - H*ge))*(c11 + c12)*cos(fi)**4 + 24*M0*(c11 - c12 - 2*c44)*(-((-H**2*ge**2/2 + H*al*ge*w*complex(0, 1) + ((al**2 + 1)*w**2)/2)*c44*M0)/2 + ge*(A*w**2*ro + b2**2/4)*(w*al*complex(0, 1) - H*ge))*(c11 + c12)*cos(fi)**2 - 12*(-H**2*ge**2/2 + H*al*ge*w*complex(0, 1) + ((al**2 + 1)*w**2)/2)*c11*c44**2*M0**2 + 48*ge*c44*(w*al*complex(0, 1) - H*ge)*(A*ro*(c11 + c44/2)*w**2 + b2**2*c11/8)*M0 + 24*ge**2*w**2*A*ro*(A*ro*(c11 + 2*c44)*w**2 + b2**2*(c11 + c44)/2))*q**5/M0**2 + 32*ge*A*((((2*c44**2*H*M0 + (H*(c11 + 5*c12)*M0 - 2*b2**2)*c44 - H*(c11 + 2*c12)*(c11 - c12)*M0 - b2**2*(c11 + 5*c12)/2)*ge + M0*(c11 - c12 - 2*c44)*w*(c11 + 2*c12 + c44)*al*complex(0, 1))*cos(t)**2 + (c11 + c12)*((A*w**2*ro - c44*H*M0 + b2**2/2)*ge + c44*w*M0*al*complex(0, 1)))*(c11 - c12 - 2*c44)*(cos(t) + 1)**2*(cos(t) - 1)**2*cos(fi)**4 - (((2*c44**2*H*M0 + (H*(c11 + 5*c12)*M0 - 2*b2**2)*c44 - H*(c11 + 2*c12)*(c11 - c12)*M0 - b2**2*(c11 + 5*c12)/2)*ge + M0*(c11 - c12 - 2*c44)*w*(c11 + 2*c12 + c44)*al*complex(0, 1))*cos(t)**2 + (c11 + c12)*((A*w**2*ro - c44*H*M0 + b2**2/2)*ge + c44*w*M0*al*complex(0, 1)))*(c11 - c12 - 2*c44)*(cos(t) + 1)**2*(cos(t) - 1)**2*cos(fi)**2 + b2**2*ge*(c11 + c12)*(c11 - c12 - 2*c44)*cos(t)**6/2 + ((2*c44**2*H*M0 + (-H*(c11 - c12)*M0 - 2*A*w**2*ro)*c44 + (c11 - c12)*(A*w**2*ro - b2**2/2))*ge + M0*(c11 - c12 - 2*c44)*w*c44*al*complex(0, 1))*(c11 + c12)*cos(t)**4 + ((-2*H*M0*(c11 + c12)*c44**2 + ((H*c11**2 - H*c12**2)*M0 + (b2**2/2 + 2*A*w**2*ro)*c11 + c12*(2*A*ro*w**2 + b2**2))*c44 - A*w**2*ro*(c11 - c12)*(c11 + c12))*ge - M0*(c11 - c12 - 2*c44)*w*c44*al*(c11 + c12)*complex(0, 1))*cos(t)**2 - c44*(((A*ro*w**2 - H*M0*c11)*c44 + 2*c11*(A*w**2*ro + b2**2/4))*ge + c11*c44*w*M0*al*complex(0, 1)))*q**7/M0**2 - 40*A**2*((c11 - c12 - 2*c44)*(cos(t) + 1)**2*((c11 + 2*c12 + c44)*(c11 - c12 - 2*c44)*cos(t)**2 + c44*(c11 + c12))*(cos(t) - 1)**2*cos(fi)**4 - (c11 - c12 - 2*c44)*(cos(t) + 1)**2*((c11 + 2*c12 + c44)*(c11 - c12 - 2*c44)*cos(t)**2 + c44*(c11 + c12))*(cos(t) - 1)**2*cos(fi)**2 + ((c11 + c12)*(c11 - c12 - 2*c44)*cos(t)**4 - (c11 + c12)*(c11 - c12 - 2*c44)*cos(t)**2 - c11*c44)*c44)*ge**2*q**9/M0**2
    Gt = 2*w**4*ge*(-w*al*complex(0, 1) + H*ge)*b2**2*cos(t)*sin(t)*ro**2*q**2/M0 + 8*w**2*sin(t)*ro*cos(t)*(M0**2*((al**2/2 + 1/2)*w**2 + H*al*ge*w*complex(0, 1) - H**2*ge**2/2)*(c11 - c12 - 2*c44)*(cos(t) + 1)*(cos(t) - 1)*(c11 + c12)*cos(fi)**4 - M0**2*((al**2/2 + 1/2)*w**2 + H*al*ge*w*complex(0, 1) - H**2*ge**2/2)*(c11 - c12 - 2*c44)*(cos(t) + 1)*(cos(t) - 1)*(c11 + c12)*cos(fi)**2 + M0*(M0*(c11 - c12 - 2*c44)*((al**2/2 + 1/2)*w**2 + H*al*ge*w*complex(0, 1) - H**2*ge**2/2) + ge*(w*al*complex(0, 1) - H*ge)*b2**2)*(c11 + c12)*cos(t)**2 - M0**2*(c11 - c12 - 2*c44)*((al**2/2 + 1/2)*w**2 + H*al*ge*w*complex(0, 1) - H**2*ge**2/2)*(c11 + c12)/2 - ge*(w*al*complex(0, 1) - H*ge)*(c11 + 2*c12 - c44)*b2**2*M0/4 + ((A*w**2*ro + b2**2/2)*ge**2*b2**2)/2)*q**4/M0**2 + 16*((c11 - c12 - 2*c44)*(cos(t) + 1)*(cos(t) - 1)*((-3*(c11 - c12 - 2*c44)*(c11 + 2*c12 + c44)*(-H**2*ge**2/2 + H*al*ge*w*complex(0, 1) + ((al**2 + 1)*w**2)/2)*M0**2/4 - (3*ge*(c11 + 5*c12 + 4*c44)*(w*al*complex(0, 1) - H*ge)*b2**2*M0)/8 - (3*ge**2*b2**4)/4)*cos(t)**2 + ((-H**2*ge**2/2 + H*al*ge*w*complex(0, 1) + ((al**2 + 1)*w**2)/2)*(-2*c44**2 + (-3*c11 - 7*c12)*c44 + (c11 + 2*c12)*(c11 - c12))*M0**2)/4 + ge*(w*al*complex(0, 1) - H*ge)*(A*ro*(c11 + c12)*w**2 + 3*(c11 + (7*c12)/3 + (4*c44)/3)*b2**2/8)*M0 + ge**2*b2**4/4)*cos(fi)**4 - (c11 - c12 - 2*c44)*(cos(t) + 1)*(cos(t) - 1)*((-3*(c11 - c12 - 2*c44)*(c11 + 2*c12 + c44)*(-H**2*ge**2/2 + H*al*ge*w*complex(0, 1) + ((al**2 + 1)*w**2)/2)*M0**2/4 - (3*ge*(c11 + 5*c12 + 4*c44)*(w*al*complex(0, 1) - H*ge)*b2**2*M0)/8 - (3*ge**2*b2**4)/4)*cos(t)**2 + ((-H**2*ge**2/2 + H*al*ge*w*complex(0, 1) + ((al**2 + 1)*w**2)/2)*(-2*c44**2 + (-3*c11 - 7*c12)*c44 + (c11 + 2*c12)*(c11 - c12))*M0**2)/4 + ge*(w*al*complex(0, 1) - H*ge)*(A*ro*(c11 + c12)*w**2 + 3*(c11 + (7*c12)/3 + (4*c44)/3)*b2**2/8)*M0 + ge**2*b2**4/4)*cos(fi)**2 + (3*ge*((c11 - c12 - 2*c44)*(w*al*complex(0, 1) - H*ge)*M0 - 2*ge*b2**2)*b2**2*(c11 + c12)*cos(t)**4)/8 + (-((c11 - c12 - 2*c44)*(-H**2*ge**2/2 + H*al*ge*w*complex(0, 1) + ((al**2 + 1)*w**2)/2)*c44*M0**2)/2 + ge*(w*al*complex(0, 1) - H*ge)*(A*ro*(c11 - c12 - 2*c44)*w**2 - b2**2*(c11 - c12)/4)*M0 - ge**2*(A*w**2*ro - b2**2/2)*b2**2)*(c11 + c12)*cos(t)**2 + ((c11 - c12 - 2*c44)*(-H**2*ge**2/2 + H*al*ge*w*complex(0, 1) + ((al**2 + 1)*w**2)/2)*c44*(c11 + c12)*M0**2)/4 - ge*(A*ro*(c11 + c12)*(c11 - c12 - 2*c44)*w**2 - c44*b2**2*(c11 + 2*c12)/4)*(w*al*complex(0, 1) - H*ge)*M0/2 + ((A*ro*(c11 + 2*c12 - c44)*w**2 - b2**2*c11/2)*ge**2*b2**2)/4)*sin(t)*cos(t)*q**6/M0**2 - 24*ge*A*sin(t)*cos(t)*((c11 - c12 - 2*c44)*(cos(t) + 1)*(((-H*(c11 + 2*c12 + c44)*(c11 - c12 - 2*c44)*M0 - b2**2*(c11 + 5*c12 + 4*c44)/2)*ge + M0*(c11 - c12 - 2*c44)*w*(c11 + 2*c12 + c44)*al*complex(0, 1))*cos(t)**2 + (((-2*c44**2 + (-3*c11 - 7*c12)*c44 + (c11 + 2*c12)*(c11 - c12))*H*M0)/3 + (2*b2**2*c44)/3 + ((7*b2**2)/6 + (2*A*w**2*ro)/3)*c12 + (2*c11*(A*w**2*ro + (3*b2**2)/4))/3)*ge - M0*w*(-2*c44**2 + (-3*c11 - 7*c12)*c44 + (c11 + 2*c12)*(c11 - c12))*al*complex(0, 1)/3)*(cos(t) - 1)*cos(fi)**4 - (c11 - c12 - 2*c44)*(cos(t) + 1)*(((-H*(c11 + 2*c12 + c44)*(c11 - c12 - 2*c44)*M0 - b2**2*(c11 + 5*c12 + 4*c44)/2)*ge + M0*(c11 - c12 - 2*c44)*w*(c11 + 2*c12 + c44)*al*complex(0, 1))*cos(t)**2 + (((-2*c44**2 + (-3*c11 - 7*c12)*c44 + (c11 + 2*c12)*(c11 - c12))*H*M0)/3 + (2*b2**2*c44)/3 + ((7*b2**2)/6 + (2*A*w**2*ro)/3)*c12 + (2*c11*(A*w**2*ro + (3*b2**2)/4))/3)*ge - M0*w*(-2*c44**2 + (-3*c11 - 7*c12)*c44 + (c11 + 2*c12)*(c11 - c12))*al*complex(0, 1)/3)*(cos(t) - 1)*cos(fi)**2 + b2**2*ge*(c11 + c12)*(c11 - c12 - 2*c44)*cos(t)**4/2 + 2*((-H*c44*(c11 - c12 - 2*c44)*M0 - 2*A*w**2*ro*c44 + (c11 - c12)*(A*w**2*ro - b2**2/2))*ge + M0*(c11 - c12 - 2*c44)*w*c44*al*complex(0, 1))*(c11 + c12)*cos(t)**2/3 + (H*c44*(c11 + c12)*(c11 - c12 - 2*c44)*M0/3 + (((2*A*w**2*ro)/3 + b2**2/3)*c12 + (2*c11*(A*w**2*ro + b2**2/4))/3)*c44 - A*w**2*ro*(c11 - c12)*(c11 + c12)/3)*ge - M0*(c11 - c12 - 2*c44)*w*c44*al*(c11 + c12)*complex(0, 1)/3)*q**8/M0**2 + 24*(c11 - c12 - 2*c44)*sin(t)*A**2*cos(t)*ge**2*(((c11 + 2*c12 + c44)*(c11 - c12 - 2*c44)*cos(t)**2 + (2*c44**2)/3 + (c11 + (7*c12)/3)*c44 - ((c11 + 2*c12)*(c11 - c12))/3)*(cos(t) + 1)*(cos(t) - 1)*cos(fi)**4 - ((c11 + 2*c12 + c44)*(c11 - c12 - 2*c44)*cos(t)**2 + (2*c44**2)/3 + (c11 + (7*c12)/3)*c44 - ((c11 + 2*c12)*(c11 - c12))/3)*(cos(t) + 1)*(cos(t) - 1)*cos(fi)**2 + 2*(c11 + c12)*(cos(t)**2 - 1/2)*c44/3)*q**10/M0**2
    Gf = 8*sin(fi)*cos(fi)*(c11 - c12 - 2*c44)*ro*((al**2/2 + 1/2)*w**2 + H*al*ge*w*complex(0, 1) - H**2*ge**2/2)*w**2*(c11 + c12)*(cos(t) + 1)**2*(cos(t) - 1)**2*(cos(fi)**2 - 1/2)*q**4 + 16*(cos(fi)**2 - 1/2)*(c11 - c12 - 2*c44)*(cos(t) + 1)**2*cos(fi)*((-((c11 - c12 - 2*c44)*(c11 + 2*c12 + c44)*((al**2/2 + 1/2)*w**2 + H*al*ge*w*complex(0, 1) - H**2*ge**2/2)*M0**2)/2 - ge*(c11 + 5*c12 + 4*c44)*(w*al*complex(0, 1) - H*ge)*b2**2*M0/4 - ge**2*b2**4/2)*cos(t)**2 + M0*(-c44*((al**2/2 + 1/2)*w**2 + H*al*ge*w*complex(0, 1) - H**2*ge**2/2)*M0/2 + ge*(A*w**2*ro + b2**2/4)*(w*al*complex(0, 1) - H*ge))*(c11 + c12))*(cos(t) - 1)**2*sin(fi)*q**6/M0**2 - 16*(cos(fi)**2 - 1/2)*(((c11 - c12 - 2*c44)*(c11 + 2*c12 + c44)*(w*al*complex(0, 1) - H*ge)*M0 - b2**2*ge*(c11 + 5*c12 + 4*c44)/2)*cos(t)**2 + (c44*(w*al*complex(0, 1) - H*ge)*M0 + ge*(A*w**2*ro + b2**2/2))*(c11 + c12))*(c11 - c12 - 2*c44)*ge*A*(cos(t) + 1)**2*cos(fi)*(cos(t) - 1)**2*sin(fi)*q**8/M0**2 + 16*(c11 - c12 - 2*c44)*(cos(fi)**2 - 1/2)*cos(fi)*A**2*(cos(t) + 1)**2*ge**2*sin(fi)*((c11 + 2*c12 + c44)*(c11 - c12 - 2*c44)*cos(t)**2 + c44*(c11 + c12))*(cos(t) - 1)**2*q**10/M0**2

    qt = -Gt/Gq
    qf = -Gf/Gq

    Gqq = 8*w**4*(ge*(w*al*complex(0, 1) - H*ge)*b2**2*cos(t)**2/4 + A*al*ge*ro*w**3*complex(0, 1) + (-A*H*ge**2*ro - M0*(al**2 + 1)*(c11 + 2*c44)/4)*w**2 - (H*(c11 + 2*c44)*M0 - b2**2/2)*ge*al*w*complex(0, 1)/2 + ge**2*H*(H*(c11 + 2*c44)*M0 - b2**2)/4)*ro**2/M0 - 48*(M0*(M0*(c11 - c12 - 2*c44)*((al**2/2 + 1/2)*w**2 + H*al*ge*w*complex(0, 1) - H**2*ge**2/2)*cos(fi)**4 - M0*(c11 - c12 - 2*c44)*((al**2/2 + 1/2)*w**2 + H*al*ge*w*complex(0, 1) - H**2*ge**2/2)*cos(fi)**2 + M0*(c11 - c12 - 2*c44)*((al**2/2 + 1/2)*w**2 + H*al*ge*w*complex(0, 1) - H**2*ge**2/2) + ge*(w*al*complex(0, 1) - H*ge)*b2**2)*(c11 + c12)*cos(t)**4/2 + (-M0**2*(c11 - c12 - 2*c44)*((al**2/2 + 1/2)*w**2 + H*al*ge*w*complex(0, 1) - H**2*ge**2/2)*(c11 + c12)*cos(fi)**4 + M0**2*(c11 - c12 - 2*c44)*((al**2/2 + 1/2)*w**2 + H*al*ge*w*complex(0, 1) - H**2*ge**2/2)*(c11 + c12)*cos(fi)**2 - M0**2*(c11 - c12 - 2*c44)*((al**2/2 + 1/2)*w**2 + H*al*ge*w*complex(0, 1) - H**2*ge**2/2)*(c11 + c12)/2 - ge*(w*al*complex(0, 1) - H*ge)*(c11 + 2*c12 - c44)*b2**2*M0/4 + ((A*w**2*ro + b2**2/2)*ge**2*b2**2)/2)*cos(t)**2 + M0**2*(c11 - c12 - 2*c44)*((al**2/2 + 1/2)*w**2 + H*al*ge*w*complex(0, 1) - H**2*ge**2/2)*(c11 + c12)*cos(fi)**4/2 - M0**2*(c11 - c12 - 2*c44)*((al**2/2 + 1/2)*w**2 + H*al*ge*w*complex(0, 1) - H**2*ge**2/2)*(c11 + c12)*cos(fi)**2/2 - (c11 + c44/2)*((al**2/2 + 1/2)*w**2 + H*al*ge*w*complex(0, 1) - H**2*ge**2/2)*c44*M0**2 + ge*(w*al*complex(0, 1) - H*ge)*(A*ro*(c11 + 2*c44)*w**2 + b2**2*(c11 + c44)/4)*M0 + A*ge**2*ro*w**2*(A*w**2*ro + b2**2/2))*w**2*ro*q**2/M0**2 + ((60*((c11 - c12 - 2*c44)*(c11 + 2*c12 + c44)*(-H**2*ge**2/2 + H*al*ge*w*complex(0, 1) + ((al**2 + 1)*w**2)/2)*M0**2 + ge*(c11 + 5*c12 + 4*c44)*(w*al*complex(0, 1) - H*ge)*b2**2*M0/2 + ge**2*b2**4)*(c11 - c12 - 2*c44)*cos(fi)**4 - 60*((c11 - c12 - 2*c44)*(c11 + 2*c12 + c44)*(-H**2*ge**2/2 + H*al*ge*w*complex(0, 1) + ((al**2 + 1)*w**2)/2)*M0**2 + ge*(c11 + 5*c12 + 4*c44)*(w*al*complex(0, 1) - H*ge)*b2**2*M0/2 + ge**2*b2**4)*(c11 - c12 - 2*c44)*cos(fi)**2 - 30*ge*((c11 - c12 - 2*c44)*(w*al*complex(0, 1) - H*ge)*M0 - 2*ge*b2**2)*b2**2*(c11 + c12))*cos(t)**6 + (-120*(c11 - c12 - 2*c44)*((-H**2*ge**2/2 + H*al*ge*w*complex(0, 1) + ((al**2 + 1)*w**2)/2)*(-2*c44**2 + (-(3*c11)/2 - (11*c12)/2)*c44 + (c11 + 2*c12)*(c11 - c12))*M0**2 + ge*(A*ro*(c11 + c12)*w**2 + 3*(c11 + (11*c12)/3 + (8*c44)/3)*b2**2/4)*(w*al*complex(0, 1) - H*ge)*M0 + ge**2*b2**4)*cos(fi)**4 + 120*(c11 - c12 - 2*c44)*((-H**2*ge**2/2 + H*al*ge*w*complex(0, 1) + ((al**2 + 1)*w**2)/2)*(-2*c44**2 + (-(3*c11)/2 - (11*c12)/2)*c44 + (c11 + 2*c12)*(c11 - c12))*M0**2 + ge*(A*ro*(c11 + c12)*w**2 + 3*(c11 + (11*c12)/3 + (8*c44)/3)*b2**2/4)*(w*al*complex(0, 1) - H*ge)*M0 + ge**2*b2**4)*cos(fi)**2 - 120*(-((c11 - c12 - 2*c44)*(-H**2*ge**2/2 + H*al*ge*w*complex(0, 1) + ((al**2 + 1)*w**2)/2)*c44*M0**2)/2 + ge*(w*al*complex(0, 1) - H*ge)*(A*ro*(c11 - c12 - 2*c44)*w**2 - b2**2*(c11 - c12)/4)*M0 - ge**2*(A*w**2*ro - b2**2/2)*b2**2)*(c11 + c12))*cos(t)**4 + (240*(c11 - c12 - 2*c44)*(((-H**2*ge**2/2 + H*al*ge*w*complex(0, 1) + ((al**2 + 1)*w**2)/2)*(-2*c44**2 + (-3*c11 - 7*c12)*c44 + (c11 + 2*c12)*(c11 - c12))*M0**2)/4 + ge*(w*al*complex(0, 1) - H*ge)*(A*ro*(c11 + c12)*w**2 + 3*(c11 + (7*c12)/3 + (4*c44)/3)*b2**2/8)*M0 + ge**2*b2**4/4)*cos(fi)**4 - 240*(c11 - c12 - 2*c44)*(((-H**2*ge**2/2 + H*al*ge*w*complex(0, 1) + ((al**2 + 1)*w**2)/2)*(-2*c44**2 + (-3*c11 - 7*c12)*c44 + (c11 + 2*c12)*(c11 - c12))*M0**2)/4 + ge*(w*al*complex(0, 1) - H*ge)*(A*ro*(c11 + c12)*w**2 + 3*(c11 + (7*c12)/3 + (4*c44)/3)*b2**2/8)*M0 + ge**2*b2**4/4)*cos(fi)**2 - 60*(c11 - c12 - 2*c44)*(-H**2*ge**2/2 + H*al*ge*w*complex(0, 1) + ((al**2 + 1)*w**2)/2)*c44*(c11 + c12)*M0**2 + 120*ge*(A*ro*(c11 + c12)*(c11 - c12 - 2*c44)*w**2 - c44*b2**2*(c11 + 2*c12)/4)*(w*al*complex(0, 1) - H*ge)*M0 - 60*(A*ro*(c11 + 2*c12 - c44)*w**2 - b2**2*c11/2)*ge**2*b2**2)*cos(t)**2 - 120*M0*(c11 - c12 - 2*c44)*(-((-H**2*ge**2/2 + H*al*ge*w*complex(0, 1) + ((al**2 + 1)*w**2)/2)*c44*M0)/2 + ge*(A*w**2*ro + b2**2/4)*(w*al*complex(0, 1) - H*ge))*(c11 + c12)*cos(fi)**4 + 120*M0*(c11 - c12 - 2*c44)*(-((-H**2*ge**2/2 + H*al*ge*w*complex(0, 1) + ((al**2 + 1)*w**2)/2)*c44*M0)/2 + ge*(A*w**2*ro + b2**2/4)*(w*al*complex(0, 1) - H*ge))*(c11 + c12)*cos(fi)**2 - 60*(-H**2*ge**2/2 + H*al*ge*w*complex(0, 1) + ((al**2 + 1)*w**2)/2)*c11*c44**2*M0**2 + 240*ge*c44*(w*al*complex(0, 1) - H*ge)*(A*ro*(c11 + c44/2)*w**2 + b2**2*c11/8)*M0 + 120*ge**2*w**2*A*ro*(A*ro*(c11 + 2*c44)*w**2 + b2**2*(c11 + c44)/2))*q**4/M0**2 + 224*ge*A*((((2*c44**2*H*M0 + (H*(c11 + 5*c12)*M0 - 2*b2**2)*c44 - H*(c11 + 2*c12)*(c11 - c12)*M0 - b2**2*(c11 + 5*c12)/2)*ge + M0*(c11 - c12 - 2*c44)*w*(c11 + 2*c12 + c44)*al*complex(0, 1))*cos(t)**2 + (c11 + c12)*((A*w**2*ro - c44*H*M0 + b2**2/2)*ge + c44*w*M0*al*complex(0, 1)))*(c11 - c12 - 2*c44)*(cos(t) + 1)**2*(cos(t) - 1)**2*cos(fi)**4 - (((2*c44**2*H*M0 + (H*(c11 + 5*c12)*M0 - 2*b2**2)*c44 - H*(c11 + 2*c12)*(c11 - c12)*M0 - b2**2*(c11 + 5*c12)/2)*ge + M0*(c11 - c12 - 2*c44)*w*(c11 + 2*c12 + c44)*al*complex(0, 1))*cos(t)**2 + (c11 + c12)*((A*w**2*ro - c44*H*M0 + b2**2/2)*ge + c44*w*M0*al*complex(0, 1)))*(c11 - c12 - 2*c44)*(cos(t) + 1)**2*(cos(t) - 1)**2*cos(fi)**2 + b2**2*ge*(c11 + c12)*(c11 - c12 - 2*c44)*cos(t)**6/2 + ((2*c44**2*H*M0 + (-H*(c11 - c12)*M0 - 2*A*w**2*ro)*c44 + (c11 - c12)*(A*w**2*ro - b2**2/2))*ge + M0*(c11 - c12 - 2*c44)*w*c44*al*complex(0, 1))*(c11 + c12)*cos(t)**4 + ((-2*H*M0*(c11 + c12)*c44**2 + ((H*c11**2 - H*c12**2)*M0 + (b2**2/2 + 2*A*w**2*ro)*c11 + c12*(2*A*ro*w**2 + b2**2))*c44 - A*w**2*ro*(c11 - c12)*(c11 + c12))*ge - M0*(c11 - c12 - 2*c44)*w*c44*al*(c11 + c12)*complex(0, 1))*cos(t)**2 - c44*(((A*ro*w**2 - H*M0*c11)*c44 + 2*c11*(A*w**2*ro + b2**2/4))*ge + c11*c44*w*M0*al*complex(0, 1)))*q**6/M0**2 - 360*A**2*((c11 - c12 - 2*c44)*(cos(t) + 1)**2*((c11 + 2*c12 + c44)*(c11 - c12 - 2*c44)*cos(t)**2 + c44*(c11 + c12))*(cos(t) - 1)**2*cos(fi)**4 - (c11 - c12 - 2*c44)*(cos(t) + 1)**2*((c11 + 2*c12 + c44)*(c11 - c12 - 2*c44)*cos(t)**2 + c44*(c11 + c12))*(cos(t) - 1)**2*cos(fi)**2 + ((c11 + c12)*(c11 - c12 - 2*c44)*cos(t)**4 - (c11 + c12)*(c11 - c12 - 2*c44)*cos(t)**2 - c11*c44)*c44)*ge**2*q**8/M0**2
    Gtt = -4*ro**2*(cos(t)**2 - 1/2)*(w*al*complex(0, 1) - H*ge)*b2**2*w**4*ge*q**2/M0 + 32*w**2*ro*(M0*(M0*(c11 - c12 - 2*c44)*((al**2/2 + 1/2)*w**2 + H*al*ge*w*complex(0, 1) - H**2*ge**2/2)*cos(fi)**4 - M0*(c11 - c12 - 2*c44)*((al**2/2 + 1/2)*w**2 + H*al*ge*w*complex(0, 1) - H**2*ge**2/2)*cos(fi)**2 + M0*(c11 - c12 - 2*c44)*((al**2/2 + 1/2)*w**2 + H*al*ge*w*complex(0, 1) - H**2*ge**2/2) + ge*(w*al*complex(0, 1) - H*ge)*b2**2)*(c11 + c12)*cos(t)**4 + (-(5*M0**2*(c11 - c12 - 2*c44)*((al**2/2 + 1/2)*w**2 + H*al*ge*w*complex(0, 1) - H**2*ge**2/2)*(c11 + c12)*cos(fi)**4)/4 + (5*M0**2*(c11 - c12 - 2*c44)*((al**2/2 + 1/2)*w**2 + H*al*ge*w*complex(0, 1) - H**2*ge**2/2)*(c11 + c12)*cos(fi)**2)/4 - M0**2*(c11 - c12 - 2*c44)*((al**2/2 + 1/2)*w**2 + H*al*ge*w*complex(0, 1) - H**2*ge**2/2)*(c11 + c12) - (7*ge*(c11 + (8*c12)/7 - c44/7)*(w*al*complex(0, 1) - H*ge)*b2**2*M0)/8 + ((A*w**2*ro + b2**2/2)*ge**2*b2**2)/4)*cos(t)**2 + M0**2*(c11 - c12 - 2*c44)*((al**2/2 + 1/2)*w**2 + H*al*ge*w*complex(0, 1) - H**2*ge**2/2)*(c11 + c12)*cos(fi)**4/4 - M0**2*(c11 - c12 - 2*c44)*((al**2/2 + 1/2)*w**2 + H*al*ge*w*complex(0, 1) - H**2*ge**2/2)*(c11 + c12)*cos(fi)**2/4 + M0**2*(c11 - c12 - 2*c44)*((al**2/2 + 1/2)*w**2 + H*al*ge*w*complex(0, 1) - H**2*ge**2/2)*(c11 + c12)/8 + ge*(w*al*complex(0, 1) - H*ge)*(c11 + 2*c12 - c44)*b2**2*M0/16 - ((A*w**2*ro + b2**2/2)*ge**2*b2**2)/8)*q**4/M0**2 + (64*(c11 - c12 - 2*c44)*(cos(t) + 1)*(cos(t) - 1)*((-9*(c11 - c12 - 2*c44)*(c11 + 2*c12 + c44)*(-H**2*ge**2/2 + H*al*ge*w*complex(0, 1) + ((al**2 + 1)*w**2)/2)*M0**2/8 - (9*ge*(c11 + 5*c12 + 4*c44)*(w*al*complex(0, 1) - H*ge)*b2**2*M0)/16 - (9*ge**2*b2**4)/8)*cos(t)**4 + (13*(-H**2*ge**2/2 + H*al*ge*w*complex(0, 1) + ((al**2 + 1)*w**2)/2)*(-2*c44**2 + (-(21*c11)/13 - (73*c12)/13)*c44 + (c11 + 2*c12)*(c11 - c12))*M0**2/16 + ge*(A*ro*(c11 + c12)*w**2 + 21*(c11 + (73*c12)/21 + (52*c44)/21)*b2**2/32)*(w*al*complex(0, 1) - H*ge)*M0 + (13*ge**2*b2**4)/16)*cos(t)**2 - ((-H**2*ge**2/2 + H*al*ge*w*complex(0, 1) + ((al**2 + 1)*w**2)/2)*(-2*c44**2 + (-3*c11 - 7*c12)*c44 + (c11 + 2*c12)*(c11 - c12))*M0**2)/16 - ge*(w*al*complex(0, 1) - H*ge)*(A*ro*(c11 + c12)*w**2 + 3*(c11 + (7*c12)/3 + (4*c44)/3)*b2**2/8)*M0/4 - ge**2*b2**4/16)*cos(fi)**4 - 64*(c11 - c12 - 2*c44)*(cos(t) + 1)*(cos(t) - 1)*((-9*(c11 - c12 - 2*c44)*(c11 + 2*c12 + c44)*(-H**2*ge**2/2 + H*al*ge*w*complex(0, 1) + ((al**2 + 1)*w**2)/2)*M0**2/8 - (9*ge*(c11 + 5*c12 + 4*c44)*(w*al*complex(0, 1) - H*ge)*b2**2*M0)/16 - (9*ge**2*b2**4)/8)*cos(t)**4 + (13*(-H**2*ge**2/2 + H*al*ge*w*complex(0, 1) + ((al**2 + 1)*w**2)/2)*(-2*c44**2 + (-(21*c11)/13 - (73*c12)/13)*c44 + (c11 + 2*c12)*(c11 - c12))*M0**2/16 + ge*(A*ro*(c11 + c12)*w**2 + 21*(c11 + (73*c12)/21 + (52*c44)/21)*b2**2/32)*(w*al*complex(0, 1) - H*ge)*M0 + (13*ge**2*b2**4)/16)*cos(t)**2 - ((-H**2*ge**2/2 + H*al*ge*w*complex(0, 1) + ((al**2 + 1)*w**2)/2)*(-2*c44**2 + (-3*c11 - 7*c12)*c44 + (c11 + 2*c12)*(c11 - c12))*M0**2)/16 - ge*(w*al*complex(0, 1) - H*ge)*(A*ro*(c11 + c12)*w**2 + 3*(c11 + (7*c12)/3 + (4*c44)/3)*b2**2/8)*M0/4 - ge**2*b2**4/16)*cos(fi)**2 + 36*ge*((c11 - c12 - 2*c44)*(w*al*complex(0, 1) - H*ge)*M0 - 2*ge*b2**2)*b2**2*(c11 + c12)*cos(t)**6 + 64*(-((c11 - c12 - 2*c44)*(-H**2*ge**2/2 + H*al*ge*w*complex(0, 1) + ((al**2 + 1)*w**2)/2)*c44*M0**2)/2 + ge*(A*ro*(c11 - c12 - 2*c44)*w**2 - 23*(c11 - c12 - (30*c44)/23)*b2**2/32)*(w*al*complex(0, 1) - H*ge)*M0 - ge**2*(A*w**2*ro - (23*b2**2)/16)*b2**2)*(c11 + c12)*cos(t)**4 + (32*(c11 - c12 - 2*c44)*(-H**2*ge**2/2 + H*al*ge*w*complex(0, 1) + ((al**2 + 1)*w**2)/2)*c44*(c11 + c12)*M0**2 - 64*ge*(A*ro*(c11 + c12)*(c11 - c12 - 2*c44)*w**2 - 3*((c11/3 + (2*c12)/3)*c44 + c11**2 - c12**2)*b2**2/16)*(w*al*complex(0, 1) - H*ge)*M0 + 56*ge**2*(A*ro*(c11 + (8*c12)/7 - c44/7)*w**2 - ((c11 + (6*c12)/7)*b2**2)/2)*b2**2)*cos(t)**2 - 4*(c11 - c12 - 2*c44)*(-H**2*ge**2/2 + H*al*ge*w*complex(0, 1) + ((al**2 + 1)*w**2)/2)*c44*(c11 + c12)*M0**2 + 8*ge*(A*ro*(c11 + c12)*(c11 - c12 - 2*c44)*w**2 - c44*b2**2*(c11 + 2*c12)/4)*(w*al*complex(0, 1) - H*ge)*M0 - 4*(A*ro*(c11 + 2*c12 - c44)*w**2 - b2**2*c11/2)*ge**2*b2**2)*q**6/M0**2 - 144*((c11 - c12 - 2*c44)*(cos(t) + 1)*(((2*c44**2*H*M0 + (H*(c11 + 5*c12)*M0 - 2*b2**2)*c44 - H*(c11 + 2*c12)*(c11 - c12)*M0 - b2**2*(c11 + 5*c12)/2)*ge + M0*(c11 - c12 - 2*c44)*w*(c11 + 2*c12 + c44)*al*complex(0, 1))*cos(t)**4 + ((-(13*c44**2*H*M0)/9 + (-(7*H*(c11 + (73*c12)/21)*M0)/6 + (13*b2**2)/9)*c44 + (13*H*(c11 + 2*c12)*(c11 - c12)*M0)/18 + ((4*A*w**2*ro)/9 + (73*b2**2)/36)*c12 + 4*(A*w**2*ro + (21*b2**2)/16)*c11/9)*ge - 13*complex(0, 1)*M0*w*al*(-2*c44**2 + (-(21*c11)/13 - (73*c12)/13)*c44 + (c11 + 2*c12)*(c11 - c12))/18)*cos(t)**2 + (c44**2*H*M0/9 + (H*(c11 + (7*c12)/3)*M0/6 - b2**2/9)*c44 - H*(c11 + 2*c12)*(c11 - c12)*M0/18 + (-(7*b2**2)/36 - A*w**2*ro/9)*c12 - c11*(A*w**2*ro + (3*b2**2)/4)/9)*ge + M0*w*(-2*c44**2 + (-3*c11 - 7*c12)*c44 + (c11 + 2*c12)*(c11 - c12))*al*complex(0, 1)/18)*(cos(t) - 1)*cos(fi)**4 - (c11 - c12 - 2*c44)*(cos(t) + 1)*(((2*c44**2*H*M0 + (H*(c11 + 5*c12)*M0 - 2*b2**2)*c44 - H*(c11 + 2*c12)*(c11 - c12)*M0 - b2**2*(c11 + 5*c12)/2)*ge + M0*(c11 - c12 - 2*c44)*w*(c11 + 2*c12 + c44)*al*complex(0, 1))*cos(t)**4 + ((-(13*c44**2*H*M0)/9 + (-(7*H*(c11 + (73*c12)/21)*M0)/6 + (13*b2**2)/9)*c44 + (13*H*(c11 + 2*c12)*(c11 - c12)*M0)/18 + ((4*A*w**2*ro)/9 + (73*b2**2)/36)*c12 + 4*(A*w**2*ro + (21*b2**2)/16)*c11/9)*ge - 13*complex(0, 1)*M0*w*al*(-2*c44**2 + (-(21*c11)/13 - (73*c12)/13)*c44 + (c11 + 2*c12)*(c11 - c12))/18)*cos(t)**2 + (c44**2*H*M0/9 + (H*(c11 + (7*c12)/3)*M0/6 - b2**2/9)*c44 - H*(c11 + 2*c12)*(c11 - c12)*M0/18 + (-(7*b2**2)/36 - A*w**2*ro/9)*c12 - c11*(A*w**2*ro + (3*b2**2)/4)/9)*ge + M0*w*(-2*c44**2 + (-3*c11 - 7*c12)*c44 + (c11 + 2*c12)*(c11 - c12))*al*complex(0, 1)/18)*(cos(t) - 1)*cos(fi)**2 + b2**2*ge*(c11 + c12)*(c11 - c12 - 2*c44)*cos(t)**6/2 + 4*((2*c44**2*H*M0 + (-H*(c11 - c12)*M0 - 2*A*w**2*ro + (15*b2**2)/8)*c44 + (A*w**2*ro - (23*b2**2)/16)*(c11 - c12))*ge + M0*(c11 - c12 - 2*c44)*w*c44*al*complex(0, 1))*(c11 + c12)*cos(t)**4/9 + ((-(8*H*M0*(c11 + c12)*c44**2)/9 + ((4/9*c11**2*H - 4/9*c12**2*H)*M0 + (b2**2/9 + (8*A*w**2*ro)/9)*c12 + 8*(A*w**2*ro + b2**2/16)*c11/9)*c44 - 4*(A*w**2*ro - (3*b2**2)/8)*(c11 - c12)*(c11 + c12)/9)*ge - 4*complex(0, 1)*M0*(c11 - c12 - 2*c44)*w*c44*al*(c11 + c12)/9)*cos(t)**2 + (H*M0*(c11 + c12)*c44**2/9 + ((-1/18*c11**2*H + 1/18*c12**2*H)*M0 + (-A*w**2*ro/9 - b2**2/18)*c12 - c11*(A*w**2*ro + b2**2/4)/9)*c44 + A*w**2*ro*(c11 - c12)*(c11 + c12)/18)*ge + M0*(c11 - c12 - 2*c44)*w*c44*al*(c11 + c12)*complex(0, 1)/18)*ge*A*q**8/M0**2 + 144*(c11 - c12 - 2*c44)*(((c11 + 2*c12 + c44)*(c11 - c12 - 2*c44)*cos(t)**4 + ((13*c44**2)/9 + ((7*c11)/6 + (73*c12)/18)*c44 - 13*(c11 + 2*c12)*(c11 - c12)/18)*cos(t)**2 - c44**2/9 + (-c11/6 - (7*c12)/18)*c44 + ((c11 + 2*c12)*(c11 - c12))/18)*(cos(t) + 1)*(cos(t) - 1)*cos(fi)**4 - ((c11 + 2*c12 + c44)*(c11 - c12 - 2*c44)*cos(t)**4 + ((13*c44**2)/9 + ((7*c11)/6 + (73*c12)/18)*c44 - 13*(c11 + 2*c12)*(c11 - c12)/18)*cos(t)**2 - c44**2/9 + (-c11/6 - (7*c12)/18)*c44 + ((c11 + 2*c12)*(c11 - c12))/18)*(cos(t) + 1)*(cos(t) - 1)*cos(fi)**2 + 4*(cos(t)**4 - cos(t)**2 + 1/8)*(c11 + c12)*c44/9)*A**2*ge**2*q**10/M0**2
    Gff = 32*((al**2/2 + 1/2)*w**2 + H*al*ge*w*complex(0, 1) - H**2*ge**2/2)*(c11 - c12 - 2*c44)*ro*w**2*(c11 + c12)*(cos(t) + 1)**2*(cos(t) - 1)**2*(cos(fi)**4 - cos(fi)**2 + 1/8)*q**4 + 64*(c11 - c12 - 2*c44)*(cos(t) + 1)**2*(cos(fi)**4 - cos(fi)**2 + 1/8)*((-((c11 - c12 - 2*c44)*(c11 + 2*c12 + c44)*((al**2/2 + 1/2)*w**2 + H*al*ge*w*complex(0, 1) - H**2*ge**2/2)*M0**2)/2 - ge*(c11 + 5*c12 + 4*c44)*(w*al*complex(0, 1) - H*ge)*b2**2*M0/4 - ge**2*b2**4/2)*cos(t)**2 + M0*(-c44*((al**2/2 + 1/2)*w**2 + H*al*ge*w*complex(0, 1) - H**2*ge**2/2)*M0/2 + ge*(A*w**2*ro + b2**2/4)*(w*al*complex(0, 1) - H*ge))*(c11 + c12))*(cos(t) - 1)**2*q**6/M0**2 - 64*(((c11 - c12 - 2*c44)*(c11 + 2*c12 + c44)*(w*al*complex(0, 1) - H*ge)*M0 - b2**2*ge*(c11 + 5*c12 + 4*c44)/2)*cos(t)**2 + (c44*(w*al*complex(0, 1) - H*ge)*M0 + ge*(A*w**2*ro + b2**2/2))*(c11 + c12))*(c11 - c12 - 2*c44)*ge*A*(cos(t) + 1)**2*(cos(fi)**4 - cos(fi)**2 + 1/8)*(cos(t) - 1)**2*q**8/M0**2 + 64*(c11 - c12 - 2*c44)*A**2*(cos(fi)**4 - cos(fi)**2 + 1/8)*(cos(t) + 1)**2*ge**2*((c11 + 2*c12 + c44)*(c11 - c12 - 2*c44)*cos(t)**2 + c44*(c11 + c12))*(cos(t) - 1)**2*q**10/M0**2
    Gqt = 4*w**4*ge*(-w*al*complex(0, 1) + H*ge)*b2**2*cos(t)*sin(t)*ro**2*q/M0 + 32*w**2*sin(t)*ro*cos(t)*(M0**2*((al**2/2 + 1/2)*w**2 + H*al*ge*w*complex(0, 1) - H**2*ge**2/2)*(c11 - c12 - 2*c44)*(cos(t) + 1)*(cos(t) - 1)*(c11 + c12)*cos(fi)**4 - M0**2*((al**2/2 + 1/2)*w**2 + H*al*ge*w*complex(0, 1) - H**2*ge**2/2)*(c11 - c12 - 2*c44)*(cos(t) + 1)*(cos(t) - 1)*(c11 + c12)*cos(fi)**2 + M0*(M0*(c11 - c12 - 2*c44)*((al**2/2 + 1/2)*w**2 + H*al*ge*w*complex(0, 1) - H**2*ge**2/2) + ge*(w*al*complex(0, 1) - H*ge)*b2**2)*(c11 + c12)*cos(t)**2 - M0**2*(c11 - c12 - 2*c44)*((al**2/2 + 1/2)*w**2 + H*al*ge*w*complex(0, 1) - H**2*ge**2/2)*(c11 + c12)/2 - ge*(w*al*complex(0, 1) - H*ge)*(c11 + 2*c12 - c44)*b2**2*M0/4 + ((A*w**2*ro + b2**2/2)*ge**2*b2**2)/2)*q**3/M0**2 + 96*((c11 - c12 - 2*c44)*(cos(t) + 1)*(cos(t) - 1)*((-3*(c11 - c12 - 2*c44)*(c11 + 2*c12 + c44)*(-H**2*ge**2/2 + H*al*ge*w*complex(0, 1) + ((al**2 + 1)*w**2)/2)*M0**2/4 - (3*ge*(c11 + 5*c12 + 4*c44)*(w*al*complex(0, 1) - H*ge)*b2**2*M0)/8 - (3*ge**2*b2**4)/4)*cos(t)**2 + ((-H**2*ge**2/2 + H*al*ge*w*complex(0, 1) + ((al**2 + 1)*w**2)/2)*(-2*c44**2 + (-3*c11 - 7*c12)*c44 + (c11 + 2*c12)*(c11 - c12))*M0**2)/4 + ge*(w*al*complex(0, 1) - H*ge)*(A*ro*(c11 + c12)*w**2 + 3*(c11 + (7*c12)/3 + (4*c44)/3)*b2**2/8)*M0 + ge**2*b2**4/4)*cos(fi)**4 - (c11 - c12 - 2*c44)*(cos(t) + 1)*(cos(t) - 1)*((-3*(c11 - c12 - 2*c44)*(c11 + 2*c12 + c44)*(-H**2*ge**2/2 + H*al*ge*w*complex(0, 1) + ((al**2 + 1)*w**2)/2)*M0**2/4 - (3*ge*(c11 + 5*c12 + 4*c44)*(w*al*complex(0, 1) - H*ge)*b2**2*M0)/8 - (3*ge**2*b2**4)/4)*cos(t)**2 + ((-H**2*ge**2/2 + H*al*ge*w*complex(0, 1) + ((al**2 + 1)*w**2)/2)*(-2*c44**2 + (-3*c11 - 7*c12)*c44 + (c11 + 2*c12)*(c11 - c12))*M0**2)/4 + ge*(w*al*complex(0, 1) - H*ge)*(A*ro*(c11 + c12)*w**2 + 3*(c11 + (7*c12)/3 + (4*c44)/3)*b2**2/8)*M0 + ge**2*b2**4/4)*cos(fi)**2 + (3*ge*((c11 - c12 - 2*c44)*(w*al*complex(0, 1) - H*ge)*M0 - 2*ge*b2**2)*b2**2*(c11 + c12)*cos(t)**4)/8 + (-((c11 - c12 - 2*c44)*(-H**2*ge**2/2 + H*al*ge*w*complex(0, 1) + ((al**2 + 1)*w**2)/2)*c44*M0**2)/2 + ge*(w*al*complex(0, 1) - H*ge)*(A*ro*(c11 - c12 - 2*c44)*w**2 - b2**2*(c11 - c12)/4)*M0 - ge**2*(A*w**2*ro - b2**2/2)*b2**2)*(c11 + c12)*cos(t)**2 + ((c11 - c12 - 2*c44)*(-H**2*ge**2/2 + H*al*ge*w*complex(0, 1) + ((al**2 + 1)*w**2)/2)*c44*(c11 + c12)*M0**2)/4 - ge*(A*ro*(c11 + c12)*(c11 - c12 - 2*c44)*w**2 - c44*b2**2*(c11 + 2*c12)/4)*(w*al*complex(0, 1) - H*ge)*M0/2 + ((A*ro*(c11 + 2*c12 - c44)*w**2 - b2**2*c11/2)*ge**2*b2**2)/4)*sin(t)*cos(t)*q**5/M0**2 - 192*ge*A*sin(t)*cos(t)*((c11 - c12 - 2*c44)*(cos(t) + 1)*(((-H*(c11 + 2*c12 + c44)*(c11 - c12 - 2*c44)*M0 - b2**2*(c11 + 5*c12 + 4*c44)/2)*ge + M0*(c11 - c12 - 2*c44)*w*(c11 + 2*c12 + c44)*al*complex(0, 1))*cos(t)**2 + (((-2*c44**2 + (-3*c11 - 7*c12)*c44 + (c11 + 2*c12)*(c11 - c12))*H*M0)/3 + (2*b2**2*c44)/3 + ((7*b2**2)/6 + (2*A*w**2*ro)/3)*c12 + (2*c11*(A*w**2*ro + (3*b2**2)/4))/3)*ge - M0*w*(-2*c44**2 + (-3*c11 - 7*c12)*c44 + (c11 + 2*c12)*(c11 - c12))*al*complex(0, 1)/3)*(cos(t) - 1)*cos(fi)**4 - (c11 - c12 - 2*c44)*(cos(t) + 1)*(((-H*(c11 + 2*c12 + c44)*(c11 - c12 - 2*c44)*M0 - b2**2*(c11 + 5*c12 + 4*c44)/2)*ge + M0*(c11 - c12 - 2*c44)*w*(c11 + 2*c12 + c44)*al*complex(0, 1))*cos(t)**2 + (((-2*c44**2 + (-3*c11 - 7*c12)*c44 + (c11 + 2*c12)*(c11 - c12))*H*M0)/3 + (2*b2**2*c44)/3 + ((7*b2**2)/6 + (2*A*w**2*ro)/3)*c12 + (2*c11*(A*w**2*ro + (3*b2**2)/4))/3)*ge - M0*w*(-2*c44**2 + (-3*c11 - 7*c12)*c44 + (c11 + 2*c12)*(c11 - c12))*al*complex(0, 1)/3)*(cos(t) - 1)*cos(fi)**2 + b2**2*ge*(c11 + c12)*(c11 - c12 - 2*c44)*cos(t)**4/2 + 2*((-H*c44*(c11 - c12 - 2*c44)*M0 - 2*A*w**2*ro*c44 + (c11 - c12)*(A*w**2*ro - b2**2/2))*ge + M0*(c11 - c12 - 2*c44)*w*c44*al*complex(0, 1))*(c11 + c12)*cos(t)**2/3 + (H*c44*(c11 + c12)*(c11 - c12 - 2*c44)*M0/3 + (((2*A*w**2*ro)/3 + b2**2/3)*c12 + (2*c11*(A*w**2*ro + b2**2/4))/3)*c44 - A*w**2*ro*(c11 - c12)*(c11 + c12)/3)*ge - M0*(c11 - c12 - 2*c44)*w*c44*al*(c11 + c12)*complex(0, 1)/3)*q**7/M0**2 + 240*(c11 - c12 - 2*c44)*sin(t)*A**2*cos(t)*ge**2*(((c11 + 2*c12 + c44)*(c11 - c12 - 2*c44)*cos(t)**2 + (2*c44**2)/3 + (c11 + (7*c12)/3)*c44 - ((c11 + 2*c12)*(c11 - c12))/3)*(cos(t) + 1)*(cos(t) - 1)*cos(fi)**4 - ((c11 + 2*c12 + c44)*(c11 - c12 - 2*c44)*cos(t)**2 + (2*c44**2)/3 + (c11 + (7*c12)/3)*c44 - ((c11 + 2*c12)*(c11 - c12))/3)*(cos(t) + 1)*(cos(t) - 1)*cos(fi)**2 + 2*(c11 + c12)*(cos(t)**2 - 1/2)*c44/3)*q**9/M0**2
    Gtf = -8*w**2*ro*sin(t)*cos(t)*(2*complex(0, 1)*H*al*ge*w + al**2*w**2 - H**2*ge**2 + w**2)*(c11 - c12 - 2*c44)*(c11 + c12)*cos(fi)*sin(fi)*(2*cos(fi)**2 - 1)*(cos(t)**2 - 1)*q**4 - 64*(c11 - c12 - 2*c44)*((-3*(c11 - c12 - 2*c44)*(c11 + 2*c12 + c44)*((al**2/2 + 1/2)*w**2 + H*al*ge*w*complex(0, 1) - H**2*ge**2/2)*M0**2/4 - (3*ge*(c11 + 5*c12 + 4*c44)*(w*al*complex(0, 1) - H*ge)*b2**2*M0)/8 - (3*ge**2*b2**4)/4)*cos(t)**2 + ((c11**2 + (c12 - 3*c44)*c11 - 2*c12**2 - 7*c44*c12 - 2*c44**2)*((al**2/2 + 1/2)*w**2 + H*al*ge*w*complex(0, 1) - H**2*ge**2/2)*M0**2)/4 + ge*(w*al*complex(0, 1) - H*ge)*(A*ro*(c11 + c12)*w**2 + 3*(c11 + (7*c12)/3 + (4*c44)/3)*b2**2/8)*M0 + ge**2*b2**4/4)*(cos(fi)**2 - 1/2)*(cos(t) + 1)*sin(t)*cos(t)*(cos(t) - 1)*cos(fi)*sin(fi)*q**6/M0**2 + 96*(c11 - c12 - 2*c44)*ge*(((c11 - c12 - 2*c44)*(c11 + 2*c12 + c44)*(w*al*complex(0, 1) - H*ge)*M0 - b2**2*ge*(c11 + 5*c12 + 4*c44)/2)*cos(t)**2 - ((w*al*complex(0, 1) - H*ge)*(c11**2 + (c12 - 3*c44)*c11 - 2*c12**2 - 7*c44*c12 - 2*c44**2)*M0)/3 + 2*(c11*(A*w**2*ro + (3*b2**2)/4) + (A*w**2*ro + (7*b2**2)/4)*c12 + b2**2*c44)*ge/3)*A*(cos(fi)**2 - 1/2)*(cos(t) + 1)*sin(t)*cos(t)*(cos(t) - 1)*cos(fi)*sin(fi)*q**8/M0**2 - 96*(c11 - c12 - 2*c44)*((c11 + 2*c12 + c44)*(c11 - c12 - 2*c44)*cos(t)**2 - c11**2/3 + (-c12/3 + c44)*c11 + (2*c12**2)/3 + (7*c44*c12)/3 + (2*c44**2)/3)*sin(t)*A**2*sin(fi)*cos(t)*(cos(t) + 1)*ge**2*(cos(fi)**2 - 1/2)*cos(fi)*(cos(t) - 1)*q**10/M0**2
    Gqf = 32*sin(fi)*cos(fi)*(c11 - c12 - 2*c44)*ro*((al**2/2 + 1/2)*w**2 + H*al*ge*w*complex(0, 1) - H**2*ge**2/2)*w**2*(c11 + c12)*(cos(t) + 1)**2*(cos(t) - 1)**2*(cos(fi)**2 - 1/2)*q**3 + 96*(cos(fi)**2 - 1/2)*(c11 - c12 - 2*c44)*(cos(t) + 1)**2*cos(fi)*((-((c11 - c12 - 2*c44)*(c11 + 2*c12 + c44)*((al**2/2 + 1/2)*w**2 + H*al*ge*w*complex(0, 1) - H**2*ge**2/2)*M0**2)/2 - ge*(c11 + 5*c12 + 4*c44)*(w*al*complex(0, 1) - H*ge)*b2**2*M0/4 - ge**2*b2**4/2)*cos(t)**2 + M0*(-c44*((al**2/2 + 1/2)*w**2 + H*al*ge*w*complex(0, 1) - H**2*ge**2/2)*M0/2 + ge*(A*w**2*ro + b2**2/4)*(w*al*complex(0, 1) - H*ge))*(c11 + c12))*(cos(t) - 1)**2*sin(fi)*q**5/M0**2 - 128*(cos(fi)**2 - 1/2)*(((c11 - c12 - 2*c44)*(c11 + 2*c12 + c44)*(w*al*complex(0, 1) - H*ge)*M0 - b2**2*ge*(c11 + 5*c12 + 4*c44)/2)*cos(t)**2 + (c44*(w*al*complex(0, 1) - H*ge)*M0 + ge*(A*w**2*ro + b2**2/2))*(c11 + c12))*(c11 - c12 - 2*c44)*ge*A*(cos(t) + 1)**2*cos(fi)*(cos(t) - 1)**2*sin(fi)*q**7/M0**2 + 160*(c11 - c12 - 2*c44)*(cos(fi)**2 - 1/2)*cos(fi)*A**2*(cos(t) + 1)**2*ge**2*sin(fi)*((c11 + 2*c12 + c44)*(c11 - c12 - 2*c44)*cos(t)**2 + c44*(c11 + c12))*(cos(t) - 1)**2*q**9/M0**2

    qtt = -(Gqq*qt**2 + 2*Gqt*qt + Gtt)/Gq
    qff = -(Gqq*qf**2 + 2*Gqf*qf + Gff)/Gq
    qtf = -(Gqq*qt*qf + Gqt*qf + Gqf*qt + Gtf)/Gq

    qt_v = np.array([(qt*sin(t) + q*cos(t))*cos(fi), (qt*sin(t) + q*cos(t))*sin(fi), qt*cos(t) - q*sin(t)])
    qf_v = np.array([sin(t)*(qf*cos(fi) - q*sin(fi)), (qf*sin(fi) + q*cos(fi))*sin(t), qf*cos(t)])

    qtt_v = np.array([
        (qtt*sin(t) + 2*qt*cos(t) - q*sin(t))*cos(fi),
        (qtt*sin(t) + 2*qt*cos(t) - q*sin(t))*sin(fi),
        qtt*cos(t) - 2*qt*sin(t) - q*cos(t)
    ])
    
    qff_v = np.array([
        (qff*cos(fi) - 2*qf*sin(fi) - q*cos(fi))*sin(t),
        (qff*sin(fi) + 2*qf*cos(fi) - q*sin(fi))*sin(t),
        qff*cos(t)
    ])

    qtf_v = np.array([
        qtf*sin(t)*cos(fi) - qt*sin(t)*sin(fi) + qf*cos(t)*cos(fi) - q*cos(t)*sin(fi),
        qtf*sin(t)*sin(fi) + qt*sin(t)*cos(fi) + qf*cos(t)*sin(fi) + q*cos(t)*cos(fi),
        qtf*cos(t) - qf*sin(t)
    ])

    n_v = np.array([
        qt_v[1]*qf_v[2] - qt_v[2]*qf_v[1], qt_v[2]*qf_v[0] - qt_v[0]*qf_v[2], qt_v[0]*qf_v[1] - qt_v[1]*qf_v[0]
    ])
    
    E = np.abs(qt)**2 + np.abs(q)**2
    G = np.abs(qf)**2 + np.abs(q)**2*sin(t)*sin(t)
    F = qt*np.conj(qf)
    
    I = E*G-np.abs(F)**2
    
    L = np.vdot(qtt_v,n_v)/sqrt(I)
    M = np.vdot(qtf_v,n_v)/sqrt(I)
    N = np.vdot(qff_v,n_v)/sqrt(I)

    II = L*N - M**2

    return [qt, qf, qtt, qff, qtf, I, II]

def Spec_w_b20(q,t,fi,x,H):
    mb,hp,g,ge,Ka,ro,a0,c11,c12,c44,M0,A,b2,al = Const(x)

    k = (c12 + c44)/(c11 - c44)
    nx = sin(t)*cos(fi)
    ny = sin(t)*sin(fi)
    nz = cos(t)

    xi = (nx*ny)**2 + (nx*nz)**2 + (nz*ny)**2
    et = (nx*ny*nz)**2

    r = sqrt(1 + 3*(k**2 - 1)*xi)
    ff = 1 + 4.5*(k**2 - 1)*xi + 13.5*et*(1 - 3*k**2 + 2*k**3)

    QQ = np.arccos(ff/r**3)

    zL = 2/3*r*cos(QQ/3)
    zT1 = 2/3*r*cos(QQ/3-2*pi/3)
    zT2 = 2/3*r*cos(QQ/3+2*pi/3)

    eps_L = 1/3 + zL
    eps_T1 = 1/3 + zT1
    eps_T2 = 1/3 + zT2

    w_L  = sqrt(c44/ro*(1 + (c11 - c44)/c44*eps_L))*q
    w_T1 = sqrt(c44/ro*(1 + (c11 - c44)/c44*eps_T1))*q
    w_T2 = sqrt(c44/ro*(1 + (c11 - c44)/c44*eps_T2))*q

    w_m = ge*(2*A/M0*q**2 + H + 4*pi*M0*sin(t)**2) 

    return [w_L, w_T1, w_T2, w_m]
